{"version":3,"sources":["common/account/ActivityHistory.jsx","common/account/TopCollaborators.jsx","common/documents/table/rows/BaseRowComponent.jsx","common/documents/table/rows/DocumentRow.jsx","common/documents/table/rows/FolderRow.jsx","common/documents/table/rows/HeaderRow.jsx","common/documents/table/preferences/ColumnOrder.jsx","common/documents/table/preferences/PreferencesModal.jsx","common/documents/table/TablePane.jsx","common/documents/grid/Document.jsx","common/documents/grid/Folder.jsx","common/documents/grid/GridPane.jsx","common/documents/table/Columns.js","common/Modal.jsx","common/account/Avatar.jsx","common/documents/FiledropHint.jsx","common/documents/Selection.js","workspace/initialState.js","workspace/operations/ModalForm.jsx","workspace/operations/folder/index.js","common/Meter.jsx","workspace/operations/importing/ImportProgressModal.jsx","workspace/operations/importing/Importer.jsx","workspace/operations/importing/index.js","workspace/operations/ner/progress/NERProgressModal.jsx","workspace/operations/ner/configuration/authorities/AuthoritySelection.jsx","workspace/operations/ner/configuration/engines/EngineSelection.jsx","workspace/operations/ner/configuration/NERConfigurationModal.jsx","workspace/operations/ner/EntityRecognition.jsx","workspace/operations/readme/index.js","workspace/operations/confirm.js","workspace/operations/sharing/public/PublicAccess.jsx","workspace/operations/sharing/collaborators/PermissionSelector.js","workspace/operations/sharing/collaborators/Autocomplete.jsx","workspace/operations/sharing/collaborators/Collaborators.jsx","workspace/operations/sharing/ShareModal.jsx","workspace/operations/index.js","workspace/operations/selection/index.js","workspace/operations/sharing/index.js","workspace/operations/ner/index.js","common/Menu.jsx","workspace/header/search/AdvancedSearch.jsx","workspace/header/search/Search.jsx","workspace/header/Header.jsx","workspace/sidebar/sections/Account.jsx","workspace/sidebar/sections/NewContent.jsx","workspace/sidebar/sections/Views.jsx","workspace/sidebar/sections/Storage.jsx","workspace/sidebar/sections/MyActivity.jsx","workspace/sidebar/Sidebar.jsx","workspace/Workspace.jsx","workspace/App.jsx","common/header/HeaderIcon.jsx","common/header/Breadcrumbs.jsx","common/documents/Readme.jsx","common/account/IdentityInfo.jsx"],"names":["LINE_STYLE","stroke","strokeWidth","AXIS_STYLE","fontSize","color","tickFormatter","tick","Intl","DateTimeFormat","month","format","Date","ActivityHistory","n","toTimestamp","empty","Array","fill","reduce","arr","_","last","length","push","reverse","map","timestamp","value","t","toTime","getTime","this","createEmptySeries","concat","timeseries","props","stats","over_time","parse","date","padTimeseries","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","className","react_number_format__WEBPACK_IMPORTED_MODULE_10___default","displayType","total_contributions","thousandSeparator","recharts__WEBPACK_IMPORTED_MODULE_6__","width","height","barCategoryGap","data","computeChart","recharts__WEBPACK_IMPORTED_MODULE_7__","strokeDasharray","horizontal","recharts__WEBPACK_IMPORTED_MODULE_8__","type","dataKey","axisLine","tickSize","tickCount","tickLine","domain","padding","left","right","recharts__WEBPACK_IMPORTED_MODULE_9__","Component","TopCollaborators","state","collaborators","fetchCollaborators","_this2","username","axios","get","then","result","setState","Fragment","title","user","key","href","_Avatar_jsx__WEBPACK_IMPORTED_MODULE_7__","BaseRowComponent","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","updateTotalRowSpan","next","_totalSpan","columns","total","field","Columns","getSpan","ICONS","TEXT_PLAIN","TEXT_TEIXML","IMAGE_UPLOAD","IMAGE_IIIF","DATA_CSV","FORMATTERS","language","toUpperCase","uploaded_at","datetime","year","day","last_edit_at","react_default","lib_default","public_visibility","visibility","access_level","level","annotations","number_format_default","status_ratio","ratio","verified","unverified","not_identifiable","pctGreen","pctYellow","labels","tooltip","count","slice","style","AGGREGATE_FIELDS","agg_document","item","author","DocumentRow","url","substring","prototype","formatter","undefined","filetypes","id","selected","onClick","startsWith","createAggregateField","createField","src","alt","FolderRow","editable","makeEditable","evt","_input","select","preventDefault","stopPropagation","onChange","target","onKeyPress","which","onRename","ref","i","onKeyDown","HeaderRow","onSort","bind","HEADER_NAMES","sortColumn","sortAsc","SortableItem","SortableElement","_ref","label","SortableList","SortableContainer","_ref2","items","idx","index","ColumnOrder","onSortEnd","e","oldIndex","newIndex","PreferencesModal","states","COLUMNS","forEach","isChecked","includes","checked","_this3","toAppend","filter","checkAll","setAllRows","name","prev","indexOf","splice","arrayMove","_this4","Modal","onClose","onCancel","onClickAll","toggleOne","htmlFor","ColumnOrder_ColumnOrder","onSave","TablePane","drag","tablePreferencesOpen","showPreferences","visible","onSavePreferences","onChangeColumnConfig","sortBy","asc","config","sorting","by","onDrag","active","onDrop","files","dataTransfer","getData","hostname","document","onDropFiles","window","location","onDropSourceURL","args","selection","FolderRow_FolderRow","onRowClick","onRenameFolder","DocumentRow_DocumentRow","handleClick","onSelect","tablePane","es","rowCount","rowHeight","rowRenderer","FiledropHint","busy","HeaderRow_HeaderRow","enableFiledrop","dist_es","disableClick","onDragEnter","onDragLeave","PreferencesModal_PreferencesModal","Document","isStacked","fileCount","Folder","GridPane","itemsPerRow","fromIndex","itemsInRow","Math","min","renderedItems","rowIdx","Folder_Folder","onTileClick","Document_Document","file_count","gridPane","floor","ceil","disableFiledrop","COLUMNS_SHARED_WITH_ME","date_freeform","last_edit_by","activity","owner","shared_by","COLUMN_WIDTH","AGGREGATE_COLUMNS","_home_simonr_Workspaces_pelagios_recogito2_workspace_frontend_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","_home_simonr_Workspaces_pelagios_recogito2_workspace_frontend_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","w","view","c","react_draggable__WEBPACK_IMPORTED_MODULE_6___default","handle","children","Avatar","str","hash","charCodeAt","stringToHslColor","backgroundColor","charAt","AnimatedDiv","posed","div","open","bottom","transition","ease","duration","closed","pose","Selection","selectedItems","selectItem","isCtrlPressed","thisIdx","_selection","isSelected","cloned","selectRange","allItems","toIdx","selectedIndices","minIdx","apply","maxIdx","max","isOutside","from","to","find","ft","isShift","getModifierState","isCtrl","newSelection","DEFAULT_STATE","account","presentation","page","breadcrumbs","readme","total_count","table_config","runningTasks","initialState","stored","localStorage","getItem","JSON","objectSpread","persistState","prefixed","setItem","stringify","ModalForm","handleKeydown","addEventListener","removeEventListener","onOk","CreateFolderForm","folderName","ModalForm_ModalForm","autoFocus","placeholder","Meter","position","FileProgress","upload","file","status","ImportProgressModal","totalLoaded","uploads","u","progress","errors","error","phase","ImportProgressModal_FileProgress","join","Meter_Meter","totalSize","Uploader","updateUploadState","diff","initNewDocument","formdata","FormData","append","post","headers","X-Requested-With","uploadFiles","requests","uploadId","onUploadProgress","loaded","filepartId","uuid","catch","response","Promise","all","finalizeDocument","currentFolder","tasks","running_tasks","pollTaskProgress","document_id","onComplete","console","log","documentId","taskTypes","subtasks","filepart_id","isComplete","setTimeout","start","f","size","remoteSource","sourceType","importRemoteSource","importing_ImportProgressModal","URLInputForm","importContent","resolve","container","body","appendChild","render","Importer_Uploader","remove","NERProgressModal","tasksCompleted","pollProgress","jobId","tasksFailed","isDone","AuthoritySelection","identifier","currentIdx","useAll","onToggleAll","authorities","authority","homepage","rel","shortname","fullname","EngineSelection","cellSpacing","engines","engine","group","languages","lang","description","NERModal","available_engines","available_authorities","selected_engine","selected_all_authorities","selected_authorities","initAvailableAuthorities","initAvailableEngines","all_authorities","onStart","EngineSelection_EngineSelection","changeEngine","AuthoritySelection_AuthoritySelection","toggleAllAuthorities","changeAuthorities","EntityRecognition","running","textDocuments","getItems","isDocument","hasTextParts","taskDefinition","task_type","documents","d","job_id","NERProgressModal_NERProgressModal","NERConfigurationModal_NERModal","getUrl","currentFolderId","Prompt","onKeydown","onNo","toLowerCase","react_draggable_default","message","onYes","PublicAccess","updateSetting","update","ids","onChangeVisibility","onChangeAccessLevel","_result$data","PermissionSelector","onMousedown","_node","contains","handleCancel","onChangeLevel","changeLevel","accessLevel","AutoComplete","isLoading","options","inputValue","fetchSuggestions","query","exclude","onInputChange","clear","getInstance","_this$state","lib","r","onSearch","Collaborators","storeCollaborator","setting","openPermissionsSelector","collaborator","parent","root","PermissionSelector_PermissionSelector","openSelector","nodeName","parentNode","removeCollaborator","delete","addCollaborator","toConsumableArray","Autocomplete_AutoComplete","ShareModal","setView","renderPublicAccess","PublicAccess_PublicAccess","renderCollaborators","Collaborators_Collaborators","getView","operations","createFolder","folder_CreateFolderForm","renameFolder","folder","put","importSource","typ","identifySource","done","importing_URLInputForm","updateReadme","currentPageState","deleteReadme","deleteSelection","onSuccess","onError","promptRoot","setAttribute","confirm_Prompt","onConfirm","confirm","folders","deleteDocuments","deleteFolders","duplicateSelection","isSingleDocument","doc","shareSelection","ShareModal_ShareModal","entityRecognition","EntityRecognition_EntityRecognition","Menu","assertThisInitialized","Group","classNames","Item","disabled","link","icon","AdvancedSearch","isClickOutside","isClickOnToggle","classList","Search","advancedSearchOpen","search","displayConfig","onResponse","toggleAdvancedSearch","AdvancedSearch_AdvancedSearch","OptionsMenu","canDuplicate","canShare","isSingleFolder","common_Menu","isSingleSelection","onDuplicateSelection","onDeleteSelection","onShareSelection","includesText","onNER","Header","optionsMenuVisible","showOptionsMenu","closeOptionsMenu","closeAndThen","fn","hasSelection","isEmpty","Search_Search","tableConfig","onSearchResponse","HeaderIcon","Breadcrumbs","path","docCount","onCreateReadme","react_transition_group","in","timeout","Header_OptionsMenu","onTogglePresentation","Account","menuVisible","openMenu","closeMenu","IdentityInfo","NewContent","onOpenMenu","onCloseMenu","onOpenFileExplorer","click","onUploadFiles","multiple","display","onCreateFolder","onImportSource","ViewListItem","current","Views","Views_ViewListItem","onChangeView","Storage","dataAvailable","storage","quota","quota_mb","used","used_mb","MyActivity","Sidebar","Account_Account","NewContent_NewContent","sections_Views","sections_Storage","sections_MyActivity","Workspace","sidebar_Sidebar","Header_Header","Readme","content","onUpdate","onUpdateReadme","onDelete","onDeleteReadme","onSortTable","App","querySelector","refreshPage","folderId","expandAggregatedColumns","sort","changeFolder","changeView","togglePresentation","sortTable","changeColumConfig","createReadme","_rootEl","getElementById","onhashchange","workspace_Workspace","App_App","react__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","react__WEBPACK_IMPORTED_MODULE_0___default","VIEW_LABELS","MY_DOCUMENTS","SHARED_WITH_ME","SEARCH","b","INITIAL_STATE","editing","modifiedContent","ctrlKey","react_markdown__WEBPACK_IMPORTED_MODULE_6___default","source","onEdit","react_sane_contenteditable__WEBPACK_IMPORTED_MODULE_7__","tagName","multiLine","editOnOpen","renderEdit","renderView","replace","member_since","_Avatar_jsx__WEBPACK_IMPORTED_MODULE_6__","real_name","bio","website","formatURL"],"mappings":"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","file":"static/js/workspace.4d30af52.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport { Bar, BarChart, CartesianGrid, XAxis } from 'recharts';\nimport NumberFormat from 'react-number-format';\n\nconst LINE_STYLE = {\n  stroke: '#c2c2c2', \n  strokeWidth:1\n}\n\nconst AXIS_STYLE = {\n  fontSize:\"12px\",\n  color:\"#3f3f3f\"\n}\n\nconst WEEK = 3600000 * 24 * 7; // A week in milliseconds\n\nconst tickFormatter = (tick) => new Intl.DateTimeFormat('en-GB', {\n  month: 'short'\n}).format(new Date(tick));\n\nexport default class ActivityHistory extends Component {\n\n  /** Helper that generates an empty time series of N buckets with value 0 */\n  createEmptySeries(n, toTimestamp) {\n    const empty = new Array(n);\n    empty.fill(0); // Needs to contain *something* for .reduce to work\n\n    const timestamps = empty.reduce((arr, _) => {\n      const last = arr[arr.length - 1];\n      arr.push(last - WEEK);\n      return arr;\n    }, [ toTimestamp - WEEK ]).reverse();\n\n    return timestamps.map(timestamp => {\n      return { timestamp: timestamp, value: 0 };\n    });\n  }\n\n  padTimeseries(t) {\n    const toTime = t.length > 0 ? t[0].timestamp : new Date().getTime();\n    const padding = this.createEmptySeries(19 - t.length, toTime);\n    return padding.concat(t);\n  }\n\n  computeChart() {\n    // Data comes as ISO strings - convert\n    const timeseries = this.props.stats.over_time.map(t => {\n      return { timestamp: Date.parse(t.date), value: t.value };\n    });\n\n    if (timeseries.length < 20) {\n      return this.padTimeseries(timeseries);\n    } else {\n      return timeseries;\n    }\n  }\n\n  render() {\n    return (\n      <div className={this.props.className ? \n        `activity-widget ${this.props.className}` : \"activity-widget\"}>\n\n        <h2>Activity \n          {this.props.stats && \n            <span className=\"count\">\n              <NumberFormat \n                displayType=\"text\"\n                value={this.props.stats.total_contributions}\n                thousandSeparator={true} /> edits\n            </span>\n          }\n        </h2>\n\n        {this.props.stats &&\n          <BarChart \n            width={this.props.width} \n            height={this.props.height} \n            barCategoryGap={1.5}\n            data={this.computeChart()} >\n\n            <CartesianGrid \n              strokeDasharray=\"3\" \n              horizontal={false}/>\n\n            <XAxis \n              type=\"number\"\n              dataKey=\"timestamp\"\n\n              axisLine={LINE_STYLE} \n\n              tick={AXIS_STYLE}\n              tickSize={4}\n              tickCount={6}\n              tickLine={LINE_STYLE}\n              tickFormatter={tickFormatter}\n\n              height={20}\n              domain={['dataMin', 'dataMax']}\n              padding={{ left: 5, right: 5 }} />\n\n            <Bar \n              dataKey=\"value\" \n              fill={this.props.fill} />\n\n          </BarChart>\n        }\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport axios from 'axios';\n\nimport Avatar from './Avatar.jsx';\n\nexport default class TopCollaborators extends Component {\n\n  state = {\n    collaborators: []\n  }\n\n  componentWillMount() {\n    this.fetchCollaborators();\n  }\n\n  fetchCollaborators() {\n    if (this.props.username)\n      axios\n        .get(`/api/account/${this.props.username}/collaborators`)\n        .then(result => this.setState({ collaborators: result.data }));\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        {this.state.collaborators.length > 0 &&\n          <div className={this.props.className ? `collaborator-list ${this.props.className}` : 'collaborator-list'}>\n            <h2>{this.props.title}</h2>\n            <ul>\n              {this.state.collaborators.map(user => \n                <li key={user.username}>\n                  <a href={`/${user.username}`} title={user.username}>\n                    <Avatar username={user.username} />\n                  </a>\n                </li>\n              )}\n            </ul>\n          </div>\n        }\n      </React.Fragment>\n    )\n  }\n\n}","import { Component } from 'react';\nimport { Columns } from '../Columns';\n\nexport default class BaseRowComponent extends Component {\n\n  constructor(props) {\n    super(props);\n    this.updateTotalRowSpan(props);\n  }\n\n  componentWillReceiveProps(next) {\n    this.updateTotalRowSpan(next);\n  }\n\n  /** Updates total unit width requirement for current row layout **/\n  updateTotalRowSpan(props) {\n    this._totalSpan = props.columns.reduce((total, field) => total + Columns.getSpan(field), 0);\n  }\n\n  getWidth(field) {\n    const span = Columns.getSpan(field);\n    return span / this._totalSpan;\n  }\n  \n}","import React from 'react';\nimport NumberFormat from 'react-number-format';\nimport TimeAgo from 'react-timeago';\nimport BaseRowComponent from './BaseRowComponent';\n\n/** Icons for possible content type values **/\nconst ICONS = {\n  TEXT_PLAIN   : 'icon_text.png',\n  TEXT_TEIXML  : 'icon_tei.png',\n  IMAGE_UPLOAD : 'icon_image.png',\n  IMAGE_IIIF   : 'icon_iiif.png',\n  DATA_CSV     : 'icon_csv.png'\n};\n\n/** Formatting rules for possible field types **/\nconst FORMATTERS = {\n  language: (language) => \n    language.toUpperCase(),\n\n  uploaded_at: (datetime) => \n    new Intl.DateTimeFormat('en-GB', {\n      year : 'numeric',\n      month: 'short',\n      day  : '2-digit'\n    }).format(new Date(datetime)),\n  \n  last_edit_at: (datetime) => \n    <TimeAgo date={datetime} />,\n\n  public_visibility: (visibility) => {\n    if (visibility === 'PUBLIC') \n      return ( <span className=\"icon\" title=\"Open to anyone\">&#xf09c;</span> );\n    else if (visibility === 'WITH_LINK')\n      return ( <span className=\"icon\" title=\"Open to anyone with the link\">&#xf0c1;</span> );\n    else \n      return ( <span className=\"icon\" title=\"Private\">&#xf023;</span> );\n  },\n\n  access_level: (level) => {\n    if (level === 'ADMIN')\n      return ( <span className=\"icon\" title=\"ADMIN\">&#xf0ad;</span> );\n    else if (level === 'WRITE')\n      return ( <span className=\"icon\" title=\"WRITE\">&#xf040;</span> );\n    else\n      return ( <span className=\"icon\" title=\"READ\">&#xf06e;</span> );\n  },\n\n  annotations: (annotations) =>\n    <NumberFormat \n      displayType=\"text\"\n      value={annotations}\n      thousandSeparator={true} />,\n\n  status_ratio: (ratio) => {\n    const total = ratio.verified + ratio.unverified + ratio.not_identifiable;\n    const pctGreen = ratio.verified / total * 100;\n    const pctYellow = ratio.not_identifiable / total * 100;\n\n    const labels = {\n      'verified': 'verified',\n      'unverified': 'unverified',\n      'not_identifiable': 'flagged'\n    }\n\n    const tooltip = ['verified', 'unverified', 'not_identifiable'].reduce((tooltip, next) => {\n      const count = ratio[next];\n      if (count === 0)\n        return tooltip;\n      else\n        return `${tooltip} ${count} ${labels[next]},`;\n    }, '').slice(0, -1);\n\n    return (\n      <span className=\"bar\" title={tooltip}>\n        <span className=\"verified\" style={{ width: `${pctGreen}%` }} />\n        <span className=\"not_identifiable\" style={{ width: `${pctYellow}%` }} />\n      </span>\n    )\n  }\n\n};\n\n/** Rules for aggregate fields **/\nconst AGGREGATE_FIELDS = {\n  agg_document: (item) => (item.author) ?\n                            `${item.author}, ${item.title}` : item.title\n};\n\nexport default class DocumentRow extends BaseRowComponent {\n\n  createAggregateField(url, field) {\n    return (\n      <a \n        key={field}\n        href={url} \n        className={field.substring(4)}\n        style={{ width: `${100 * super.getWidth(field)}%` }}>\n\n        {AGGREGATE_FIELDS[field](this.props.item)}\n      </a>\n    )\n  }\n\n  createField(url, field) {\n    const formatter = FORMATTERS[field];\n\n    const value = this.props.item[field] !== undefined ? \n      (formatter ? formatter(this.props.item[field]) : this.props.item[field]) :\n      ''; // empty value\n\n    return (\n      <a \n        key={field}\n        href={url}\n        className={field}\n        style={{ width: `${100 * super.getWidth(field)}%` }}>{value}</a>\n    )\n  }\n\n  render() {\n    const type = this.props.item.filetypes[0];\n    const url = `document/${this.props.item.id}/part/1/edit`;\n\n    return (\n      <div\n        className={`row${(this.props.selected) ? ' selected' : ''}`}\n        style={this.props.style}\n        onClick={this.props.onClick} >\n        \n        { this.props.columns.map(field => field.startsWith('agg_') ? \n          this.createAggregateField(url, field) : this.createField(url, field)) }\n\n        <span className={`type icon ${type}`}>\n          <img src={`/assets/images/${ICONS[type]}`} alt={`icon type ${type}`} />\n        </span>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class FolderRow extends Component {\n\n  state = { \n    title: this.props.item.title,\n    editable: false\n  }\n\n  componentWillReceiveProps(next) {\n    this.setState({ \n      title: next.item.title,\n      editable: false\n    });\n  }\n\n  makeEditable = (evt) => {\n    this.setState({ editable: true },\n      () => this._input.select());\n\n    evt.preventDefault();\n    evt.stopPropagation();\n  }\n\n  onChange = (evt) => {\n    this.setState({ title: evt.target.value });\n  }\n\n  onKeyPress = (evt) => {\n    if (evt.which === 13) {\n      this.setState({ editable: false}, \n        () => this.props.onRename(this.props.item, this.state.title));\n    }\n  }\n\n  render() {\n    return (\n      <a\n        href={`#${this.props.item.id}`} \n        style={this.props.style}\n        className={`row folder${(this.props.selected) ? ' selected' : ''}`}\n        onClick={this.props.onClick}>\n\n        <span className=\"folder-title\">\n          { this.state.editable ? \n            <input \n              ref={i => this._input = i}\n              value={this.state.title}\n              onClick={this.makeEditable}\n              onChange={this.onChange}\n              onKeyDown={this.onKeyPress} />\n          : <span\n              className=\"editable\" \n              onClick={this.makeEditable} >{this.state.title}</span> }\n        </span>\n\n        <span className=\"type icon\">&#xf07b;</span>\n      </a>\n    )\n  }\n\n}\n","import React from 'react';\nimport BaseRowComponent from './BaseRowComponent';\nimport { HEADER_NAMES } from '../Columns';\n\nexport default class HeaderRow extends BaseRowComponent {\n\n  render() {\n    return (\n      <div className=\"column-labels\">\n        {this.props.columns.map(field =>\n          <span\n            key={field}\n            style={{ width: `${100 * super.getWidth(field)}%` }}\n            className={`label ${field}`}\n            onClick={this.props.onSort.bind(this, field)}>\n            <span className=\"inner-wrapper\">\n              <span className=\"inner\">\n                {HEADER_NAMES[field] || field}\n              </span>\n              {this.props.sortColumn === field &&\n                <span className=\"sort icon\">\n                  <span className=\"inner\">\n                    {(this.props.sortAsc) ? '\\ue688' : '\\ue682' }\n                  </span>\n                </span>\n              }\n            </span>\n          </span>\n        )}\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { SortableContainer, SortableElement } from 'react-sortable-hoc';\nimport { HEADER_NAMES } from '../Columns.js';\n\nconst SortableItem = SortableElement(({ label }) =>\n  <div className=\"card\">{label}</div>\n);\n\nconst SortableList = SortableContainer(({ items }) =>\n  <div className=\"column-order\">\n    {items.map((item, idx) => (\n      <SortableItem key={`card-${idx}`} index={idx} label={HEADER_NAMES[item]} />\n    ))}\n  </div>\n);\n\nexport default class ColumnOrder extends Component {\n\n  render() {\n    return (\n      <SortableList\n        items={this.props.items}\n        onSortEnd={e => this.props.onSortEnd(e.oldIndex, e.newIndex)} />\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { arrayMove } from 'react-sortable-hoc';\nimport Modal from '../../../Modal';\nimport ColumnOrder from './ColumnOrder';\nimport { COLUMNS, HEADER_NAMES } from '../Columns';\n\nexport default class PreferencesModal extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      columns: props.columns.slice(0)\n    }\n  }\n\n  componentWillReceiveProps(next) {\n    if (next.columns !== this.props.columns)\n      this.setState({ columns: next.columns.slice(0) });\n  }\n\n  /** Computes a map (fieldname -> checked) from the current columns state **/\n  getCheckboxStates(props) {\n    const states = {};\n\n    COLUMNS.forEach(field => {\n      const isChecked = this.state.columns.includes(field);\n      states[field] = isChecked;\n    });\n\n    return states;\n  }\n\n  /** Sets visibility for all rows to the given boolean value **/\n  setAllRows(checked) {\n    const checkAll = () => {\n      const toAppend = \n        COLUMNS.filter(field => !this.state.columns.includes(field));\n\n      this.setState({ columns: this.state.columns.concat(toAppend) });\n    };\n\n    const uncheckAll = () => {\n      this.setState({ columns: [] });\n    };\n\n    if (checked) \n      checkAll();\n    else\n      uncheckAll();\n  }\n\n  /**\n   * Clicking 'ALL' either checks all boxes or - if all are currently\n   * checked, unchecks them.\n   */\n  onClickAll() {\n    const allRowsChecked = COLUMNS.length === this.state.columns.length;\n    if (allRowsChecked)\n      this.setAllRows(false);\n    else\n      this.setAllRows(true);\n  }\n\n  /** Toggles the checkbox with the given name **/\n  toggleOne(name) {\n    this.setState(prev => {\n      const idx = prev.columns.indexOf(name);\n      if (idx < 0)\n        prev.columns.push(name);\n      else\n        prev.columns.splice(idx, 1);        \n    \n      return prev;\n    });\n  }\n\n  onSort(oldIndex, newIndex) {\n    this.setState({\n      columns: arrayMove(this.state.columns, oldIndex, newIndex)\n    });\n  }\n\n  render() {\n    // Helper to create a single checkbox + label row\n    const createRow = (field) =>\n      <li key={field}>\n        <input\n          type=\"checkbox\"\n          id={field}\n          name={field}\n          checked={this.state.columns.includes(field)}\n          onChange={this.toggleOne.bind(this, field)} />\n        <label htmlFor={field}>{HEADER_NAMES[field]}</label>\n      </li>\n\n    return (\n      <Modal\n        className=\"preferences\"\n        title=\"Configure Columns\"\n        onClose={this.props.onCancel}>\n\n        <div className=\"scroll-pane\">\n          <div className=\"selected-columns\">\n            <button\n              className=\"all nostyle\"\n              onClick={this.onClickAll.bind(this)}>All</button>\n            <ul>\n              { COLUMNS.map(createRow) }\n            </ul>\n          </div>\n\n          <ColumnOrder\n            items={this.state.columns} \n            onSortEnd={this.onSort.bind(this)} />\n        </div>\n\n        <div className=\"buttons\">\n          <button\n            className=\"btn\"\n            onClick={this.props.onSave.bind(this, this.state.columns)}>Save</button>\n\n          <button \n            className=\"btn outline\"\n            onClick={this.props.onCancel}>Cancel</button>\n        </div>\n      </Modal>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { AutoSizer, List } from 'react-virtualized';\nimport Dropzone from 'react-dropzone'\nimport DocumentRow from './rows/DocumentRow';\nimport FiledropHint from '../FiledropHint';\nimport FolderRow from './rows/FolderRow';\nimport HeaderRow from './rows/HeaderRow';\nimport PreferencesModal from  './preferences/PreferencesModal';\n\nexport default class TablePane extends Component {\n\n  state = {\n    drag: false,\n    tablePreferencesOpen: false,\n  }\n\n  rowRenderer() {\n    return ((args) => {\n      const item = this.props.items[args.index];\n      const selected = this.props.selection && \n        this.props.selection.includes(item);\n\n      return (item.type === 'FOLDER') ?\n        <FolderRow \n          key={args.key} \n          style={args.style} \n          item={item} \n          selected={selected}\n          onClick={e => this.onRowClick(e, item, args.index)} \n          onRename={this.props.onRenameFolder} /> :\n\n        <DocumentRow\n          key={args.key}\n          style={args.style}\n          columns={this.props.config.columns}\n          item={item}\n          selected={selected}\n          onClick={e => this.onRowClick(e, item, args.index)} />\n    });\n  }\n\n  onRowClick(evt, item, idx) {\n    const selection = this.props.selection && \n      this.props.selection.handleClick(evt, item, idx, this.props.items);    \n      \n    if (selection)\n      this.props.onSelect(selection);\n  }\n\n  showPreferences = visible => {\n    this.setState({ tablePreferencesOpen: visible });\n  }\n\n  onSavePreferences = columns => {\n    this.setState({ tablePreferencesOpen: false });\n    this.props.onChangeColumnConfig(columns);\n  }\n\n  sortBy = field => {\n    const asc = this.props.config.sorting.by === field ? \n      ! this.props.config.sorting.asc : true;\n    this.props.onSort({ by: field, asc: asc });\n  }\n\n  onDrag = active => {\n    this.setState({ drag: active });\n  }\n\n  onDrop = (files, _, evt) => {\n    const url = evt.dataTransfer.getData('URL');\n\n    const hostname = url ? (() => {\n      const a = document.createElement('a');\n      a.href = url;\n      return a.hostname;\n    })() : null;\n\n    this.setState({ drag: false });\n\n    if (files.length > 0)\n      this.props.onDropFiles(files);\n    else if (url && hostname !== window.location.hostname) // Require external link\n      this.props.onDropSourceURL(url);\n  }\n\n  render() {\n    const tablePane =\n      <div className=\"documents-pane table-pane\">\n        <AutoSizer>\n          {({ height, width }) => (\n            <List\n              className=\"virtualized-list\"\n              width={width}\n              height={height}\n              rowCount={this.props.items.length}\n              rowHeight={47}\n              rowRenderer={this.rowRenderer()} />\n          )}\n        </AutoSizer>\n\n        { this.state.drag && \n          <FiledropHint /> }\n        \n        { this.props.busy &&\n           <div className=\"busy-mask\" /> }\n      </div>\n\n    return (\n      <React.Fragment>\n        <div className=\"documents-table-header\">\n          <HeaderRow \n            columns={this.props.config.columns} \n            sortColumn={this.props.config.sorting.by} \n            sortAsc={this.props.config.sorting.asc} \n            onSort={this.sortBy} />\n\n          <button\n            className=\"column-options-btn nostyle icon\"\n            onClick={() => this.showPreferences(true)} >&#xf141;</button>\n        </div>\n\n        { this.props.enableFiledrop ?\n          <Dropzone\n            className=\"dropzone\"\n            disableClick={true}\n            onDragEnter={() => this.onDrag(true)}\n            onDragLeave={() => this.onDrag(false)}\n            onDrop={this.onDrop}>\n            { tablePane }\n          </Dropzone> : tablePane\n        }\n\n        { this.state.tablePreferencesOpen &&\n          <PreferencesModal\n            columns={this.props.config.columns}\n            onCancel={() => this.showPreferences(false)} \n            onSave={this.onSavePreferences} />\n        }\n      </React.Fragment>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class Document extends Component {\n\n  render() {\n    const type = this.props.filetypes[0]; // TODO make more clever in the future\n    const isStacked = this.props.fileCount > 1;\n\n    return (\n      <a href={`document/${this.props.id}/part/1/edit`}\n        className={`cell${(this.props.selected) ? ' selected' : ''}`}\n        onClick={this.props.onClick} >\n        \n        <div className=\"inner\">\n          <div className={`item-wrapper${isStacked ? ' stacked' : ''}`}>\n            { isStacked && <div className=\"stack\" /> }\n            <div className={`document ${type}`}>\n              <div className=\"label\">\n                {this.props.title}\n              </div>\n            </div>\n          </div>\n        </div>\n      </a>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class Folder extends Component {\n\n  render() {\n    return (\n      <a href={`#${this.props.id}`} \n        className={`cell${(this.props.selected) ? ' selected' : ''}`}\n        onClick={this.props.onClick}>\n\n        <div className=\"inner\">\n          <div className=\"item-wrapper\">\n            <div className=\"folder\">\n              <div className=\"label\">\n                {this.props.title}\n              </div>\n            </div>\n          </div>\n        </div>\n      </a>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport Dropzone from 'react-dropzone'\nimport { AutoSizer, List } from 'react-virtualized';\nimport Document from './Document';\nimport Folder from './Folder';\nimport FiledropHint from '../FiledropHint';\n\nconst TILE_SIZE = 192;\n\n/**\n * Using the following example:\n *\n * https://stackoverflow.com/questions/46368305/how-to-make-a-list-grid-with-a-responsive-number-of-columns-using-react-virtuali\n * http://plnkr.co/edit/zjCwNeRZ7XtmFp1PDBsc?p=preview\n */\nexport default class GridPane extends Component {\n\n  state = {\n    drag: false\n  }\n\n  onTileClick(evt, item, idx) {\n    const selection = \n      this.props.selection && this.props.selection.handleClick(evt, item, idx, this.props.items);    \n\n    if (selection)\n      this.props.onSelect(selection);\n  }\n\n  rowRenderer(itemsPerRow) {\n    return (args => {\n      const fromIndex = args.index * itemsPerRow;\n      const toIndex = Math.min(fromIndex + itemsPerRow, this.props.items.length);\n      const itemsInRow = toIndex - fromIndex;\n\n      const renderedItems = new Array(itemsInRow).fill(undefined).map((_, rowIdx) => {\n        const idx = rowIdx + fromIndex;\n        const item = this.props.items[idx];\n        const selected = this.props.selection && this.props.selection.includes(item);\n\n        return (item.type === 'FOLDER') ?\n            <Folder\n              key={idx} \n              id={item.id}\n              title={item.title} \n              selected={selected}\n              onClick={e => this.onTileClick(e, item, idx)} /> :\n            \n            <Document\n              key={idx}\n              id={item.id}\n              title={item.title}\n              filetypes={item.filetypes}\n              fileCount={item.file_count}\n              selected={selected}\n              onClick={e => this.onTileClick(e, item, idx)} />\n      });\n\n      if (itemsInRow < itemsPerRow) { // Add dummies to preserve grid layout\n        renderedItems.push(new Array(itemsPerRow - itemsInRow).fill(undefined).map((_, idx) =>\n          <div className=\"cell dummy\" key={`dummy-${idx}`} />\n        ))\n      }\n\n      return (\n        <div\n          key={args.key}\n          style={args.style}\n          className=\"row\">\n          {renderedItems}\n        </div>\n      )\n    });\n  }\n\n  onDrag = (active) => {\n    this.setState({ drag: active });\n  }\n\n  onDrop = (files, _, evt) => {\n    const url = evt.dataTransfer.getData('URL');\n\n    this.setState({ drag: false });\n\n    if (files.length > 0) this.props.onDropFiles(files);\n    else if (url) this.props.onDropSourceURL(url);\n  }\n\n  render() {\n    const gridPane =\n      <AutoSizer>\n        {({ height, width }) => {\n          const itemsPerRow = Math.floor(width / TILE_SIZE);\n          const rowCount = Math.ceil(this.props.items.length / itemsPerRow);\n\n          return (\n            <List\n              className=\"virtualized-grid\"\n              width={width}\n              height={height}\n              rowCount={rowCount}\n              rowHeight={TILE_SIZE}\n              rowRenderer={this.rowRenderer(itemsPerRow)} />\n          )\n        }}\n      </AutoSizer>\n\n    return (\n      <React.Fragment>\n        <div className=\"documents-pane grid-pane\">\n          {this.props.disableFiledrop ? gridPane :\n            <Dropzone\n              className=\"dropzone\"\n              disableClick={true}\n              onDragEnter={() => this.onDrag(true)}\n              onDragLeave={() => this.onDrag(false)}\n              onDrop={this.onDrop}>\n\n              {gridPane}\n\n            </Dropzone>\n          }\n\n          { this.state.drag && <FiledropHint /> }\n        </div>\n      </React.Fragment>\n    )\n  }\n\n}\n","// Columns available in all views\nconst COLUMNS_GENERAL = [\n  // Aggregate fields\n  // 'agg_document',\n\n  // Common fields\n  'author',\n  'title',\n  'language',\n  'date_freeform',\n  'uploaded_at',\n  'last_edit_at',\n  'last_edit_by',\n  'annotations',\n  'public_visibility',\n  'status_ratio'\n  // 'activity'\n];\n\n// Columns specific to SHARED_WITH_ME view\nconst COLUMNS_SHARED_WITH_ME = [\n  'owner',\n  'shared_by',\n  'access_level'\n];\n\nexport const COLUMNS = COLUMNS_GENERAL.concat(COLUMNS_SHARED_WITH_ME);\n\n// Labels to use for fields\nexport const HEADER_NAMES = {\n  // agg_document    : 'Document',\n\n  author            : 'Author',\n  title             : 'Title',\n  language          : 'Language',\n  date_freeform     : 'Date',\n  uploaded_at       : 'Uploaded at',\n  last_edit_at      : 'Last edit',\n  last_edit_by      : 'Last edit by',\n  annotations       : 'Annotations',\n  public_visibility : 'Visibility',\n  status_ratio      : 'Verification ratio',\n  activity          : 'Activity graph',\n\n  owner             : 'Document owner',\n  shared_by         : 'Shared by',\n  access_level      : 'Access'\n};\n\n// Relative width requirements per column (XL, L, M, S)\nexport const COLUMN_WIDTH = {\n  agg_document    : 'XL',\n\n  author            : 'M',\n  title             : 'L',\n  language          : 'M',\n  date_freeform     : 'M',\n  uploaded_at       : 'M',\n  last_edit_at      : 'M',\n  last_edit_by      : 'M',\n  annotations       : 'M',\n  public_visibility : 'M',\n  status_ratio      : 'M',\n  activity          : 'M',\n\n  owner             : 'M',\n  shared_by         : 'M',\n  access_level      : 'M'\n};\n\nexport const AGGREGATE_COLUMNS = {\n  agg_document: [ 'author', 'document' ]\n};\n\n// Static helper methods \nexport class Columns {\n\n  static getSpan(field) {\n    const w = COLUMN_WIDTH[field];\n    if (w === 'XL') \n      return 6;\n    else if (w === 'L')\n      return 4;\n    else if (w === 'M')\n      return 2;\n    else if (w === 'S')\n      return 1;\n  }\n\n  /** Expands agg_ columns to those that are required to build them **/\n  static expandAggregatedColumns(columns) {\n    return columns.reduce((result, field) => {\n      if (field.startsWith('agg_'))\n        result = result.concat(AGGREGATE_COLUMNS[field]);\n      else\n        // Just append\n        result.push(field);\n\n      return result;\n    }, []);\n  }\n\n  /** Removes the columns that are not applicable in the given view **/\n  static filterByView(columns, view) { \n    if (view === 'MY_DOCUMENTS')\n      // Remove columns specific to 'Shared With Me'\n      return columns.filter(c => !COLUMNS_SHARED_WITH_ME.includes(c));\n    else\n      // All\n      return columns; \n  }\n\n}","import React, { Component } from 'react';\nimport Draggable from 'react-draggable';\n\nexport default class Modal extends Component {\n\n  render() {\n    return (\n      <div className={`clicktrap ${this.props.className}`}>\n        <div className=\"modal-wrapper\">\n          <Draggable handle=\".modal-header\">\n            <div className=\"modal\">\n              <div className=\"modal-header\">\n                <h1 className=\"title\">{this.props.title}</h1>\n                <button\n                  className=\"close nostyle\"\n                  onClick={this.props.onClose}>&#xe897;</button>\n              </div>\n\n              <div className=\"modal-body\">\n                {this.props.children}\n              </div>\n            </div>\n          </Draggable>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class Avatar extends Component {\n\n  // https://medium.com/@pppped/compute-an-arbitrary-color-for-user-avatar-starting-from-his-username-with-javascript-cd0675943b66\n  stringToHslColor(str) {\n    let hash = 0;\n    for (let i=0; i<str.length; i++) {\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\n    }\n    return hash % 360;\n  }\n\n  render() {\n    const color = this.props.username ? `hsl(${this.stringToHslColor(this.props.username)}, 35%, 65%)` : '#e2e2e2';\n\n    return (\n      <div className=\"avatar\" style={{ backgroundColor: color }}>\n        <div className=\"inner\">\n          { this.props.username && this.props.username.charAt(0).toUpperCase() }\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport posed from 'react-pose';\n\nconst AnimatedDiv = posed.div({\n  open:   { \n    bottom: '30px',\n    transition: {\n      ease: 'easeOut',\n      duration:200\n    }\n  },\n  closed: { bottom: '-140px' }\n});\n\nexport default class FiledropHint extends Component {\n\n  state = { \n    visible: false \n  };\n\n  componentDidMount() {\n    this.setState({ visible: true });\n  }\n\n  render() {\n    return (\n      <div className=\"filedrop-hint\">\n        <AnimatedDiv className=\"inner\" pose={this.state.visible ? 'open' : 'closed'}>\n          <span className=\"icon\">&#xf0ee;</span>\n          <p className=\"instructions\">\n            Drop files or IIIF manifest URLs to add them to your workspace.\n          </p>\n          <p className=\"supported\">\n            Supported formats: plain text (UTF-8), TEI/XML, image files, CSV (UTF-8)\n          </p>\n        </AnimatedDiv>\n      </div>\n    )\n  }\n\n}\n","export default class Selection {\n    \n  constructor(selectedItems) {\n    if (selectedItems)\n      this._selection = selectedItems;\n    else \n      this._selection = [];\n  }\n\n  isEmpty() {\n    return this._selection.length === 0;\n  }\n\n  includes(item) {\n    return this._selection.includes(item);\n  }\n\n  isSingleSelection() {\n    return this._selection.length === 1;\n  }\n\n  isSingleFolder() {\n    return this._selection.length === 1 && this._selection[0].type === 'FOLDER';\n  }\n\n  isSingleDocument() {\n    return this._selection.length === 1 && this._selection[0].type === 'DOCUMENT';\n  }\n\n  includesText() {\n    const withText = this._selection.filter(item => {\n      return item.filetypes && item.filetypes.find(ft => ft.startsWith(\"TEXT\"));\n    });\n    return withText.length > 0;\n  }\n\n  get(idx) {\n    return this._selection[idx];\n  }\n\n  getItems() {\n    return this._selection;\n  }\n\n  /** Immutable - returns a new selection object **/\n  selectItem = (item, isCtrlPressed) => {\n    if (isCtrlPressed) {\n      const thisIdx = this._selection.indexOf(item);\n      const isSelected = thisIdx > -1;\n    \n      let cloned = this._selection.slice(0);\n\n      // Toggle this item, leave the rest of the selection unchanged\n      if (isSelected) {\n        cloned.splice(thisIdx, 1);\n      } else {\n        cloned.push(item);\n      }      \n\n      return new Selection(cloned);\n    } else {\n      // Select just this item\n      return new Selection([ item ]);\n    }\n  }\n\n  /**\n   * Range selection: SHIFT + click. \n   * \n   * Behavior follows Mac conventions, cf. \n   * https://stackoverflow.com/questions/2959887/algorithm-for-shift-clicking-items-in-a-collection-to-select-them\n   * \n   * Immutable - returns a new selection object\n   */\n  selectRange = (allItems, toIdx) => {\n    const selectedIndices = this._selection.map(item => {\n      return allItems.indexOf(item);\n    });   \n    \n    const minIdx = Math.min.apply(null, selectedIndices);\n    const maxIdx = Math.max.apply(null, selectedIndices);\n\n    const isOutside = (toIdx > maxIdx) || (toIdx < minIdx);\n\n    const slice = (from, to) => allItems.slice(from, to + 1);\n\n    if (isOutside && toIdx > maxIdx)\n      // Expand selection downwards\n      return new Selection(slice(minIdx, toIdx));\n    else if (isOutside)\n      // Expand selection upwards\n      return new Selection(slice(toIdx, maxIdx));\n    else\n      // Fill from topmost\n      return new Selection(slice(minIdx, toIdx));\n  }\n\n  /** \n   * Helper function that handles click/SHIFT+click/CTRL+click selection \n   * on an item and returns a new selection, if valid.\n   */\n  handleClick(evt, item, idx, allItems) {\n    const isShift = evt.getModifierState(\"Shift\");\n    const isCtrl = evt.getModifierState(\"Control\");\n    \n    // Is this a selection or deselection?\n    const isSelectAction = \n      (isShift || isCtrl || ! this.includes(item));\n\n    if (isSelectAction) {\n      const newSelection = isShift ?\n        this.selectRange(allItems, idx) :\n        this.selectItem(item, isCtrl);\n\n      evt.preventDefault();\n      return newSelection;\n    }\n  }\n  \n}","import Selection from '../common/documents/Selection';\n\nconst DEFAULT_STATE = {\n  account: null,         // Null if not loaded\n  \n  view: 'MY_DOCUMENTS',  // MY_DOCUMENTS, SHARED_WITH_ME, SEARCH\n  presentation: 'TABLE', // 'TABLE' or 'GRID'\n  \n  page: {\n    breadcrumbs: null,\n    readme: null,\n    total_count: 0,\n    items: []             // Folders and documents\n  },\n\n  selection: new Selection(),        \n  \n  table_config: {\n    columns: [\n      \"author\",\n      \"title\",\n      \"language\",\n      \"date_freeform\",\n      \"uploaded_at\",\n      \"last_edit_at\"\n    ],\n    sorting: { by: null, asc: true } \n  },\n\n  busy: true,            // If loading is in progress\n\n  runningTasks: []\n};\n\nexport const initialState = () => {\n\n  const stored = {};\n\n  // Helper\n  const addIfDefined = (key) => {\n    const value = localStorage.getItem(`recogito.workspace.${key}`);\n    if (value) stored[key] = JSON.parse(value);\n  }\n\n  ['view', 'presentation', 'table_config'].map(addIfDefined)\n\n  return { ...DEFAULT_STATE, ...stored };\n}\n\nexport const persistState = (key, value) => {\n  const prefixed = `recogito.workspace.${key}`\n  localStorage.setItem(prefixed, JSON.stringify(value));\n}\n\n","import React, { Component } from 'react';\n\nexport default class ModalForm extends Component {\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeydown, false);\n  }\n\n  handleKeydown = (evt) => {\n    if (evt.which === 27) this.props.onCancel(); // Escape\n  }\n\n  render() {\n    return (\n      <div className={`clicktrap ${this.props.className}`}>\n        <div className={`modal-wrapper modal-form-wrapper ${this.props.className}`}>\n          <div className=\"modal\">\n            <div className=\"modal-inner\">\n              <div>\n                {this.props.children}\n              </div>\n\n              <div className=\"footer\">\n                <button \n                  className=\"btn outline tiny\"\n                  onClick={this.props.onCancel}>Cancel</button>\n\n                <button\n                  className=\"btn tiny\"\n                  onClick={this.props.onOk}>Ok</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport axios from 'axios';\n\nimport ModalForm from '../ModalForm';\n\nclass CreateFolderForm extends Component {\n\n  state = {\n    folderName : ''\n  }\n\n  onChange = evt => {\n    this.setState({ folderName: evt.target.value });\n  }\n\n  onKeyPress = evt => {\n    if (evt.which === 13) // Enter\n      this.onOk();\n  }\n\n  onOk = () => {\n    this.props.onOk(this.state.folderName);\n  }\n\n  render() {\n    return (\n      <ModalForm\n        onOk={this.onOk}\n        onCancel={this.props.onCancel}>\n  \n        <input \n          type=\"text\" \n          autoFocus={true}\n          placeholder=\"Folder name\" \n          value={this.state.folderName}\n          onChange={this.onChange} \n          onKeyPress={this.onKeyPress}/>\n      </ModalForm>\n    )\n  }\n\n} \n\nexport const createFolder = () => {\n  return new Promise(resolve => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n\n    const onOk = folderName => { \n      const currentFolderId = document.location.hash.substring(1);\n\n      axios.post('/api/folder', {\n        title: folderName || 'Unnamed Folder',\n        parent: currentFolderId\n      }).then(() => {\n        container.remove();\n        resolve();\n      });\n    }\n\n    const onCancel = () => {\n      container.remove();\n      resolve();\n    }\n\n    render(\n      <CreateFolderForm \n        onOk={onOk}\n        onCancel={onCancel} />, container);\n  });\n};\n\nexport const renameFolder = (folder, title) => {\n  return axios.put(`/api/folder/${folder.id}?title=${title}`);\n}","import React, { Component } from 'react';\n\nexport default class Meter extends Component {\n\n  render() {\n    return (\n      <div\n        className=\"meter\"\n        style={{ position: 'relative' }}>\n\n        <div\n          className=\"bar\"\n          style={{\n            width: `${100 * this.props.value}%`,\n            height: '100%'\n          }} />\n      </div>\n    )\n  }\n\n}\n","import React from 'react';\nimport Meter from '../../../common/Meter.jsx';\n\nconst FileProgress = props => {\n\n  return (\n    <li>\n      {props.upload.file.name}\n      <span className={`icon spinner ${props.upload.status}`}></span>\n    </li>\n  );\n\n}\n\nconst ImportProgressModal = props => {\n  const totalLoaded = props.uploads.reduce((total, u) => total + u.progress, 0);\n    \n  const errors = props.uploads.reduce((errors, u) => { \n    if (u.error) errors.push(u.error);\n    return errors;\n  }, []);\n\n  return (\n    <div className=\"upload-progress\">\n      <div className=\"phase\">\n        { props.phase }\n\n        <button \n          className=\"close nostyle\"\n          onClick={props.onClose}>&#xe897;</button>\n      </div>\n\n      <ul className={`files${(errors.length > 0) ? ' has-errors' : ''}`}>\n        { props.uploads.map(u => <FileProgress key={u.file.name} upload={u} />) }\n\n        { props.uploads.length === 0 &&\n          <li>\n            Fetching content from remote source...\n            <span className=\"icon spinner RUNNING\"></span>\n          </li>\n        }\n      </ul>\n\n      { errors.length > 0 && \n        <ul className=\"errors\">\n          <li>{errors.join()}</li>\n        </ul> \n      }\n\n      <div className=\"progress\">\n        <Meter value={totalLoaded / props.totalSize} />\n      </div>\n    </div>\n  )\n\n}\n\nexport default ImportProgressModal;","import React, { Component } from 'react';\nimport axios from 'axios';\nimport ImportProgressModal from './ImportProgressModal';\n\n/** \n * A stateful container component to manage the\n * upload process.\n */\nexport default class Uploader extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = this.initialState(props);\n    this.start();\n  }\n\n  initialState(props) {\n    return {\n      phase: 'Uploading',\n      totalSize: props.files.reduce((total, f) => f.size + total, 0),\n      uploadId: null,\n      uploads: props.files.map(f => {\n        return {\n          file: f,\n          filepartId: null,\n          status: 'UPLOADING', \n          progress: 0,\n          error: null\n        };\n      }),\n      error: null\n    };\n  }\n\n  componentWillReceiveProps(props) {\n    this.setState(this.initialState(props));\n  }\n\n  /** Helper to update a specific upload in the state array **/\n  updateUploadState = (upload, diff) => {\n    this.setState(prev => { \n      return { \n        uploads: prev.uploads.map(u => u.file === upload.file ? { ...u, ...diff } : u) \n      }\n    });\n  }\n\n  /**\n   * Initializes a new document, using the filename as title,\n   * or a 'New document' placeholder in case there are multiple files.\n   */\n  initNewDocument = () => {\n    const title = (this.state.uploads.length === 1) ? this.state.uploads[0].file.name : 'New document';\n    const formdata = new FormData();\n    formdata.append('title', title);\n\n    return axios.post('/my/upload', formdata, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    });\n  }\n\n  /** Uploads files in parallel **/\n  uploadFiles = () => {\n    // Helper: handles upload for one file\n    const uploadOne = upload => {\n      const formdata = new FormData();\n      formdata.append('file', upload.file);\n\n      const onUploadProgress = (evt) => {\n        this.updateUploadState(upload, { progress: evt.loaded });\n      }\n\n      return axios.post(`/my/upload/${this.state.uploadId}/file`, formdata, {\n        headers: { 'X-Requested-With': 'XMLHttpRequest' },\n        onUploadProgress: onUploadProgress\n      }).then(result => {\n        this.updateUploadState(upload, { \n          filepartId: result.data.uuid\n        });\n        return result;\n      }).catch(error => {\n        this.updateUploadState(upload, {\n          status: 'FAILED',\n          error: error.response.data\n        });\n      });\n    }\n\n    // The list of request promises...\n    const requests = this.state.uploads.map(uploadOne);\n\n    // ... rolled into a promise of the list of request results\n    return Promise.all(requests);\n  }\n\n  importRemoteSource() {\n    this.setState({ phase: 'Importing' });\n\n    const formdata = new FormData();\n    formdata.append('url', this.props.remoteSource.url);\n    formdata.append('type', this.props.remoteSource.sourceType);\n\n    return axios.post(`/my/upload/${this.state.uploadId}/file`, formdata, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    });\n  }\n\n  finalizeDocument = () => {\n    const currentFolder = document.location.hash.substring(1);\n\n    const url = currentFolder ?\n      `/my/upload/${this.state.uploadId}/finalize?folder=${currentFolder}` :\n      `/my/upload/${this.state.uploadId}/finalize`;\n\n    return axios.post(url, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    }).then(result => {\n      const tasks = result.data.running_tasks;\n\n      if (tasks && tasks.length > 0) {\n        this.setState({ phase: 'Importing...' });\n        this.pollTaskProgress(result.data.document_id, tasks);\n      } else {\n        this.setState({ phase: 'Completed' });\n        this.state.uploads.forEach(u => {\n          if (u.status !== 'FAILED') this.updateUploadState(u, { status: 'COMPLETED' });\n        });\n        this.props.onComplete();\n      }\n    }).catch(error => {\n      console.log(error);\n    });\n  }\n\n  pollTaskProgress = (documentId, taskTypes) => {    \n    axios.get(`/api/job?id=${documentId}`)\n      .then(result => {\n        this.state.uploads.forEach(u => {\n          const progress = result.data.subtasks.find(t => t.filepart_id === u.filepartId);\n          if (progress)\n            this.updateUploadState(u, { status: progress.status });\n          else // No progress status - complete\n            this.updateUploadState(u, { status: 'COMPLETED' });\n        });\n\n        const isComplete = this.state.uploads.reduce((isComplete, u) => {\n          return isComplete && u.status === 'COMPLETED';\n        }, true);\n\n        if (isComplete) {\n          this.setState({ phase: 'Completed' });\n          this.props.onComplete();\n        } else {\n          setTimeout(() => this.pollTaskProgress(documentId, taskTypes), 1000);\n        }\n      }).catch(error => {\n        if (error.response.status === 404)\n          // Tasks might still be initializing\n          setTimeout(() => this.pollTaskProgress(documentId, taskTypes), 1000);\n      });\n  }\n\n  /** \n   * Starts a new upload.\n   * \n   * Since one document generally consists of multiple files, the \n   * upload process is three-stage: \n   * \n   * 1. the new document is initialized, and assigned an ID on the server\n   * 2. all files are uploaded to this document\n   * 3. a finalization requests closes the document, and waits for any\n   *   processing (image tiling, TEI conversion) to finish\n   */\n  start() {\n    this.initNewDocument().then((result) => {\n      this.setState({ uploadId: result.data.id });\n      // Branch based on files vs. remote URL\n      return this.props.remoteSource ?\n        this.importRemoteSource() : this.uploadFiles();\n    }).catch(error => {\n      this.setState({ error: error });\n    }).then(this.finalizeDocument);\n  }\n\n  render() {\n    return (\n      <ImportProgressModal\n        phase={this.state.phase}\n        totalSize={this.state.totalSize}\n        uploads={this.state.uploads}\n        error={this.state.error}\n        onClose={this.props.onClose} />\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport Importer from './Importer';\nimport ModalForm from '../ModalForm';\n\n/**\n * Basically a simple popup box with a text input field,\n * but with the added functionality that it's possible to\n * drag-and-drop a URL into the input field.\n */\nclass URLInputForm extends Component {\n\n  state = {\n    url : ''\n  }\n\n  onChange = evt => {\n    this.setState({ url: evt.target.value });\n  }\n\n  onDrop = evt => {\n    const url = evt.dataTransfer.getData('text');\n    this.setState({ url: url });\n  }\n\n  onKeyPress = evt => {\n    if (evt.which === 13) // Enter\n      this.onOk();\n  }\n\n  onOk = () => {\n    this.props.onOk(this.state.url);\n  }\n\n  render() {\n    return (\n      <ModalForm\n        onOk={this.onOk}\n        onCancel={this.props.onCancel}>\n  \n        <input \n          type=\"text\" \n          autoFocus={true}\n          placeholder=\"Paste or drag URL\" \n          value={this.state.url}\n          onChange={this.onChange} \n          onDrop={this.onDrop}\n          onKeyPress={this.onKeyPress}/>\n      </ModalForm>\n    )\n  }\n\n} \n\nconst promptForUrl = () => {\n\n  return new Promise(resolve => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n\n    const done = url => { \n      container.remove();\n      resolve(url);\n    }\n\n    render(\n      <URLInputForm \n        onOk={done}\n        onCancel={() => done()} />, container);\n  });\n\n}\n\nconst identifySource = url => {\n  if (url.includes('request=GetPassage'))\n    return 'CTS'\n  else // to be extended later\n    return 'IIIF';\n}\n\nconst importContent = (files, remoteSource) => {\n  return new Promise(resolve => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n\n    const onComplete = () => {\n      container.remove();\n      resolve();\n    }\n\n    const onClose = result => {\n      container.remove();\n    }\n\n    render(<Importer \n      files={files}\n      remoteSource={remoteSource}\n      onComplete={onComplete}\n      onClose={onClose} />, container);\n  });\n}\n\n/** Import a list of files **/\nexport const uploadFiles = files => {\n  return importContent(files);\n}\n\n/** \n * Import content from a remote source\n * \n * Note that one argument (either type or URL) may be undefined. \n * \n * -) When a URL is imported via drag-and-drop, only the URL will be\n * provided (and we can use the 'identifySource' function to attempt\n * type identification)\n * \n * -) When a source is imported via the sidebar menu option, only\n * the type will be provided & this class will provide (or delegate) the\n * import UI components.\n */\nexport const importSource = (typ, url) => {\n  const sourceType = typ || identifySource(url);\n  \n  if (url) {\n    return importContent([], { url: url, sourceType: sourceType });\n  } else {\n    return promptForUrl().then(url => {\n      if (url)\n        return importContent([], { url: url, sourceType: sourceType });\n    });\n  }\n}","import React, { Component } from 'react';\nimport axios from 'axios';\nimport Meter from '../../../../common/Meter.jsx';\n\nexport default class NERProgressModal extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      status: 'PENDING',\n      progress: 0, // 0 - 100\n      tasks: 0,\n      tasksCompleted: 0\n    };\n\n    this.pollProgress();\n  }\n\n  pollProgress() { \n    axios.get(`/api/job/${this.props.jobId}`)\n      .then(result => {\n        this.setState({\n          status: result.data.status,\n          progress: result.data.progress,\n          tasks: result.data.subtasks.length,\n          tasksCompleted: result.data.subtasks.filter(t => t.status === 'COMPLETED').length,\n          tasksFailed: result.data.subtasks.filter(t => t.status === 'FAILED').length\n        });\n\n        const isDone = result.data.status === 'COMPLETED' || result.data.status === 'FAILED';\n        if (isDone)\n          this.props.onComplete && this.props.onComplete();\n        else\n          setTimeout(() => this.pollProgress(), 1000);\n      })\n      .catch(error => {\n        if (error.response.status === 404)\n          // Tasks might still be initializing\n          setTimeout(() => this.pollProgress(), 1000);\n      });\n  }\n\n  render() {\n    const isDone = \n      this.state.status === 'COMPLETED' || \n      this.state.status === 'FAILED';\n\n    return (\n      <div className=\"job-progress\">\n        <div className=\"header\">\n          Named Entity Recognition { isDone && <button \n            className=\"close nostyle\"\n            onClick={this.props.onClose}>&#xe897;</button>\n          }\n        </div>\n\n        <div className=\"body\">\n          <div className=\"message\">\n            Parsed {this.state.tasksCompleted} of {this.state.tasks} files\n            <span className={`icon spinner ${this.state.status}`}></span>\n          </div>\n\n          <div className=\"progress\">\n            <Meter value={this.state.progress / 100} />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class AuthoritySelection extends Component {\n\n  onChange(identifier) {   \n    const selection = this.props.selected; \n    const currentIdx = selection.indexOf(identifier);\n\n    if (currentIdx < 0)\n      selection.push(identifier);\n    else\n      selection.splice(currentIdx, 1); \n\n    this.props.onChange(selection);\n  }\n\n  render() {    \n    return (\n      <div className=\"authorities\">\n        <h2>Authority Files</h2>\n\n        <input\n          type=\"checkbox\" \n          id=\"use-all-authorities\"\n          checked={this.props.useAll} \n          onChange={this.props.onToggleAll} />\n        <label htmlFor=\"use-all-authorities\">identify entities against all available authority files</label>\n\n        <div className={`authority-list${this.props.useAll ? ' disabled' : ''}`}>\n          <table>\n            <tbody>\n              {this.props.authorities.map(authority => \n                <tr key={authority.identifier}>\n                  <td>\n                    <input \n                      type=\"checkbox\" \n                      id={authority.identifier} \n                      checked={this.props.selected.includes(authority.identifier)} \n                      onChange={this.onChange.bind(this, authority.identifier)} />\n                    <label htmlFor={authority.identifier} />\n                  </td>\n\n                  <td className=\"shortname\">\n                    <span style={{ backgroundColor: authority.color}}>\n                      {authority.homepage ? \n                        <a href={authority.homepage} \n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\">{authority.shortname}</a>\n                        : \n                        authority.shortname\n                      }\n                    </span>\n                  </td>\n\n                  <td className=\"fullname\">\n                    {authority.fullname}\n                  </td>\n                </tr>\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class EngineSelection extends Component {\n\n  render() {\n    return (\n      <div className=\"engines\">\n        <h2>Recognition Engines</h2>\n        <table cellSpacing=\"0\">\n          <tbody>\n            {this.props.engines.map((engine, idx) =>\n              <React.Fragment key={idx}>\n                <tr>\n                  <td className=\"name\">\n                    <input \n                      id={engine.identifier}\n                      type=\"radio\" \n                      group=\"engines\" \n                      checked={this.props.selected === engine.identifier}\n                      onChange={this.props.onChange.bind(this, engine.identifier)} />\n                    \n                    <label htmlFor={engine.identifier}>\n                      <span className=\"name\">{engine.name}</span>\n                    </label>\n                  </td>\n\n                  <td className=\"languages\">\n                    { engine.languages.map(lang => <span key={lang}>{lang}</span>) }\n                  </td>\n\n                  <td className=\"description\">\n                    {engine.description}\n                  </td>\n                </tr>\n                \n                <tr className=\"spacer\"></tr>\n              </React.Fragment>\n            )}\n          </tbody>\n        </table>\n        <p className=\"note\">\n          Note: different engines can provide different results and are generally \n          optimized for a specific language.\n        </p>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\nimport Modal from '../../../../common/Modal';\nimport AuthoritySelection from './authorities/AuthoritySelection';\nimport EngineSelection from './engines/EngineSelection';\n\nexport default class NERModal extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      available_engines: [],\n      available_authorities: [],\n\n      selected_engine: null,\n      selected_all_authorities: true,\n      selected_authorities: []\n    };\n\n    this.initAvailableAuthorities();\n    this.initAvailableEngines();\n  }\n\n  isInitComplete() {\n    return this.state.available_engines.length > 0 &&\n      this.state.available_authorities.length > 0;\n  }\n\n  initAvailableEngines() {\n    if (this.state.available_engines.length === 0)\n      axios.get('/api/plugins/ner')\n        .then(result => {\n          const diff = { available_engines: result.data };\n\n          if (!this.state.selected_engine) // Select first as default\n            diff.selected_engine = result.data[0] && result.data[0].identifier;\n\n          this.setState(diff);\n        });\n  }\n\n  initAvailableAuthorities() {\n    axios.get('/api/authorities/gazetteers')\n      .then(result => {\n        const diff = { available_authorities: result.data };\n\n        if (this.state.selected_all_authorities || \n             (!this.state.selected_all_authorities && this.state.selected_authorities.length === 0))\n          diff.selected_authorities = result.data.map(a => a.identifier);\n\n        this.setState(diff);\n      });\n  }\n\n  changeEngine(identifier) {\n    this.setState({ selected_engine: identifier });\n  }\n\n  toggleAllAuthorities() {\n    this.setState(prev => {\n      return { selected_all_authorities: !prev.selected_all_authorities }\n    });\n  }\n\n  changeAuthorities(authorities) {\n    this.setState({ selected_authorities: authorities });\n  }\n\n  onStart() {\n    const response = { engine: this.state.selected_engine };\n\n    if (this.state.selected_all_authorities)\n      response.all_authorities = true;\n    else \n      response.authorities = this.state.selected_authorities;\n\n    this.props.onStart(response);\n  }\n\n  render() {\n    return (\n      <Modal\n        className=\"ner\" \n        title=\"Named Entity Recognition (NER)\"\n        onClose={this.props.onCancel}>\n\n        <p>\n          NER identifies places and persons in your text automatically. \n          Depending on the length of your text, this may take a while. \n        </p>\n\n        <EngineSelection \n          engines={this.state.available_engines} \n          selected={this.state.selected_engine}\n          onChange={this.changeEngine.bind(this)} />\n\n        <AuthoritySelection \n          authorities={this.state.available_authorities} \n          useAll={this.state.selected_all_authorities}\n          selected={this.state.selected_authorities}\n          onToggleAll={this.toggleAllAuthorities.bind(this)} \n          onChange={this.changeAuthorities.bind(this)} />\n\n        <div className=\"buttons\">\n          <button\n            className=\"btn start\"\n            onClick={this.onStart.bind(this)}>Start NER</button>\n\n          <button \n            className=\"btn outline cancel\"\n            onClick={this.props.onCancel}>Cancel</button>\n        </div>\n      </Modal>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\nimport NERProgressModal from './progress/NERProgressModal';\nimport NERConfigurationModal from './configuration/NERConfigurationModal';\n\n/** \n * A stateful container component to manage the\n * entity recognition process.\n */\nexport default class EntityRecognition extends Component {\n\n  state = {\n    running: false,\n    jobId: null\n  }\n\n  start = config => {\n    const textDocuments = this.props.selection.getItems().filter(item => {\n      const isDocument = item.type === 'DOCUMENT';\n      const hasTextParts = item.filetypes.filter(t => t.startsWith('TEXT')).length > 0;\n      return isDocument && hasTextParts;\n    });\n\n    const taskDefinition = { \n      ...{ task_type: 'NER', documents: textDocuments.map(d => d.id) }, \n      ...config \n    }\n\n    axios.post('/api/job', taskDefinition).then(response => {\n      this.setState({\n        running: true,\n        jobId: response.data.job_id\n      });\n    });\n  }\n\n  render() {\n    return this.state.running ? (\n      <NERProgressModal\n        jobId={this.state.jobId} \n        onComplete={this.props.onComplete} \n        onClose={this.props.onClose} />\n    ) : (\n      <NERConfigurationModal \n        onStart={this.start} \n        onCancel={this.props.onCancel} />\n    )\n  }\n\n}","import axios from 'axios';\n\n/** API URL for POST or DELETE **/\nconst getUrl = () => {\n  const currentFolderId = document.location.hash.substring(1);\n  return currentFolderId ?\n    `/api/folder/${currentFolderId}/readme` : '/api/directory/my/readme';\n}\n\n\nexport const updateReadme = function(readme, currentPageState) {\n  return axios.post(getUrl(), { data: readme }).then(() => { \n    return { ...currentPageState, ...{ readme: readme } };\n  });\n}\n\nexport const deleteReadme = function(currentPageState) {\n  return axios.delete(getUrl()).then(() => {\n    return { ...currentPageState, ...{ readme: null } };\n  }); \n}","import React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport Draggable from 'react-draggable';\n\nclass Prompt extends Component {\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onKeydown = (evt) => {\n    if (evt.which === 27) this.props.onNo();\n  }\n\n  render() {\n    const className = (this.props.type) ? `prompt ${this.props.type.toLowerCase()}` : 'prompt';\n\n    return (\n      <div className=\"clicktrap\">\n        <Draggable handle=\".prompt-header\">\n          <div className={className}>\n            <div className=\"prompt-header\">\n              <h1 className=\"title\">{this.props.title}</h1>\n            </div>\n\n            <div className=\"prompt-body\">\n              <p className=\"message\">{this.props.message}</p>\n              <p className=\"buttons\">\n                 <button className=\"btn yes\" onClick={this.props.onYes}>YES</button>\n                 <button className=\"btn outline no\" onClick={this.props.onNo}>NO</button>\n              </p>\n            </div>\n          </div>\n        </Draggable>\n      </div>\n    )\n  }\n\n}\n\nexport const confirm = props => {\n  const promptRoot = document.createElement('div');\n  promptRoot.setAttribute('id', 'confirm-prompt-root');\n  document.body.append(promptRoot);\n\n  const onYes = () => {\n    promptRoot.remove();\n    props.onConfirm();\n  }\n\n  const onNo = () => {\n    promptRoot.remove();\n    props.onCancel && props.onCancel();\n  }\n\n  render(\n    <Prompt \n      title={props.title}\n      type={props.type}\n      message={props.message}\n      onYes={onYes}\n      onNo={onNo} />, promptRoot);\n}","import React, { Component } from 'react';\nimport axios from 'axios';\n\nexport default class PublicAccess extends Component {\n\n  state = {\n    visibility: 'PRIVATE',\n    access_level: 'READ_ALL'\n  }\n\n  componentDidMount() {\n    axios.get(`/api/sharing/folders/${this.props.item.id}/visibility`)\n      .then(result => {\n        const { visibility, access_level } = result.data;\n        this.setState({ visibility: visibility, access_level: access_level || 'READ_ALL' });\n      });\n  }\n\n  updateSetting = (update) => {\n    this.setState(update, () => {\n      axios.post('/api/sharing/folders/visibility', {\n        ...this.state, ids: [ this.props.item.id ]\n      }).catch(error => {\n        // TODO \n      });\n    });\n  }\n\n  onChangeVisibility = (visibility) => {\n    this.updateSetting({ visibility: visibility });\n  }\n\n  onChangeAccessLevel = (evt) => {\n    this.updateSetting({ access_level: evt.target.value });\n  }\n\n  render() {\n    return (\n      <div className=\"public-access\">\n        <div className=\"multi-share-section\">\n          <h3>Enable Public Access</h3>\n          <div>\n            <input \n              type=\"radio\" \n              name=\"public-access\" id=\"pa-off\"\n              checked={this.state.visibility === 'PRIVATE'} \n              onChange={() => this.onChangeVisibility('PRIVATE')} />\n            <label htmlFor=\"pa-off\">Off</label>\n            <p>\n              Only people you explicitly add as collaborators have access.\n            </p>\n          </div>\n\n          <div>\n            <input \n              type=\"radio\" \n              name=\"public-access\" \n              id=\"pa-public\" \n              checked={this.state.visibility === 'PUBLIC'} \n              onChange={() => this.onChangeVisibility('PUBLIC')} />\n            <label htmlFor=\"pa-public\">Anyone on the Web</label>\n            <p>\n              Public documents are listed on your profile page, and anyone on the Internet can find them.\n            </p>\n          </div>\n\n          <div>\n            <input \n              type=\"radio\"\n              name=\"public-access\" \n              id=\"pa-with-link\" \n              checked={this.state.visibility === 'WITH_LINK'} \n              onChange={() => this.onChangeVisibility('WITH_LINK')} />\n            <label htmlFor=\"pa-with-link\">Anyone with the Link</label>\n            <p>\n              Accessible to anyone who has the link, but it is not listed on your profile page.\n            </p>\n          </div>\n        </div>\n\n        <div className=\"multi-share-section\">\n          <strong>Access:</strong> anyone can\n\n          <select value={this.state.access_level} onChange={this.onChangeAccessLevel}>\n            <option value=\"READ_ALL\">view</option>\n            <option value=\"READ_DATA\">view map and downloads but not document content</option>\n            <option value=\"WRITE\">annotate</option>\n          </select>\n\n          <p>\n            Annotating requires a Recogito account. Visitors who are not logged in can view\n            documents (if enabled), and download annotations from the download page. But \n            they cannot add annotations, even when public annotation is enabled. Blocking \n            access to document content will also limit some of the download options.\n          </p>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { render} from 'react-dom';\n\nclass PermissionSelector extends Component {\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.onMousedown, false);\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMousedown, false);\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onMousedown = (evt) => {\n    const isClickOutside = !this._node.contains(evt.target);\n    if (isClickOutside) this.props.onCancel();\n  }\n\n  onKeydown = (evt) => {\n    evt.stopPropagation();\n    if (evt.which === 27) this.props.onCancel();\n  }\n\n  handleCancel= () => {\n    this.props.onCancel();\n  }\n\n  changeLevel(level) {\n    this.props.onChangeLevel(level);\n  }\n\n  render() {\n    return (\n      <div \n        className=\"permission-selector\"\n        ref={n => this._node = n}>\n\n        <h3>Permission Level\n          <span className=\"close outline-icon\" onClick={this.handleCancel}>{'\\ue897'}</span>\n        </h3>\n        <ul>\n          <li\n            className=\"READ\"\n            onClick={() => this.changeLevel('READ')}>\n            <div className=\"checked\">\n              <div className=\"icon\">\n                {this.props.accessLevel === 'READ' && '\\uf00c' }\n              </div>\n            </div>\n            <h4>Read</h4>\n            <p>Collaborators can read document and annotations, but not edit.</p>\n          </li>\n\n          <li \n            className=\"WRITE\"\n            onClick={() => this.changeLevel('WRITE')}>\n            <div className=\"checked\">\n              <div className=\"icon\">\n                {this.props.accessLevel === 'WRITE' && '\\uf00c' }\n              </div>\n            </div>\n            <h4>Write</h4>\n            <p>Collaborators can read document and annotations, create new annotations, add and reply to comments.</p>\n          </li>\n\n          <li\n            className=\"ADMIN\"\n            onClick={() => this.changeLevel('ADMIN')}>\n            <div className=\"checked\">\n              <div className=\"icon\">\n                {this.props.accessLevel === 'ADMIN' && '\\uf00c' }\n              </div>\n            </div>\n            <h4>Admin</h4>\n            <p>Admins can edit document metadata, invite other collaborators, backup and restore, and roll back the edit history.</p>\n          </li>\n        </ul>\n      </div>\n    )\n  }\n\n}\n\nexport function openSelector(config) {\n  const parent = config.parent;\n  const root = document.createElement('div');\n  parent.append(root);\n\n  const onCancel = () => {\n    root.remove(); \n  }\n\n  const onChangeLevel = (level) => {\n    config.onChangeLevel(level);\n    root.remove();\n  }\n\n  render(\n    <PermissionSelector \n      accessLevel={config.accessLevel}\n      onChangeLevel={onChangeLevel}\n      onCancel={onCancel} />, \n  root);\n}","import React, { Component } from 'react';\nimport { AsyncTypeahead } from 'react-bootstrap-typeahead'; \nimport axios from 'axios';\n\nexport default class AutoComplete extends Component {\n\n  state = {\n    isLoading: false,\n    options: [],\n    selected: null,\n    inputValue: null\n  }\n\n  fetchSuggestions = query => {\n    this.setState({isLoading: true});\n    axios.get(`/api/sharing/search?q=${query}`)\n      .then(result => this.setState({\n        isLoading: false,\n        options: result.data.filter(username => !this.props.exclude.includes(username))\n      }));\n  }\n\n  onChange = (selected) => {\n    // this.props.onSelect(selected[0]);\n    this.setState({ selected: selected });\n  }\n\n  onInputChange = (value) => {\n    this.setState({ inputValue: value });\n  }\n\n  clear = () => {\n    this._input.getInstance().clear();\n    this.setState({ \n      selected: null,\n      inputValue: null\n    });\n  }\n\n  onKeyDown = (evt) => {\n    const { selected, inputValue, options } = this.state;\n    if (evt.which === 13) { // Enter\n      if (selected && selected.length === 1) {\n        this.props.onSelect(selected[0]);\n        this.clear();\n      } else if (inputValue && options.includes(inputValue)) {\n        this.props.onSelect(inputValue);\n        this.clear();\n      }\n    }\n  }\n\n  render() {\n    return (\n      <AsyncTypeahead\n        id=\"add-collaborator-input\"\n        ref={r => this._input = r}\n        className=\"autocomplete\"\n        placeholder=\"Enter username\"\n        selected={this.state.selected}\n        onChange={this.onChange}\n        onInputChange={this.onInputChange}\n        onKeyDown={this.onKeyDown}\n        isLoading={this.state.isLoading}\n        onSearch={this.fetchSuggestions} \n        options={this.state.options} />\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport axios from 'axios';\nimport { openSelector } from './PermissionSelector.js';\nimport Autocomplete from './Autocomplete.jsx';\n\nexport default class Collaborators extends Component {\n\n  state = {\n    collaborators: []\n  }\n\n  componentDidMount() {\n    axios.get(`/api/sharing/folders/${this.props.item.id}/collaborators`)\n    .then(result => {\n      this.setState({ collaborators: result.data.collaborators });\n    });\n  }\n\n  storeCollaborator = (setting) => {\n    axios.post('/api/sharing/folders/collaborator', {\n      ...setting, ids: [ this.props.item.id ]\n    }).catch(error => {\n      // TODO \n    });\n  }\n  \n  openPermissionsSelector = (evt, collaborator) => {\n    const button = evt.target.nodeName === 'BUTTON' ? evt.target : evt.target.parentNode;\n\n    openSelector({\n      parent: button.parentNode, \n      accessLevel: collaborator.access_level,\n\n      onChangeLevel: level => { \n        const update= { username: collaborator.username, access_level: level } \n        this.storeCollaborator(update);\n        this.setState(prev => {\n          return {\n            collaborators: prev.collaborators.map(c => {\n              return (c.username === collaborator.username) ? update : c;\n            })\n          }\n        }) \n      }\n    });\n  }\n\n  removeCollaborator = (collaborator) => {\n    this.setState(prev => {\n      return { collaborators: prev.collaborators.filter(c => c.username !== collaborator.username) }\n    });\n\n    axios.delete('/api/sharing/folders/collaborator', { data: {\n      ids: [ this.props.item.id ],\n      username: collaborator.username\n    }}).catch(error => {\n      // TODO\n    })\n  }\n\n  addCollaborator = (username) => {\n    const update = { username: username, access_level: 'READ' }\n    this.storeCollaborator(update);\n    this.setState(prev => {\n      return { \n        collaborators:  [ ...prev.collaborators, update ]\n      }\n    });\n  }\n\n  render() {\n    const collaborators = this.state.collaborators.map(c => \n      <tr key={c.username}>\n        <td>{c.username}</td>\n        <td>\n          <button\n            className=\"btn small permissions\"\n            onClick={(evt) => this.openPermissionsSelector(evt, c)}>\n            <span className=\"label\">{c.access_level}</span>\n            <span className=\"icon\">{'\\uf0dd'}</span>\n          </button>\n        </td>\n        <td className=\"col-actions remove-collaborator\">\n          <button \n            className=\"nostyle outline-icon\"\n            onClick={() => this.removeCollaborator(c)}>{'\\ue897'}</button>\n        </td>\n      </tr>\n    );\n\n    return (\n      <div className=\"collaborators\">\n        <div className=\"multi-share-section\">\n          <h3>Collaborators</h3>\n          <table className=\"collaborators\">\n            <tbody>\n              {collaborators.length > 0 ? \n                  collaborators : <tr className=\"no-collaborators\"><td>There are no collaborators yet. Enter a username below to add one.</td></tr>\n              }\n            </tbody>\n          </table>\n        </div>\n        <div className=\"multi-share-section add-collaborator\">\n          <Autocomplete \n            exclude={this.state.collaborators.map(c => c.username)} \n            onSelect={this.addCollaborator} />\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport Modal from '../../../common/Modal';\nimport PublicAccess from './public/PublicAccess';\nimport Collaborators from './collaborators/Collaborators';\n\nexport default class ShareModal extends Component {\n\n  state = {\n    view: 'PUBLIC_ACCESS'\n  };\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onKeydown = (evt) => {\n    evt.stopPropagation();\n    if (evt.which === 27) this.props.onClose();\n  }\n\n  setView = (name) => {\n    this.setState({ view: name });\n  }\n\n  renderPublicAccess = () => {\n    return <PublicAccess item={this.props.selection.get(0)} />\n  }\n\n  renderCollaborators = () => {\n    return <Collaborators item={this.props.selection.get(0)} />\n  }\n\n  getView = () => {\n    if (this.state.view === 'PUBLIC_ACCESS')\n      return this.renderPublicAccess();\n    else if (this.state.view === 'COLLABORATORS')\n      return this.renderCollaborators();\n  }\n\n  render() {\n    return (\n      <Modal\n        className=\"multi-share-modal\" \n        title=\"Share\"\n        onClose={this.props.onClose}>\n        <div className=\"multi-share\">\n          <div className=\"multi-share-tabs\">\n            <ul>\n              <li \n                className={this.state.view === 'PUBLIC_ACCESS' ? 'active': ''}\n                onClick={() => this.setView('PUBLIC_ACCESS')} >\n                Public Access\n              </li>\n\n              <li \n                className={this.state.view === 'COLLABORATORS' ? 'active': ''}\n                onClick={() => this.setView('COLLABORATORS')} >\n                Collaborators\n              </li>\n\n              <li className=\"disabled\">\n                Distribute Copies\n              </li>\n            </ul>\n          </div>\n\n          <div className=\"multi-share-body\">\n            <div className=\"view-container\">\n              { this.getView() }     \n            </div>     \n\n            <div className=\"footer\">\n              <button\n                className=\"btn\"\n                onClick={this.props.onClose}>Done</button>\n            </div>\n          </div>\n        </div>\n      </Modal>\n    )\n  }\n\n}\n","import { createFolder, renameFolder } from './folder';\nimport { uploadFiles, importSource } from './importing';\nimport { entityRecognition } from './ner';\nimport { updateReadme, deleteReadme } from './readme';\nimport { deleteSelection, duplicateSelection } from './selection';\nimport { shareSelection } from './sharing';\n\n/** \n * Wraps all operations into one object so that \n * we can import them in one go.\n */\nexport default {\n  createFolder,\n  renameFolder,\n  uploadFiles,\n  importSource,\n  updateReadme,\n  deleteReadme,\n  deleteSelection,\n  duplicateSelection,\n  shareSelection,\n  entityRecognition\n};","import axios from 'axios';\nimport { confirm } from '../confirm';\n\nconst deleteFolders = folders => {\n  const ids = folders.map(f => f.id);\n\n  if (ids.length > 0) {\n    return ids.length === 1 ?\n      axios.delete(`/api/folder/${ids[0]}`) : \n      axios.delete(`/api/folder/bulk`, { data: ids });\n  } else {\n    return new Promise((resolve) => { resolve(); });\n  }\n}\n\nconst deleteDocuments = (documents, view) => {\n  const ids = documents.map(d => d.id);\n\n  if (ids.length > 0) {\n    return ids.length === 1 ? (\n      view === 'MY_DOCUMENTS' ? // Delete or unshare \n        axios.delete(`/api/document/${ids[0]}`) : axios.delete(`/api/shared/document/${ids[0]}`) \n    ) : (\n      view === 'MY_DOCUMENTS' ?\n        axios.delete('/api/document/bulk', { data: ids }) : axios.delete('/api/shared/document/bulk', { data: ids })\n    )\n  } else {\n    return new Promise((resolve) => { resolve(); });\n  }\n}\n\nexport const deleteSelection = args => {\n\n  const { \n    selection,\n    view, \n    onStart, \n    onSuccess, \n    onError, \n    onCancel \n  } = args;\n\n  const message = view === 'MY_DOCUMENTS' ?\n    'You are about to permanently delete the selected documents. Are you sure?' :\n    'This will remove the selected documents from your shared documents list. Are you sure?';\n\n  const executeDelete = () => {\n    const folders = selection.getItems().filter(i => i.type === 'FOLDER');\n    const documents = selection.getItems().filter(i => i.type === 'DOCUMENT');\n\n    if (folders.length + documents.length > 0) {\n      onStart();\n\n      deleteDocuments(documents, view)\n        .then(() => deleteFolders(folders))\n        .then(() => {\n          onSuccess();\n        }).catch((error) => {\n          onError(error);\n        });\n    } else {\n      onCancel && onCancel();\n    }\n  }\n\n  confirm({\n    title: 'Delete',\n    message: message,\n    type: 'WARNING',\n    onConfirm: executeDelete,\n    onCancel: onCancel\n  });\n\n}\n\n/** Only supports single documents at them moment **/\nexport const duplicateSelection = selection => {\n  if (selection.isSingleDocument()) {\n    const doc = selection.get(0);\n    return axios.post(`/api/duplicate/document/${doc.id}`);\n  } else {\n    return new Promise((resolve) => { resolve(); });\n  }\n}","import React from 'react';\nimport { render } from 'react-dom';\nimport ShareModal from './ShareModal';\n\nexport const shareSelection = selection => {\n\n  return new Promise(resolve => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n\n    const close = url => { \n      container.remove();\n      resolve();\n    }\n\n    render(\n      <ShareModal\n        selection={selection}\n        onClose={close} />, container);\n  });\n\n}","import React from 'react';\nimport { render } from 'react-dom';\nimport EntityRecognition from './EntityRecognition';\n\nexport const entityRecognition = selection => {\n\n  return new Promise(resolve => {\n    const container = document.createElement('div');\n    document.body.appendChild(container);\n\n    const onComplete = () => {\n      resolve();\n    }\n\n    const onClose = () => {\n      container.remove();\n    }\n\n    render(\n      <EntityRecognition \n        selection={selection}\n        onCancel={onClose} \n        onClose={onClose}\n        onComplete={onComplete} />, container);\n  });\n\n}","import React, { Component } from 'react';\n\nconst MenuGroup = props => {\n\n  const classNames = props.className ? \n    [ 'group', props.className ] : [ 'group']\n\n  return (\n    <li\n      className={classNames.join(' ')}>\n      <ul>\n        {props.children}\n      </ul>\n    </li>\n  );\n\n}\n\nconst MenuItem = props => {\n\n  return (\n    <li\n      key={props.label}\n      className={`option${props.disabled ? ' disabled' : '' }`}\n      onClick={(props.disabled || !props.onSelect) ? null : props.onSelect}>\n\n      {props.link ? \n        <a href={props.link}>\n          {props.icon && <span className=\"icon\">{props.icon}</span> } {props.label}\n        </a>\n        : \n        <span>\n          {props.icon && <span className=\"icon\">{props.icon}</span>} {props.label}\n        </span>\n      }\n    </li>\n  );\n\n}\n\nclass Menu extends Component {\n\n  constructor(props) {\n    super(props);\n    this.onMousedown = this.onMousedown.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.onMousedown, false);\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMousedown, false);\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onMousedown(evt) {\n    const isClickOutside = !this._node.contains(evt.target);\n    if (isClickOutside) this.props.onCancel();\n  }\n\n  onKeydown(evt) {\n    if (evt.which === 27) this.props.onCancel();\n  }\n\n  render() {\n    return (\n      <div\n        ref={n => this._node = n}\n        className={`modal-menu ${this.props.className}`}>\n        <ul>\n          { this.props.children }\n        </ul>\n      </div>\n    )\n  }\n\n}\n\nMenu.Group = MenuGroup;\nMenu.Item = MenuItem;\n\nexport default Menu;\n","import React, { Component } from 'react';\n\nexport default class AdvancedSearch extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.onMousedown = this.onMousedown.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.onMousedown, false);\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMousedown, false);\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onMousedown(evt) {\n    const isClickOutside = !this._node.contains(evt.target);\n    const isClickOnToggle = evt.target.classList.contains('advanced');\n    if (isClickOutside && !isClickOnToggle) this.props.onClose();\n  }\n\n  onKeydown(evt) {\n    if (evt.which === 27) this.props.onClose();\n  }\n\n  render() {\n    return (\n      <div\n        ref={n => this._node = n}\n        className=\"advanced-search\">\n        <button\n          className=\"close nostyle\"\n          onClick={this.props.onClose}>&#xe897;</button>\n\n        <form>\n          <fieldset>\n            <p>\n              <label>Search in</label>\n              <select>\n                <option>All of Recogito</option>\n                <option>My documents</option>\n                <option>Shared with me</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Document type</label>\n              <select>\n                <option>Any</option>\n                <option>Text</option>\n                <option>Image</option>\n                <option>Table</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Owner</label>\n              <select>\n                <option>Anyone</option>\n                <option>me</option>\n                <option>specific user</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Metadata contains</label>\n              <input type=\"text\" />\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Last modified</label>\n              <select>\n                <option>Any time</option>\n                <option>this week</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n          </fieldset>\n          <fieldset className=\"buttons\">\n            <button className=\"nostyle clear\">Clear</button>\n            <button type=\"submit\" className=\"btn\">Search</button>\n          </fieldset>\n        </form>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\n\nimport AdvancedSearch from './AdvancedSearch.jsx';\n\nexport default class Search extends Component {\n\n  state = { \n    advancedSearchOpen: false \n  }\n\n  toggleAdvancedSearch() {\n    this.setState(prev => (\n      { advancedSearchOpen: !prev.advancedSearchOpen }\n    ));\n  }\n\n  search = (evt) => {\n    const query = evt.target.value;\n    if (query.length > 1) {\n      axios.post(`/api/search/all?q=${query}`, this.props.displayConfig).then(result => {\n        this.props.onResponse(result.data);\n      });\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"wrapper\">\n        <div className=\"search\">\n          <div className=\"wrapper\">\n            <input\n              placeholder=\"Search Recogito...\"\n              onChange={this.search} />\n            <button\n              className=\"icon nostyle advanced\"\n            onClick={this.toggleAdvancedSearch.bind(this)}>{'\\ue688'}</button>\n          </div>\n          <span className=\"icon hand-lens\">&#xf002;</span>\n        </div>\n        {this.state.advancedSearchOpen &&\n          <AdvancedSearch onClose={this.toggleAdvancedSearch.bind(this)}/>\n        }\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { CSSTransition } from 'react-transition-group';\nimport Breadcrumbs from '../../common/header/Breadcrumbs';\nimport HeaderIcon from '../../common/header/HeaderIcon';\nimport Menu from  '../../common/Menu';\nimport Search from './search/Search';\n\nconst OptionsMenu = props => {\n\n  const canDuplicate = // Single document in my workspace\n    props.selection.isSingleDocument() && props.view === 'MY_DOCUMENTS';\n\n  const canShare = // Single folder in my workspace\n    props.selection.isSingleFolder() && props.view === 'MY_DOCUMENTS';\n\n  const openInNewTab = () => {\n    window.open(`document/${props.selection.get(0).id}/part/1/edit`, '_blank');\n    props.onCancel();\n  }\n\n  // TODO probably worth splitting this up into a separate source file, or\n  // perhaps two (one OptionsMenu container & one presentational component)\n  return (\n    <Menu \n      className=\"selection-options-menu\"\n      onCancel={props.onCancel}>\n\n      <Menu.Group>\n        <Menu.Item \n          label=\"Open\" \n          disabled={!props.selection.isSingleSelection()} \n          link={props.selection.isSingleSelection() && `document/${props.selection.get(0).id}/part/1/edit`} />\n\n        <Menu.Item \n          label=\"Open in new tab\" \n          disabled={!props.selection.isSingleDocument()} \n          onSelect={openInNewTab} />\n      </Menu.Group>\n      \n      <Menu.Group>\n        <Menu.Item\n          icon={'\\uf114'}\n          label=\"Move to\"\n          disabled />\n\n        <Menu.Item\n          icon={'\\uf0c5'}\n          label=\"Duplicate\"\n          disabled={!canDuplicate}\n          onSelect={props.onDuplicateSelection} />\n\n        <Menu.Item \n          icon={'\\uf014'} \n          label=\"Delete\"\n          onSelect={props.onDeleteSelection} /> \n      </Menu.Group>\n\n      <Menu.Group>\n        <Menu.Item \n          icon={'\\uf234'}\n          label=\"Share\" \n          disabled={!canShare} \n          onSelect={props.onShareSelection} />\n      </Menu.Group>\n\n      <Menu.Group>\n        <Menu.Item \n          icon={'\\uf085'} \n          label=\"Named Entity Recognition\" \n          disabled={!props.selection.includesText()} \n          onSelect={props.onNER} />\n      </Menu.Group>\n    </Menu>\n  );\n\n}\n\nexport default class Header extends Component {\n\n  state = {\n    optionsMenuVisible: false\n  }\n\n  showOptionsMenu = () => {\n    this.setState({ optionsMenuVisible: true });\n  }\n\n  closeOptionsMenu = () => {\n    this.setState({ optionsMenuVisible: false });\n  }\n\n  /** Helper that closes the menu and executes a select action **/\n  closeAndThen = fn => {\n    return args => {\n      this.setState({ optionsMenuVisible: false });\n      fn(args);\n    }\n  }\n\n  render() {\n    const hasSelection = !this.props.selection.isEmpty();\n\n    return (\n      <div className={this.props.readme ? \"header\" : \"header no-readme\"}>\n        <div className=\"top-row\">\n          <Search\n            tableConfig={this.props.tableConfig} \n            onResponse={this.props.onSearchResponse} />\n\n          <div className=\"header-icons\">\n            <HeaderIcon icon=\"&#xe64a;\" className=\"help stroke7\" link=\"/help\" />\n          </div>\n        </div>\n\n        <div className=\"main-header\">\n          <Breadcrumbs \n            view={this.props.view}\n            path={this.props.breadcrumbs}\n            docCount={this.props.docCount}>\n\n            {!this.props.readme && this.props.view === 'MY_DOCUMENTS' &&\n              <button \n                className=\"add-abstract nostyle\"\n                onClick={this.props.onCreateReadme} >\n                <span className=\"icon\">&#xf055;</span>\n                <span className=\"label\">Add a description...</span>\n              </button>\n            }\n          </Breadcrumbs>\n\n          <div className=\"main-header-icons\">\n           <CSSTransition\n              in={hasSelection} \n              timeout={200} \n              classNames=\"selection-options\">\n\n              <div \n                className=\"selection-options\"\n                onClick={this.showOptionsMenu}>              \n                <span className=\"label\">Options</span>\n                <span className=\"more icon\">&#xf078;</span>\n              </div>\n            </CSSTransition>\n\n            { this.state.optionsMenuVisible &&\n              <OptionsMenu \n                view={this.props.view} \n                selection={this.props.selection} \n                onDuplicateSelection={this.closeAndThen(this.props.onDuplicateSelection)}\n                onDeleteSelection={this.closeAndThen(this.props.onDeleteSelection)} \n                onShareSelection={this.closeAndThen(this.props.onShareSelection)}\n                onNER={this.closeAndThen(this.props.onNER)}\n                onCancel={this.closeOptionsMenu} /> }\n\n            <HeaderIcon\n              className=\"presentation-toggle stroke7\"\n              icon={this.props.presentation === 'TABLE' ? '\\ue645' : '\\ue636'} \n              onClick={this.props.onTogglePresentation} />\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport Menu from '../../../common/Menu';\nimport IdentityInfo from '../../../common/account/IdentityInfo';\n\nexport default class Account extends Component {\n\n  state = {\n    menuVisible: false \n  };\n\n  openMenu = () => {\n    this.setState({ menuVisible: true });\n  }\n\n  closeMenu = () => {\n    this.setState({ menuVisible: false });\n  }\n\n  render() {\n    return (\n      <div\n        className=\"section account\"\n        onClick={this.openMenu} >\n\n        <IdentityInfo \n          account={this.props.account} />\n\n        { this.state.menuVisible &&\n          <Menu \n            className=\"account-menu\"\n            onCancel={this.closeMenu}>\n\n            <Menu.Group >\n              <Menu.Item icon={'\\uf0ad'} label=\"Account settings\" link=\"/settings/account\" />\n            </Menu.Group>\n            \n            <Menu.Group>\n              <Menu.Item icon={'\\uf128'} label=\"Help\" link=\"/help\" />\n              <Menu.Item icon={'\\uf011'} label=\"Sign out\" link=\"/logout\" />\n            </Menu.Group>\n          </Menu>\n        }\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport Menu from '../../../common/Menu';\n\nexport default class NewContent extends Component {\n\n  state = { \n    menuVisible: false\n  };\n\n  onOpenMenu = () => {\n    this.setState({ menuVisible: true });\n  }\n\n  onCloseMenu = () => {\n    this.setState({ menuVisible: false });\n  }\n\n  onOpenFileExplorer = () => {\n    this._input.click(); // Trigger the hidden file input field\n  }\n\n  onUploadFiles = (evt) => {\n    const files = Array.from(evt.target.files);\n    this.props.onUploadFiles(files);\n  }\n\n  /** Helper to execute a function after closing the menu **/\n  select = (fn) => {\n    return () => {\n      this.setState({ menuVisible: false });\n      fn();\n    }\n  } \n\n  render() {\n    return (\n      <div className=\"section create-new\">\n        <button\n          className=\"btn create-new\"\n          onClick={this.onOpenMenu}>\n          <span className=\"icon\">&#xf067;</span>\n          <span className=\"label\">New</span>\n        </button>\n\n        <input\n          ref={c => this._input = c}\n          type=\"file\"\n          name=\"file\"\n          multiple\n          onChange={this.onUploadFiles}\n          style={{ display: 'none' }} />\n\n        {this.state.menuVisible &&\n          <Menu \n            className=\"create-new\"\n            onCancel={this.onCloseMenu}>\n            \n            <Menu.Group>\n              <Menu.Item \n                icon={'\\uf07b'} \n                label=\"Folder\" \n                onSelect={this.select(this.props.onCreateFolder)} />\n\n              <Menu.Item \n                icon={'\\uf15b'} \n                label=\"File upload\" \n                onSelect={this.select(this.onOpenFileExplorer)} />\n            </Menu.Group>\n\n            <Menu.Group>\n              <Menu.Item \n                icon={'\\uf0c1'} \n                label=\"From IIIF manifest\" \n                onSelect={this.select(() => this.props.onImportSource('IIIF'))} />\n\n              <Menu.Item \n                icon={'\\uf121'} \n                label=\"From CTS service\" \n                onSelect={this.select(() => this.props.onImportSource('CTS'))} />\n            </Menu.Group>\n          </Menu>\n        }\n      </div>\n    )\n  }\n\n}\n","import React from 'react';\n\nconst ViewListItem = props => {\n\n  return (\n    <li\n      className={props.current ? 'current' : null}\n      onClick={props.onClick}>\n      <span className=\"icon\">{props.icon}</span> {\n        props.children\n      }\n    </li>\n  );\n\n}\n\nconst Views = props => {\n  \n  return (\n    <div className=\"section views\">\n      <ul>\n        <ViewListItem\n          icon=\"&#xf2be;\"\n          current={props.view === 'MY_DOCUMENTS'}\n          onClick={() => props.onChangeView('MY_DOCUMENTS')}>\n          My Documents\n        </ViewListItem>\n\n        <ViewListItem\n          icon=\"&#xf064;\"\n          current={props.view === 'SHARED_WITH_ME'}\n          onClick={() => props.onChangeView('SHARED_WITH_ME')}>\n          Shared with me\n        </ViewListItem>\n      </ul>\n    </div>\n  );\n\n}\n\nexport default Views;","import React from 'react';\nimport NumberFormat from 'react-number-format';\nimport Meter from '../../../common/Meter.jsx';\n\nconst Storage = props => {\n\n  const dataAvailable = props.account && props.account.storage;\n  const quota = dataAvailable ? props.account.storage.quota_mb : 0;\n  const used = dataAvailable ? props.account.storage.used_mb : 0;\n\n  return (\n    <div className=\"section storage\">\n      <span className=\"icon\">&#xf1c0;</span> Storage\n      <div className=\"used-diskspace\">\n        <Meter\n          value={(quota > 0) ? Math.min(1, used / quota) : 0} />\n\n        <div className=\"label\">\n          <NumberFormat \n            displayType=\"text\"\n            value={used}\n            thousandSeparator={true} /> \n          {' of  '}\n          <NumberFormat \n            displayType=\"text\"\n            value={quota}\n            thousandSeparator={true} /> MB used\n        </div>\n      </div>\n    </div>\n  );\n\n}\n\nexport default Storage;\n","import React from 'react';\nimport ActivityHistory from '../../../common/account/ActivityHistory';\nimport TopCollaborators from '../../../common/account/TopCollaborators';\n\nconst MyActivity = props => {\n  \n  return (\n    <React.Fragment>\n      <ActivityHistory \n        className=\"section\" \n        width={237}\n        height={55}\n        fill=\"#4483c4\"\n        stats={props.account && props.account.stats} />\n\n      <TopCollaborators \n        className=\"section collaborators\"\n        title=\"My top collaborators\"\n        username={props.account && props.account.username} />\n    </React.Fragment>\n  );\n\n}\n\nexport default MyActivity;","import React from 'react';\nimport Account from './sections/Account';\nimport NewContent from './sections/NewContent';\nimport Views from './sections/Views';\nimport Storage from './sections/Storage';\nimport MyActivity from './sections/MyActivity';\n\nconst Sidebar = props => {\n\n  return (\n    <div className=\"sidebar\">\n      <Account \n        account={props.account} />\n\n      <NewContent \n        onCreateFolder={props.onCreateFolder} \n        onUploadFiles={props.onUploadFiles} \n        onImportSource={props.onImportSource} /> \n\n      <Views\n        view={props.view} \n        onChangeView={props.onChangeView} />\n      \n      <Storage\n        account={props.account} />\n\n      <MyActivity \n        account={props.account} />\n    </div>\n  );\n\n}\n\nexport default Sidebar;\n","import React from 'react';\n\nimport Header from './header/Header';\nimport Readme from '../common/documents/Readme';\nimport Sidebar from './sidebar/Sidebar';\nimport GridPane from '../common/documents/grid/GridPane';\nimport TablePane from '../common/documents/table/TablePane';\n\nconst Workspace = props => {\n\n  return (\n    <React.Fragment>\n      <Sidebar\n        account={props.account}\n        view={props.view}\n        onChangeView={props.onChangeView}\n        onCreateFolder={props.onCreateFolder}\n        onUploadFiles={props.onUploadFiles}\n        onImportSource={props.onImportSource} />\n\n      <div className=\"main-content\">\n        <Header\n          account={props.account}\n          view={props.view}\n          presentation={props.presentation}\n          readme={props.page.readme}\n          breadcrumbs={props.page.breadcrumbs}\n          docCount={props.page.total_count}\n          selection={props.selection}\n          onTogglePresentation={props.onTogglePresentation} \n          onCreateReadme={props.onCreateReadme} \n          onDuplicateSelection={props.onDuplicateSelection}\n          onDeleteSelection={props.onDeleteSelection} \n          onShareSelection={props.onShareSelection} \n          onNER={props.onNER} \n          onSearchResponse={props.onSearchResponse} />\n\n        { props.page.readme && \n          <Readme\n            content={props.page.readme} \n            onUpdate={props.onUpdateReadme} \n            onDelete={props.onDeleteReadme} />\n        }\n\n        { props.presentation === 'TABLE' &&\n          <TablePane\n            items={props.page.items}\n            config={props.tableConfig}\n            selection={props.selection}\n            busy={props.busy}\n            enableFiledrop={props.view === 'MY_DOCUMENTS'} \n            onSelect={props.onSelect} \n            onSort={props.onSortTable}\n            onChangeColumnConfig={props.onChangeColumnConfig} \n            onRenameFolder={props.onRenameFolder}\n            onDropFiles={props.onUploadFiles} \n            onDropSourceURL={url => props.onImportSource(null, url)} />\n        }\n\n        { props.presentation === 'GRID' &&\n          <GridPane\n            items={props.page.items}\n            selection={props.selection}\n            busy={props.busy}\n            enableFiledrop={props.view !== 'MY_DOCUMENTS'} \n            onSelect={props.onSelect} \n            onDropFiles={props.onUploadFiles} \n            onDropSourceURL={url => props.onImportSource(null, url)} />            \n        }\n      </div>\n    </React.Fragment>\n  );\n\n}\n\nexport default Workspace;","import React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport axios from 'axios';\nimport { Columns } from '../common/documents/table/Columns';\nimport { initialState, persistState } from './initialState';\nimport operations from './operations';\nimport Selection from '../common/documents/Selection';\nimport Workspace from './Workspace';\n\nimport '../../assets/style/workspace/index.scss';\n\nexport default class App extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = initialState();\n\n    this._rootEl = document.getElementById('app');\n    window.onhashchange = this.changeFolder;\n  }\n\n  /** Init: add deselect listeners and load contents */\n  componentDidMount() {\n    this._rootEl.addEventListener('keydown', this.onKeydown, false);\n    this._rootEl.addEventListener('mousedown', this.onMousedown, false);\n\n    // Init account data\n    axios.get('/api/account/my').then(result => { \n      this.setState({ account: result.data }) \n    }).then(() => {\n      this.refreshPage();\n    });\n  }\n\n  /** Remveo deselect listeners **/\n  componentWillUnmount() {\n    this._rootEl.removeEventListener('keydown', this.onKeydown, false);\n    this._rootEl.removeEventListener('mousedown', this.onMousedown, false);\n  }\n\n  /** Clear selection on ESC key **/\n  onKeydown = (evt) => {\n    if (evt.which === 27) \n      this.setState({ selection: new Selection() });\n    else if (evt.which === 46 && !this.state.selection.isEmpty())\n      this.deleteSelection();\n  }\n\n  /** Clear selection on click ouside the document pane **/\n  onMousedown = (evt) => {\n    const isClickOutside = !(\n      document.querySelector('.documents-pane').contains(evt.target) ||\n      document.querySelector('.main-header-icons').contains(evt.target)\n    );\n\n    if (isClickOutside) this.setState({ selection: new Selection() });\n  }\n\n  /** \n   * Refreshes the current page.\n   * \n   * Note that this doesn't work if the view is currently SEARCH.\n   */\n  refreshPage = () => {\n    this.setState({ busy: true });\n\n    const folderId = document.location.hash.substring(1);\n\n    const path = (this.state.view === 'MY_DOCUMENTS') ?\n       (folderId) ? `my/${folderId}` : 'my' :\n       (folderId) ? `my/shared/${folderId}` : 'my/shared';\n\n    const config = this.state.presentation === 'GRID' ? null :\n      {\n        columns: Columns.expandAggregatedColumns(this.state.table_config.columns),\n        sort: this.state.table_config.sorting\n      };\n\n    return axios.post(`/api/directory/${path}`, config).then(result => {\n      this.setState(prev => {\n        const { breadcrumbs, readme, total_count, items } = result.data;\n        return {\n          page : {\n            ...prev.page,\n            ...{\n              breadcrumbs,\n              readme,\n              total_count,\n              items\n            }\n          },\n          busy: false\n        } \n      });\n    });\n  }\n\n  changeFolder = () => {\n    this.setState({ selection: new Selection() }, () => {\n      this.refreshPage();\n    });\n  }\n  \n  changeView = (view) => {\n    persistState('view', view);\n    this.setState({ view: view }, this.refreshPage);\n  }\n\n  togglePresentation = () => {\n    this.setState(prev => { \n      const presentation = (prev.presentation === 'TABLE') ? 'GRID' : 'TABLE';\n      persistState('presentation', presentation);\n      return { presentation: presentation };\n    });\n  }\n\n  select = selection => {\n    this.setState({ selection: selection });\n  }\n\n  sortTable = (sorting) => {\n    this.setState(prev => {\n      const config = { ...prev.table_config, ...{ sorting: sorting } };\n      persistState('table_config', config);\n      return { table_config: config };\n    }, () => {\n      this.refreshPage();\n    });      \n  }\n\n  changeColumConfig = columns => {\n    this.setState(prev => { \n      const config = {...prev.table_config, ...{ columns: columns } };\n      persistState('table_config', config);\n      return { table_config: config };\n    });\n  }\n\n  createReadme = () => {\n    this.setState(prev => {\n      return { page: {...prev.page, ...{ readme: true }} }\n    });\n  }\n\n  updateReadme = (readme) => {\n    operations.updateReadme(readme, this.state.page).then(page => {\n      this.setState({ page: page });\n    });\n  }\n\n  deleteReadme = () => {\n    operations.deleteReadme(this.state.page).then(page => {\n      this.setState({ page: page });\n    });\n  }\n\n  duplicateSelection = () => {\n    this.setState({ busy: true });\n    operations.duplicateSelection(this.state.selection)\n      .then(this.refreshPage)\n  }\n\n  deleteSelection = () => {\n    operations.deleteSelection({\n      selection: this.state.selection,\n      view: this.state.view,\n      onStart: () => this.setState({ busy: true }),\n      onSuccess: this.refreshPage,\n      onError:   this.refreshPage\n    });\n  }\n\n  onSearchResponse = response => {\n    this.setState(prev => {\n      return { \n        view: 'SEARCH',\n        page: {\n          breadcrumbs: null,\n          readme: null,\n          total_count: response.total,\n          items: response.items\n        }\n      }\n    });\n  }\n\n  render() {\n    return(\n      <Workspace \n        account={this.state.account}\n        view={this.state.view}\n        presentation={this.state.presentation}\n        page={this.state.page}\n        tableConfig={this.state.table_config}\n        selection={this.state.selection}\n        busy={this.state.busy}\n        onChangeView={this.changeView}\n        onTogglePresentation={this.togglePresentation}\n        onSelect={this.select}\n        onSortTable={this.sortTable}\n        onChangeColumnConfig={this.changeColumConfig}\n        onCreateReadme={this.createReadme}\n        onUpdateReadme={this.updateReadme}\n        onDeleteReadme={this.deleteReadme}\n        onCreateFolder={() => operations.createFolder().then(this.refreshPage)}\n        onRenameFolder={(folder, title) => operations.renameFolder(folder, title).then(this.refreshPage)}\n        onDuplicateSelection={this.duplicateSelection}\n        onDeleteSelection={this.deleteSelection}\n        onShareSelection={() => operations.shareSelection(this.state.selection)}\n        onNER={() => operations.entityRecognition(this.state.selection).then(this.refreshPage)}\n        onSearchResponse={this.onSearchResponse}\n        onUploadFiles={files => operations.uploadFiles(files).then(this.refreshPage)}\n        onImportSource={(sourceType, url) => operations.importSource(sourceType, url).then(this.refreshPage)} />\n    )\n  }\n\n}\n\nrender(<App />, document.getElementById('app'));\n","import React from 'react';\n\nconst HeaderIcon = props => {\n\n  return (\n    <div\n      className={`header-icon ${props.className}`}\n      onClick={props.onClick}>\n      {(props.link) ? \n        <a href={props.link} className=\"icon inner\">\n          {props.icon}\n        </a> :\n\n        <span className=\"icon inner\">\n          {props.icon}\n        </span>\n      }\n    </div>\n  );\n\n}\n\nexport default HeaderIcon;","import React from 'react';\n\nconst VIEW_LABELS = {\n  MY_DOCUMENTS: 'My Documents',\n  SHARED_WITH_ME: 'Shared with me',\n  SEARCH: 'Search results'\n}\n\nconst Breadcrumbs = props => {\n  const title = props.view ? VIEW_LABELS[props.view] : props.label;\n\n  return (\n    <div className=\"breadcrumbs\">\n      <h2>\n        <a className=\"root\" href=\"#\">{title}</a>\n        {props.path && props.path.map(b => \n          <a className=\"folder\" href={`#${b.id}`} key={b.id}>{b.title}</a>\n        )}\n      </h2>\n      \n      { props.docCount !== null && props.docCount !== undefined &&\n        <span className=\"count\">{`(${props.docCount})`}</span> }\n\n      { props.children }\n    </div>\n  );\n\n}\n\nexport default Breadcrumbs;","import React, { Component } from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport ContentEditable from 'react-sane-contenteditable';\n\nconst INITIAL_STATE = {\n  editing: false,\n  modifiedContent: null\n}\n\nexport default class Readme extends Component {\n\n  state = {};\n\n  onKeydown = (evt) => {\n    if (evt.which === 27) // Esc\n      this.onCancel(); \n    else if (evt.ctrlKey && evt.which === 13) // Ctrl+Enter \n      this.onSave();\n  }\n\n  onEdit() {\n    document.addEventListener('keydown', this.onKeydown, false);\n    this.setState({ editing: true });\n  }\n\n  onChange(_, value) {\n    this.setState({ modifiedContent: value });\n  }\n\n  onDelete() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n    this.props.onDelete && this.props.onDelete();\n  }\n\n  onSave() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n    this.props.onUpdate && this.props.onUpdate(this.state.modifiedContent);\n    this.setState(INITIAL_STATE);\n  }\n\n  onCancel() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n    if (typeof this.props.content === 'boolean')\n      this.onDelete();\n    else\n      this.setState(INITIAL_STATE);\n  }\n\n  renderView(content) {\n    return (\n      <div className=\"readme\">\n        <div className=\"wrapper\">\n          <div className=\"textbox\">\n            <ReactMarkdown source={content} />       \n          </div>\n\n          {this.props.onUpdate && this.props.onDelete &&\n            <span className=\"buttons modify\">\n              <button\n                className=\"icon nostyle\"\n                title=\"Edit\"\n                onClick={this.onEdit.bind(this)}>&#xf040;</button>\n            </span>\n          }\n        </div>\n      </div>\n    )\n  }\n\n  renderEdit(content) {\n    return (\n      <div className=\"readme editing\">\n        <div className=\"wrapper\">\n          <ContentEditable \n            tagName=\"div\"\n            className=\"textbox\"\n            content={content} \n            editable={true} \n            multiLine={true}\n            onChange={this.onChange.bind(this)}/>            \n\n          <div className=\"editbar\">\n            <span className=\"hint\">Supports styling with <a href=\"# \">Markdown</a></span>\n            <span className=\"buttons\">\n              <button\n                className=\"label nostyle\"\n                onClick={this.onDelete.bind(this)}>Delete description</button>\n\n              <button \n                className=\"icon nostyle\"\n                onClick={this.onSave.bind(this)}>&#xf00c;</button>\n\n              <button \n                className=\"icon nostyle\"\n                onClick={this.onCancel.bind(this)}>&#xf00d;</button>\n            </span>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  render() {\n    const editOnOpen = typeof this.props.content === 'boolean';\n\n    if (editOnOpen)\n      document.addEventListener('keydown', this.onKeydown, false);\n\n    const content = editOnOpen ? '' : \n      (this.state.modifiedContent ? this.state.modifiedContent : this.props.content);\n\n    return (this.state.editing || editOnOpen) ? this.renderEdit(content) : this.renderView(content);\n  }\n\n}\n","import React, { Component } from 'react';\n\nimport Avatar from './Avatar.jsx';\n\nexport default class IdentityInfo extends Component {\n\n  formatURL(url) {\n    return url.replace(/^https?:\\/\\//i, '');\n  }\n\n  render() {\n    const dataAvailable = \n      this.props.account && \n      this.props.account.username &&\n      this.props.account.member_since;\n      \n    return (\n      <div className=\"identity\">\n        <div className=\"user\">\n          <Avatar username={dataAvailable && this.props.account.username} />\n\n          <h1>\n            { dataAvailable ?\n                ((this.props.account.real_name) ? \n                  this.props.account.real_name : this.props.account.username) :\n\n                (<span className=\"placeholder\" />) }\n          </h1>\n\n          <p className=\"member-since\">\n            { dataAvailable ?\n              <React.Fragment>\n                Joined on { new Intl.DateTimeFormat('en-GB', {\n                  year : 'numeric',\n                  month: 'short',\n                  day  : '2-digit'\n                }).format(new Date(this.props.account.member_since)) }\n              </React.Fragment> : <span className=\"placeholder\" />\n            }\n          </p>\n        </div>\n\n        <div className=\"user-extended\">\n          { dataAvailable && this.props.account.bio &&\n            <p className=\"bio\">{this.props.account.bio}</p> }\n\n          { dataAvailable && this.props.account.website && \n            <p className=\"homepage\">\n              <a href={this.props.account.website}>{this.formatURL(this.props.account.website)}</a>\n            </p>\n          }\n        </div>\n      </div>\n    )\n  }\n\n}\n"],"sourceRoot":""}