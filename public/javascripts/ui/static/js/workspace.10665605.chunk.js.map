{"version":3,"sources":["common/content/activity/ActivityWidget.jsx","common/content/profile/CollaboratorList.jsx","common/content/profile/ProfileInfo.jsx","common/content/table/rows/BaseRowComponent.jsx","common/content/table/rows/HeaderRow.jsx","common/content/table/rows/DocumentRow.jsx","common/content/table/rows/FolderRow.jsx","common/content/table/preferences/ColumnOrder.jsx","common/content/table/preferences/PreferencesModal.jsx","common/content/table/TablePane.jsx","common/content/grid/Folder.jsx","common/content/grid/Document.jsx","common/content/grid/GridPane.jsx","common/content/table/Columns.js","common/content/Selection.js","common/content/Readme.jsx","common/StoredUIState.js","common/components/Modal.jsx","common/content/upload/DropzoneDecoration.jsx","common/content/profile/Avatar.jsx","workspace/API.js","workspace/Announcement.jsx","common/components/Meter.jsx","common/content/upload/Uploader.jsx","workspace/header/search/AdvancedSearch.jsx","workspace/header/search/Search.jsx","common/components/MenuPopup.jsx","common/components/Prompt.jsx","workspace/actions/DeleteAction.jsx","common/content/job/JobProgress.jsx","common/content/ner/authorities/AuthoritySelection.jsx","common/content/ner/engines/EngineSelection.jsx","common/content/ner/NERModal.jsx","workspace/actions/NERAction.jsx","common/content/share/public/PublicAccess.jsx","common/content/share/collaborators/PermissionSelector.js","common/content/share/collaborators/Autocomplete.jsx","common/content/share/collaborators/Collaborators.jsx","common/content/share/ShareModal.jsx","workspace/header/Header.jsx","workspace/sidebar/sections/Account.jsx","workspace/sidebar/sections/forms/BasePopupForm.jsx","workspace/sidebar/sections/forms/CreateFolderForm.jsx","common/components/URLInput.jsx","workspace/sidebar/sections/forms/IIIFSourceForm.jsx","workspace/sidebar/sections/CreateNew.jsx","workspace/sidebar/sections/Views.jsx","workspace/sidebar/sections/Storage.jsx","workspace/sidebar/Sidebar.jsx","workspace/App.jsx","common/content/HeaderIcon.jsx","common/content/Breadcrumbs.jsx"],"names":["LINE_STYLE","stroke","strokeWidth","AXIS_STYLE","fontSize","color","tickFormatter","tick","Intl","DateTimeFormat","month","format","Date","ActivityWidget","n","toTimestamp","empty","Array","fill","reduce","arr","_","last","length","push","reverse","map","timestamp","value","t","toTime","getTime","this","createEmptySeries","concat","timeseries","props","stats","over_time","parse","date","padTimeseries","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","className","react_number_format__WEBPACK_IMPORTED_MODULE_10___default","displayType","total_contributions","thousandSeparator","recharts__WEBPACK_IMPORTED_MODULE_6__","width","height","barCategoryGap","data","computeChart","recharts__WEBPACK_IMPORTED_MODULE_7__","strokeDasharray","horizontal","recharts__WEBPACK_IMPORTED_MODULE_8__","type","dataKey","axisLine","tickSize","tickCount","tickLine","domain","padding","left","right","recharts__WEBPACK_IMPORTED_MODULE_9__","Component","CollaboratorList","_this","Object","_home_simonr_Workspaces_pelagios_recogito2_workspace_frontend_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","_home_simonr_Workspaces_pelagios_recogito2_workspace_frontend_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","_home_simonr_Workspaces_pelagios_recogito2_workspace_frontend_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","state","collaborators","fetchCollaborators","_this2","username","axios","get","then","result","setState","Fragment","title","user","key","href","_Avatar_jsx__WEBPACK_IMPORTED_MODULE_7__","Identity","url","replace","dataAvailable","account","member_since","_Avatar_jsx__WEBPACK_IMPORTED_MODULE_6__","real_name","year","day","bio","website","formatURL","BaseRowComponent","classCallCheck","possibleConstructorReturn","getPrototypeOf","updateTotalRowSpan","next","_totalSpan","columns","total","field","Columns","getSpan","HeaderRow","react_default","style","prototype","onClick","onSort","bind","HEADER_NAMES","sortColumn","sortAsc","ICONS","TEXT_PLAIN","TEXT_TEIXML","IMAGE_UPLOAD","IMAGE_IIIF","DATA_CSV","FORMATTERS","language","toUpperCase","uploaded_at","datetime","last_edit_at","lib_default","public_visibility","visibility","access_level","level","annotations","number_format_default","status_ratio","ratio","verified","unverified","not_identifiable","pctGreen","pctYellow","labels","tooltip","count","slice","AGGREGATE_FIELDS","agg_document","item","author","DocumentRow","substring","formatter","undefined","filetypes","id","selected","startsWith","createAggregateField","createField","src","alt","FolderRow","editable","evt","_input","select","preventDefault","stopPropagation","target","_this3","which","onRename","_this4","ref","i","makeEditable","onChange","onKeyDown","onKeyPress","SortableItem","SortableElement","_ref","label","SortableList","SortableContainer","_ref2","items","idx","index","ColumnOrder","onSortEnd","e","oldIndex","newIndex","PreferencesModal","states","COLUMNS","forEach","isChecked","includes","checked","toAppend","filter","checkAll","setAllRows","name","prev","indexOf","splice","arrayMove","Modal","onClose","onCancel","onClickAll","toggleOne","htmlFor","ColumnOrder_ColumnOrder","onSave","TablePane","prefsOpen","filterByView","view","selection","Selection","folders","documents","isShift","getModifierState","isCtrl","selectRange","selectItem","onSelect","getSelectedItems","allItems","args","FolderRow_FolderRow","onRenameFolder","DocumentRow_DocumentRow","visible","onChangeColumnPrefs","asc","sorting","by","active","drag","files","dataTransfer","getData","hostname","document","onDropFiles","window","location","onDropURL","readme","React","Children","toArray","children","c","Readme","shift","tablePane","es","rowCount","rowHeight","rowRenderer","DropzoneDecoration","busy","HeaderRow_HeaderRow","sortBy","showPreferences","disableFiledrop","dist_es","disableClick","onDragEnter","onDrag","onDragLeave","onDrop","PreferencesModal_PreferencesModal","onSavePreferences","Folder","Document","isStacked","fileCount","GridPane","itemsPerRow","fromIndex","itemsInRow","Math","min","renderedItems","rowIdx","Folder_Folder","Document_Document","file_count","gridPane","itemCount","floor","ceil","COLUMNS_SHARED_WITH_ME","date_freeform","last_edit_by","activity","owner","shared_by","COLUMN_WIDTH","AGGREGATE_COLUMNS","_home_simonr_Workspaces_pelagios_recogito2_workspace_frontend_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","w","_allItems","_selection","isCtrlPressed","thisIdx","toIdx","selectedIndices","minIdx","apply","maxIdx","max","isOutside","from","to","find","ft","INITIAL_STATE","editing","modifiedContent","onKeydown","_home_simonr_Workspaces_pelagios_recogito2_workspace_frontend_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__","ctrlKey","addEventListener","removeEventListener","onDelete","onUpdate","content","react__WEBPACK_IMPORTED_MODULE_6___default","react_markdown__WEBPACK_IMPORTED_MODULE_7___default","source","onEdit","react_sane_contenteditable__WEBPACK_IMPORTED_MODULE_8__","tagName","multiLine","editOnOpen","renderEdit","renderView","StoredUIState","localStorage","getItem","JSON","prefixed","setItem","stringify","react_draggable__WEBPACK_IMPORTED_MODULE_6___default","handle","AnimatedDiv","posed","div","open","bottom","transition","ease","duration","closed","pose","Avatar","str","hash","charCodeAt","stringToHslColor","backgroundColor","charAt","fetchDocuments","path","config","post","API","opt_folder","uuid","put","parentId","parent","delete","ids","opt_folder_id","BasePopupForm","confirm","confirmAnnouncement","react_markdown_default","message","Meter","position","Uploader","_emptyState","start","remoteSource","phase","totalSize","f","size","filepartIds","uploadId","uploadStatus","progress","errors","initNewDocument","uploadFiles","registerURL","catch","error","response","finalizeDocument","formdata","FormData","append","headers","X-Requested-With","requests","file","onUploadProgress","loaded","uploadOne","Promise","all","_this5","currentFolder","tasks","running_tasks","pollTaskProgress","document_id","onUploadComplete","filepartId","pollResult","_this6","subtasks","filepart_id","setUploadStatus","status","documentId","taskTypes","_this7","updateStatusForFile","setTimeout","complete","isUploadComplete","_this8","totalLoaded","Meter_Meter","AdvancedSearch","onMousedown","assertThisInitialized","isClickOutside","_node","contains","isClickOnToggle","classList","Search","advancedSearchOpen","placeholder","AdvancedSearch_AdvancedSearch","toggleAdvancedSearch","MenuPopup","menu","group","options","option","link","disabled","icon","Prompt","onNo","toLowerCase","react_draggable_default","onYes","DeleteAction","deleteFolder","bulkDeleteFolders","resolve","d","deleteDocument","unshareDocument","bulkDeleteDocuments","bulkUnshareDocuments","onStart","deleteDocuments","deleteFolders","onSuccess","onError","ReactDOM","createPortal","Prompt_Prompt","executeDelete","body","JobProgress","handleClose","tasksCompleted","pollProgress","jobId","tasksFailed","onComplete","isDone","labelCompleted","labelTasks","AuthoritySelection","identifier","currentIdx","useAll","onToggleAll","authorities","authority","homepage","rel","shortname","fullname","EngineSelection","cellSpacing","engines","engine","languages","lang","description","NERModal","available_engines","available_authorities","selected_engine","selected_all_authorities","selected_authorities","initAvailableAuthorities","initAvailableEngines","diff","all_authorities","EngineSelection_EngineSelection","changeEngine","AuthoritySelection_AuthoritySelection","toggleAllAuthorities","changeAuthorities","NERAction","startNER","isDocument","hasTextParts","taskDefinition","assign","task_type","running","job_id","handleCompleted","JobProgress_JobProgress","NERModal_NERModal","PublicAccess","updateSetting","update","objectSpread","onChangeVisibility","onChangeAccessLevel","_result$data","PermissionSelector","handleCancel","onChangeLevel","changeLevel","accessLevel","AutoComplete","isLoading","inputValue","fetchSuggestions","query","exclude","onInputChange","clear","getInstance","_this$state","lib","r","onSearch","Collaborators","storeCollaborator","setting","openPermissionsSelector","collaborator","root","render","PermissionSelector_PermissionSelector","remove","openSelector","nodeName","parentNode","removeCollaborator","addCollaborator","toConsumableArray","Autocomplete_AutoComplete","ShareModal","setView","renderPublicAccess","PublicAccess_PublicAccess","renderCollaborators","Collaborators_Collaborators","getView","Header","action","menuVisible","startDeleteAction","deleteAction","DeleteAction_DeleteAction","onDeleteSuccess","onDeleteError","cancelAction","afterAction","firstSelected","isSingleDocument","isSingleFolder","ShareModal_ShareModal","NERAction_NERAction","onStarted","actionStarted","handleNERComplete","isOpen","Search_Search","HeaderIcon","Breadcrumbs","breadcrumbs","docCount","onCreateReadme","react_transition_group","in","timeout","classNames","showActionsMenu","MenuPopup_MenuPopup","isSingleSelection","folderSharing","includesText","onSelectMenuOption","onCancelMenu","presentation","onTogglePresentation","Account","showMenu","ProfileInfo","closeMenu","handleKeydown","handleOk","onOk","CreateFolderForm","folderName","handleChange","onSubmit","handleKeyPress","popup","BasePopupForm_BasePopupForm","autoFocus","URLInput","val","handleDrop","autofocus","IIIFSourceForm","sourceURL","URLInput_URLInput","CreateNew","handleFormSubmit","onCreateFromSource","currentFolderId","createFolder","onFolderCreated","createNewForm","handleFormCancel","CreateFolderForm_CreateFolderForm","click","IIIFSourceForm_IIIFSourceForm","onUploadFiles","onShowOptions","multiple","display","onSelectOption","ViewListItem","current","ViewList","Views_ViewListItem","currentView","onChangeView","Storage","storage","quota","quota_mb","used","used_mb","Sidebar","handleCreateFromSource","Account_Account","CreateNew_CreateNew","Views_ViewList","Storage_Storage","App","table_columns","table_sorting","total_docs","fileUploads","urlUpload","announcement","load","_root","getElementById","onhashchange","changeFolder","querySelector","fetchAccountData","refreshCurrentView","latestAnnouncement","expandAggregatedColumns","sort","accountData","myDocuments","getDisplayConfig","sharedWithMe","save","fetchMyDocuments","fetchSharedWithMe","before","p","folder","_this9","renameFolder","updateReadme","deleteReadme","_this10","_this11","_this12","isUploading","Sidebar_Sidebar","startUpload","changeView","startRegisterRemoteSource","Header_Header","setBusy","feature_toggles","togglePresentation","createReadme","onSortTable","onUpdateReadme","onDeleteReadme","Uploader_Uploader","Announcement_BasePopupForm","App_App","VIEW_LABELS","MY_DOCUMENTS","SHARED_WITH_ME","b"],"mappings":"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","file":"static/js/workspace.10665605.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport { Bar, BarChart, CartesianGrid, XAxis } from 'recharts';\nimport NumberFormat from 'react-number-format';\n\nconst LINE_STYLE = {\n  stroke: '#c2c2c2', \n  strokeWidth:1\n}\n\nconst AXIS_STYLE = {\n  fontSize:\"12px\",\n  color:\"#3f3f3f\"\n}\n\nconst WEEK = 3600000 * 24 * 7; // A week in milliseconds\n\nconst tickFormatter = (tick) => new Intl.DateTimeFormat('en-GB', {\n  month: 'short'\n}).format(new Date(tick));\n\nexport default class ActivityWidget extends Component {\n\n  /** Helper that generates an empty time series of N buckets with value 0 */\n  createEmptySeries(n, toTimestamp) {\n    const empty = new Array(n);\n    empty.fill(0); // Needs to contain *something* for .reduce to work\n\n    const timestamps = empty.reduce((arr, _) => {\n      const last = arr[arr.length - 1];\n      arr.push(last - WEEK);\n      return arr;\n    }, [ toTimestamp - WEEK ]).reverse();\n\n    return timestamps.map(timestamp => {\n      return { timestamp: timestamp, value: 0 };\n    });\n  }\n\n  padTimeseries(t) {\n    const toTime = t.length > 0 ? t[0].timestamp : new Date().getTime();\n    const padding = this.createEmptySeries(19 - t.length, toTime);\n    return padding.concat(t);\n  }\n\n  computeChart() {\n    // Data comes as ISO strings - convert\n    const timeseries = this.props.stats.over_time.map(t => {\n      return { timestamp: Date.parse(t.date), value: t.value };\n    });\n\n    if (timeseries.length < 20) {\n      return this.padTimeseries(timeseries);\n    } else {\n      return timeseries;\n    }\n  }\n\n  render() {\n    return (\n      <div className={this.props.className ? \n        `activity-widget ${this.props.className}` : \"activity-widget\"}>\n\n        <h2>Activity \n          {this.props.stats && \n            <span className=\"count\">\n              <NumberFormat \n                displayType=\"text\"\n                value={this.props.stats.total_contributions}\n                thousandSeparator={true} /> edits\n            </span>\n          }\n        </h2>\n\n        {this.props.stats &&\n          <BarChart \n            width={this.props.width} \n            height={this.props.height} \n            barCategoryGap={1.5}\n            data={this.computeChart()} >\n\n            <CartesianGrid \n              strokeDasharray=\"3\" \n              horizontal={false}/>\n\n            <XAxis \n              type=\"number\"\n              dataKey=\"timestamp\"\n\n              axisLine={LINE_STYLE} \n\n              tick={AXIS_STYLE}\n              tickSize={4}\n              tickCount={6}\n              tickLine={LINE_STYLE}\n              tickFormatter={tickFormatter}\n\n              height={20}\n              domain={['dataMin', 'dataMax']}\n              padding={{ left: 5, right: 5 }} />\n\n            <Bar \n              dataKey=\"value\" \n              fill={this.props.fill} />\n\n          </BarChart>\n        }\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport axios from 'axios';\n\nimport Avatar from './Avatar.jsx';\n\nexport default class CollaboratorList extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { collaborators: [] };\n    this.fetchCollaborators(props);\n  }\n\n  componentWillReceiveProps(props) {\n    this.fetchCollaborators(props);\n  }\n\n  fetchCollaborators(props) {\n    if (props.username)\n      axios\n        .get(`/api/account/${props.username}/collaborators`)\n        .then(result => this.setState({ collaborators: result.data }));\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        {this.state.collaborators.length > 0 &&\n          <div className={this.props.className ? `collaborator-list ${this.props.className}` : 'collaborator-list'}>\n            <h2>{this.props.title}</h2>\n            <ul>\n              {this.state.collaborators.map(user => \n                <li key={user.username}>\n                  <a href={`/${user.username}`} title={user.username}>\n                    <Avatar username={user.username} />\n                  </a>\n                </li>\n              )}\n            </ul>\n          </div>\n        }\n      </React.Fragment>\n    )\n  }\n\n}","import React, { Component } from 'react';\n\nimport Avatar from './Avatar.jsx';\n\nexport default class Identity extends Component {\n\n  formatURL(url) {\n    return url.replace(/^https?:\\/\\//i, '');\n  }\n\n  render() {\n    const dataAvailable = \n      this.props.account && \n      this.props.account.username &&\n      this.props.account.member_since;\n      \n    return (\n      <div className=\"identity\">\n        <div className=\"user\">\n          <Avatar username={dataAvailable && this.props.account.username} />\n\n          <h1>\n            { dataAvailable ?\n                ((this.props.account.real_name) ? \n                  this.props.account.real_name : this.props.account.username) :\n\n                (<span className=\"placeholder\" />) }\n          </h1>\n\n          <p className=\"member-since\">\n            { dataAvailable ?\n              <React.Fragment>\n                Joined on { new Intl.DateTimeFormat('en-GB', {\n                  year : 'numeric',\n                  month: 'short',\n                  day  : '2-digit'\n                }).format(new Date(this.props.account.member_since)) }\n              </React.Fragment> : <span className=\"placeholder\" />\n            }\n          </p>\n        </div>\n\n        <div className=\"user-extended\">\n          { dataAvailable && this.props.account.bio &&\n            <p className=\"bio\">{this.props.account.bio}</p> }\n\n          { dataAvailable && this.props.account.website && \n            <p className=\"homepage\">\n              <a href={this.props.account.website}>{this.formatURL(this.props.account.website)}</a>\n            </p>\n          }\n        </div>\n      </div>\n    )\n  }\n\n}\n","import { Component } from 'react';\n\nimport { Columns } from '../Columns.js';\n\nexport default class BaseRowComponent extends Component {\n\n  constructor(props) {\n    super(props);\n    this.updateTotalRowSpan(props);\n  }\n\n  componentWillReceiveProps(next) {\n    this.updateTotalRowSpan(next);\n  }\n\n  /** Updates total unit width requirement for current row layout **/\n  updateTotalRowSpan(props) {\n    this._totalSpan = props.columns.reduce((total, field) => total + Columns.getSpan(field), 0);\n  }\n\n  getWidth(field) {\n    const span = Columns.getSpan(field);\n    return span / this._totalSpan;\n  }\n  \n}","import React from 'react';\n\nimport BaseRowComponent from './BaseRowComponent.jsx';\nimport { HEADER_NAMES } from '../Columns.js';\n\nexport default class HeaderRow extends BaseRowComponent {\n\n  render() {\n    return (\n      <div className=\"column-labels\">\n        {this.props.columns.map(field =>\n          <span\n            key={field}\n            style={{ width: `${100 * super.getWidth(field)}%` }}\n            className={`label ${field}`}\n            onClick={this.props.onSort.bind(this, field)}>\n            <span className=\"inner-wrapper\">\n              <span className=\"inner\">\n                {HEADER_NAMES[field] || field}\n              </span>\n              {this.props.sortColumn === field &&\n                <span className=\"sort icon\">\n                  <span className=\"inner\">\n                    {(this.props.sortAsc) ? '\\ue688' : '\\ue682' }\n                  </span>\n                </span>\n              }\n            </span>\n          </span>\n        )}\n      </div>\n    )\n  }\n\n}\n","import React from 'react';\nimport NumberFormat from 'react-number-format';\nimport TimeAgo from 'react-timeago';\n\nimport BaseRowComponent from './BaseRowComponent.jsx';\n\n/** Icons for possible content type values **/\nconst ICONS = {\n  TEXT_PLAIN   : 'icon_text.png',\n  TEXT_TEIXML  : 'icon_tei.png',\n  IMAGE_UPLOAD : 'icon_image.png',\n  IMAGE_IIIF   : 'icon_iiif.png',\n  DATA_CSV     : 'icon_csv.png'\n};\n\n/** Formatting rules for possible field types **/\nconst FORMATTERS = {\n  language: (language) => \n    language.toUpperCase(),\n\n  uploaded_at: (datetime) => \n    new Intl.DateTimeFormat('en-GB', {\n      year : 'numeric',\n      month: 'short',\n      day  : '2-digit'\n    }).format(new Date(datetime)),\n  \n  last_edit_at: (datetime) => \n    <TimeAgo date={datetime} />,\n\n  public_visibility: (visibility) => {\n    if (visibility === 'PUBLIC') \n      return ( <span className=\"icon\" title=\"Open to anyone\">&#xf09c;</span> );\n    else if (visibility === 'WITH_LINK')\n      return ( <span className=\"icon\" title=\"Open to anyone with the link\">&#xf0c1;</span> );\n    else \n      return ( <span className=\"icon\" title=\"Private\">&#xf023;</span> );\n  },\n\n  access_level: (level) => {\n    if (level === 'ADMIN')\n      return ( <span className=\"icon\" title=\"ADMIN\">&#xf0ad;</span> );\n    else if (level === 'WRITE')\n      return ( <span className=\"icon\" title=\"WRITE\">&#xf040;</span> );\n    else\n      return ( <span className=\"icon\" title=\"READ\">&#xf06e;</span> );\n  },\n\n  annotations: (annotations) =>\n    <NumberFormat \n      displayType=\"text\"\n      value={annotations}\n      thousandSeparator={true} />,\n\n  status_ratio: (ratio) => {\n    const total = ratio.verified + ratio.unverified + ratio.not_identifiable;\n    const pctGreen = ratio.verified / total * 100;\n    const pctYellow = ratio.not_identifiable / total * 100;\n\n    const labels = {\n      'verified': 'verified',\n      'unverified': 'unverified',\n      'not_identifiable': 'flagged'\n    }\n\n    const tooltip = ['verified', 'unverified', 'not_identifiable'].reduce((tooltip, next) => {\n      const count = ratio[next];\n      if (count === 0)\n        return tooltip;\n      else\n        return `${tooltip} ${count} ${labels[next]},`;\n    }, '').slice(0, -1);\n\n    return (\n      <span className=\"bar\" title={tooltip}>\n        <span className=\"verified\" style={{ width: `${pctGreen}%` }} />\n        <span className=\"not_identifiable\" style={{ width: `${pctYellow}%` }} />\n      </span>\n    )\n  }\n\n};\n\n/** Rules for aggregate fields **/\nconst AGGREGATE_FIELDS = {\n  agg_document: (item) => (item.author) ?\n                            `${item.author}, ${item.title}` : item.title\n};\n\nexport default class DocumentRow extends BaseRowComponent {\n\n  createAggregateField(url, field) {\n    return (\n      <a \n        key={field}\n        href={url} \n        className={field.substring(4)}\n        style={{ width: `${100 * super.getWidth(field)}%` }}>\n\n        {AGGREGATE_FIELDS[field](this.props.item)}\n      </a>\n    )\n  }\n\n  createField(url, field) {\n    const formatter = FORMATTERS[field];\n\n    const value = this.props.item[field] !== undefined ? \n      (formatter ? formatter(this.props.item[field]) : this.props.item[field]) :\n      ''; // empty value\n\n    return (\n      <a \n        key={field}\n        href={url}\n        className={field}\n        style={{ width: `${100 * super.getWidth(field)}%` }}>{value}</a>\n    )\n  }\n\n  render() {\n    const type = this.props.item.filetypes[0];\n    const url = `document/${this.props.item.id}/part/1/edit`;\n\n    return (\n      <div\n        className={`row${(this.props.selected) ? ' selected' : ''}`}\n        style={this.props.style}\n        onClick={this.props.onClick} >\n        \n        { this.props.columns.map(field => field.startsWith('agg_') ? \n          this.createAggregateField(url, field) : this.createField(url, field)) }\n\n        <span className={`type icon ${type}`}>\n          <img src={`/assets/images/${ICONS[type]}`} alt={`icon type ${type}`} />\n        </span>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class FolderRow extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { \n      editable: false,\n      title: this.props.item.title \n    }\n  }\n\n  componentWillReceiveProps(next) {\n    this.setState({ \n      editable: false,\n      title: next.item.title \n    });\n  }\n\n  makeEditable(evt) {\n    this.setState({\n      editable: true \n    },() => this._input.select());\n    evt.preventDefault();\n    evt.stopPropagation();\n  }\n\n  onChange(evt) {\n    this.setState({ title: evt.target.value });\n  }\n\n  onKeyPress(evt) {\n    if (evt.which === 13) {\n      this.setState({ \n        editable: false\n      }, () => this.props.onRename(this.props.item, this.state.title));\n    }\n  }\n\n  render() {\n    return (\n      <a\n        href={`#${this.props.item.id}`} \n        style={this.props.style}\n        className={`row folder${(this.props.selected) ? ' selected' : ''}`}\n        onClick={this.props.onClick}>\n\n        <span className=\"folder-title\">\n          {this.state.editable ? \n            <input \n              ref={i => this._input = i}\n              value={this.state.title}\n              onClick={this.makeEditable.bind(this)}\n              onChange={this.onChange.bind(this)}\n              onKeyDown={this.onKeyPress.bind(this)} />\n          : <span\n              className=\"editable\" \n              onClick={this.makeEditable.bind(this)} >{this.state.title}</span> }\n        </span>\n\n        <span className=\"type icon\">&#xf07b;</span>\n      </a>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { SortableContainer, SortableElement } from 'react-sortable-hoc';\n\nimport { HEADER_NAMES } from '../Columns.js';\n\nconst SortableItem = SortableElement(({ label }) =>\n  <div className=\"card\">{label}</div>\n);\n\nconst SortableList = SortableContainer(({ items }) =>\n  <div className=\"column-order\">\n    {items.map((item, idx) => (\n      <SortableItem key={`card-${idx}`} index={idx} label={HEADER_NAMES[item]} />\n    ))}\n  </div>\n);\n\nexport default class ColumnOrder extends Component {\n\n  render() {\n    return (\n      <SortableList\n        items={this.props.items}\n        onSortEnd={e => this.props.onSortEnd(e.oldIndex, e.newIndex)} />\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { arrayMove } from 'react-sortable-hoc';\n\nimport Modal from '../../../components/Modal.jsx';\nimport ColumnOrder from './ColumnOrder.jsx';\n\nimport { COLUMNS, HEADER_NAMES } from '../Columns.js';\n\nexport default class PreferencesModal extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      columns: props.columns.slice(0)\n    }\n  }\n\n  componentWillReceiveProps(next) {\n    if (next.columns !== this.props.columns)\n      this.setState({ columns: next.columns.slice(0) });\n  }\n\n  /** Computes a map (fieldname -> checked) from the current columns state **/\n  getCheckboxStates(props) {\n    const states = {};\n\n    COLUMNS.forEach(field => {\n      const isChecked = this.state.columns.includes(field);\n      states[field] = isChecked;\n    });\n\n    return states;\n  }\n\n  /** Sets visibility for all rows to the given boolean value **/\n  setAllRows(checked) {\n    const checkAll = () => {\n      const toAppend = \n        COLUMNS.filter(field => !this.state.columns.includes(field));\n\n      this.setState({ columns: this.state.columns.concat(toAppend) });\n    };\n\n    const uncheckAll = () => {\n      this.setState({ columns: [] });\n    };\n\n    if (checked) \n      checkAll();\n    else\n      uncheckAll();\n  }\n\n  /**\n   * Clicking 'ALL' either checks all boxes or - if all are currently\n   * checked, unchecks them.\n   */\n  onClickAll() {\n    const allRowsChecked = COLUMNS.length === this.state.columns.length;\n    if (allRowsChecked)\n      this.setAllRows(false);\n    else\n      this.setAllRows(true);\n  }\n\n  /** Toggles the checkbox with the given name **/\n  toggleOne(name) {\n    this.setState(prev => {\n      const idx = prev.columns.indexOf(name);\n      if (idx < 0)\n        prev.columns.push(name);\n      else\n        prev.columns.splice(idx, 1);        \n    \n      return prev;\n    });\n  }\n\n  onSort(oldIndex, newIndex) {\n    this.setState({\n      columns: arrayMove(this.state.columns, oldIndex, newIndex)\n    });\n  }\n\n  render() {\n    // Helper to create a single checkbox + label row\n    const createRow = (field) =>\n      <li key={field}>\n        <input\n          type=\"checkbox\"\n          id={field}\n          name={field}\n          checked={this.state.columns.includes(field)}\n          onChange={this.toggleOne.bind(this, field)} />\n        <label htmlFor={field}>{HEADER_NAMES[field]}</label>\n      </li>\n\n    return (\n      <Modal\n        className=\"preferences\"\n        title=\"Configure Columns\"\n        onClose={this.props.onCancel}>\n\n        <div className=\"scroll-pane\">\n          <div className=\"selected-columns\">\n            <button\n              className=\"all nostyle\"\n              onClick={this.onClickAll.bind(this)}>All</button>\n            <ul>\n              { COLUMNS.map(createRow) }\n            </ul>\n          </div>\n\n          <ColumnOrder\n            items={this.state.columns} \n            onSortEnd={this.onSort.bind(this)} />\n        </div>\n\n        <div className=\"buttons\">\n          <button\n            className=\"btn\"\n            onClick={this.props.onSave.bind(this, this.state.columns)}>Save</button>\n\n          <button \n            className=\"btn outline\"\n            onClick={this.props.onCancel}>Cancel</button>\n        </div>\n      </Modal>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { AutoSizer, List } from 'react-virtualized';\nimport Dropzone from 'react-dropzone'\n\nimport { Columns } from './Columns.js';\nimport DropzoneDecoration from '../upload/DropzoneDecoration.jsx';\nimport Readme from '../Readme.jsx';\nimport Selection from '../Selection.js';\n\nimport HeaderRow from './rows/HeaderRow.jsx';\nimport DocumentRow from './rows/DocumentRow.jsx';\nimport FolderRow from './rows/FolderRow.jsx';\nimport PreferencesModal from  './preferences/PreferencesModal.jsx';\n\nexport default class TablePane extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      prefsOpen: false,\n      columns: Columns.filterByView(props.columns, props.view),\n      selection: new Selection(props.folders.concat(props.documents), props.selection)\n    }\n  }\n\n  /** Set derived state **/\n  componentWillReceiveProps(next) {\n    this.setState({ \n      columns: Columns.filterByView(next.columns, next.view),\n      selection: new Selection(next.folders.concat(next.documents), next.selection)\n    });\n  }\n\n  /** Handle click/SHIFT+click/CTRL+click selection via Selection helper class */\n  onClick(evt, item, idx) {\n    const isShift = evt.getModifierState(\"Shift\");\n    const isCtrl = evt.getModifierState(\"Control\");\n    \n    // Is this a selection or deselection?\n    const isSelectAction = this.props.selection && \n      (isShift || isCtrl || !this.props.selection.includes(item));\n\n    if (isSelectAction) {\n      if (isShift)\n        this.state.selection.selectRange(idx);\n      else\n        this.state.selection.selectItem(item, isCtrl);\n\n      this.props.onSelect(this.state.selection.getSelectedItems());\n      evt.preventDefault();\n    }\n  }\n\n  rowRenderer() {\n    const allItems = this.props.folders.concat(this.props.documents);\n\n    return ((args) => {\n      const item = allItems[args.index];\n      const selected = this.props.selection && this.props.selection.includes(item);\n\n      if (item.type === 'FOLDER')\n        return (\n          <FolderRow \n            key={args.key} \n            style={args.style} \n            item={item} \n            selected={selected}\n            onClick={e => this.onClick(e, item, args.index)} \n            onRename={this.props.onRenameFolder} />\n        )\n      else\n        return (\n          <DocumentRow\n            key={args.key}\n            style={args.style}\n            columns={this.state.columns}\n            item={item}\n            selected={selected}\n            onClick={e => this.onClick(e, item, args.index)} />\n        )\n    })\n  }\n\n  showPreferences(visible) {\n    this.setState({ prefsOpen: visible });\n  }\n\n  onSavePreferences(columns) {\n    this.setState({ prefsOpen: false });\n    this.props.onChangeColumnPrefs(columns);\n  }\n\n  sortBy(field) {\n    const asc = this.props.sorting ?\n      this.props.sorting.by === field ? !this.props.sorting.asc : true :\n      true;\n\n    this.props.onSort({ by: field, asc: asc });\n  }\n\n  onDrag(active) {\n    this.setState({ drag: active });\n  }\n\n  onDrop(files, _, evt) {\n    const url = evt.dataTransfer.getData('URL');\n\n    const hostname = url ? (() => {\n      const a = document.createElement('a');\n      a.href = url;\n      return a.hostname;\n    })() : null;\n\n    this.setState({ drag: false });\n\n    if (files.length > 0)\n      this.props.onDropFiles(files);\n    else if (url && hostname !== window.location.hostname) // Require external link\n      this.props.onDropURL(url);\n  }\n\n  render() {\n    const readme = React.Children.toArray(this.props.children)\n      .filter(c => c.type === Readme)\n      .shift(); // First readme or undefined\n\n    const tablePane =\n      <div className=\"documents-pane table-pane\">\n        <AutoSizer>\n          {({ height, width }) => (\n            <List\n              className=\"virtualized-list\"\n              width={width}\n              height={height}\n              rowCount={this.props.folders.length + this.props.documents.length}\n              rowHeight={47}\n              rowRenderer={this.rowRenderer()} />\n          )}\n        </AutoSizer>\n\n        { this.state.drag && <DropzoneDecoration /> }\n        { this.props.busy && <div className=\"busy-mask\" /> }\n      </div>\n\n    return (\n      <React.Fragment>\n        {readme}\n\n        <div className=\"documents-table-header\">\n          <HeaderRow \n            columns={this.state.columns} \n            onSort={this.sortBy.bind(this)}\n            sortColumn={this.props.sorting ? this.props.sorting.by : null} \n            sortAsc={this.props.sorting ? this.props.sorting.asc : null} />\n\n          <button\n            className=\"column-options-btn nostyle icon\"\n            onClick={this.showPreferences.bind(this, true)} >&#xf141;</button>\n        </div>\n\n        {this.props.disableFiledrop ? tablePane :\n          <Dropzone\n            className=\"dropzone\"\n            disableClick={true}\n            onDragEnter={this.onDrag.bind(this, true)}\n            onDragLeave={this.onDrag.bind(this, false)}\n            onDrop={this.onDrop.bind(this)}>\n            \n            {tablePane}\n            \n          </Dropzone>\n        }\n\n        {this.state.prefsOpen &&\n          <PreferencesModal\n            columns={this.props.columns}\n            onCancel={this.showPreferences.bind(this, false)} \n            onSave={this.onSavePreferences.bind(this)} />\n        }\n      </React.Fragment>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class Folder extends Component {\n\n  render() {\n    return (\n      <a href={`#${this.props.id}`} \n        className={`cell${(this.props.selected) ? ' selected' : ''}`}\n        onClick={this.props.onClick}>\n\n        <div className=\"inner\">\n          <div className=\"item-wrapper\">\n            <div className=\"folder\">\n              <div className=\"label\">\n                {this.props.title}\n              </div>\n            </div>\n          </div>\n        </div>\n      </a>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class Document extends Component {\n\n  render() {\n    const type = this.props.filetypes[0]; // TODO make more clever in the future\n    const isStacked = this.props.fileCount > 1;\n\n    return (\n      <a href={`document/${this.props.id}/part/1/edit`}\n        className={`cell${(this.props.selected) ? ' selected' : ''}`}\n        onClick={this.props.onClick} >\n        \n        <div className=\"inner\">\n          <div className={`item-wrapper${isStacked ? ' stacked' : ''}`}>\n            { isStacked && <div className=\"stack\" /> }\n            <div className={`document ${type}`}>\n              <div className=\"label\">\n                {this.props.title}\n              </div>\n            </div>\n          </div>\n        </div>\n      </a>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport Dropzone from 'react-dropzone'\n\nimport { AutoSizer, List } from 'react-virtualized';\n\nimport Selection from '../Selection.js';\nimport Folder from './Folder.jsx';\nimport Document from './Document.jsx';\nimport Readme from '../Readme.jsx';\n\nimport DropzoneDecoration from '../upload/DropzoneDecoration.jsx';\n\nconst ITEM_SIZE = 192;\n\n/**\n * Using the following example:\n *\n * https://stackoverflow.com/questions/46368305/how-to-make-a-list-grid-with-a-responsive-number-of-columns-using-react-virtuali\n * http://plnkr.co/edit/zjCwNeRZ7XtmFp1PDBsc?p=preview\n */\nexport default class GridPane extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      selection: new Selection(props.folders.concat(props.documents), props.selection) \n    };\n  }\n\n  /** Set derived state **/\n  componentWillReceiveProps(next) {\n    this.setState({ \n      selection: new Selection(next.folders.concat(next.documents), next.selection)\n    });\n  }\n\n  /** Handle click/SHIFT+click/CTRL+click selection via Selection helper class */\n  onClick(evt, item, idx) {\n    const isShift = evt.getModifierState(\"Shift\");\n    const isCtrl = evt.getModifierState(\"Control\");\n\n    const isSelectAction =\n      isShift || isCtrl || !this.props.selection.includes(item);\n\n    if (isSelectAction) {\n      if (isShift)\n        this.state.selection.selectRange(idx);\n      else\n        this.state.selection.selectItem(item, isCtrl);\n\n      this.props.onSelect(this.state.selection.getSelectedItems());\n      evt.preventDefault();\n    }\n  }\n\n  rowRenderer(itemsPerRow, rowCount) {\n    const allItems = this.props.folders.concat(this.props.documents);\n\n    return ((args) => {\n      const fromIndex = args.index * itemsPerRow;\n      const toIndex = Math.min(fromIndex + itemsPerRow, allItems.length);\n      const itemsInRow = toIndex - fromIndex;\n\n      const renderedItems = new Array(itemsInRow).fill(undefined).map((_, rowIdx) => {\n        const idx = rowIdx + fromIndex;\n        const item = allItems[idx];\n\n        if (item.type === 'FOLDER')\n          return (\n            <Folder\n              key={idx} \n              id={item.id}\n              title={item.title} \n              selected={this.props.selection && this.props.selection.includes(item)}\n              onClick={e => this.onClick(e, item, idx)} />\n          )\n        else\n          return (\n            <Document\n              key={idx}\n              id={item.id}\n              title={item.title}\n              filetypes={item.filetypes}\n              fileCount={item.file_count}\n              selected={this.props.selection && this.props.selection.includes(item)}\n              onClick={e => this.onClick(e, item, idx)} />\n          )\n      });\n\n      if (itemsInRow < itemsPerRow) // Add dummies to preserve grid layout\n        renderedItems.push(new Array(itemsPerRow - itemsInRow).fill(undefined).map((_, idx) =>\n          <div className=\"cell dummy\" key={`dummy-${idx}`} />\n        ))\n\n      return (\n        <div\n          key={args.key}\n          style={args.style}\n          className=\"row\">\n          {renderedItems}\n        </div>\n      )\n    });\n  }\n\n  onDrag(active) {\n    this.setState({ drag: active });\n  }\n\n  onDrop(files, _, evt) {\n    const url = evt.dataTransfer.getData('URL');\n\n    this.setState({ drag: false });\n\n    if (files.length > 0) this.props.onDropFiles(files);\n    else if (url) this.props.onDropURL(url);\n  }\n\n  render() {\n    const readme = React.Children.toArray(this.props.children)\n      .filter(c => c.type === Readme)\n      .shift(); // First readme or undefined\n\n    const gridPane =\n      <AutoSizer>\n        {({ height, width }) => {\n          const itemCount = this.props.folders.length + this.props.documents.length;\n          const itemsPerRow = Math.floor(width / ITEM_SIZE);\n          const rowCount = Math.ceil(itemCount / itemsPerRow);\n\n          return (\n            <List\n              className=\"virtualized-grid\"\n              width={width}\n              height={height}\n              rowCount={rowCount}\n              rowHeight={ITEM_SIZE}\n              rowRenderer={this.rowRenderer(itemsPerRow, rowCount)} />\n          )\n        }}\n      </AutoSizer>\n\n    return (\n      <React.Fragment>\n        {readme}\n        <div className=\"documents-pane grid-pane\">\n          {this.props.disableFiledrop ? gridPane :\n            <Dropzone\n              className=\"dropzone\"\n              disableClick={true}\n              onDragEnter={this.onDrag.bind(this, true)}\n              onDragLeave={this.onDrag.bind(this, false)}\n              onDrop={this.onDrop.bind(this)}>\n\n              {gridPane}\n\n            </Dropzone>\n          }\n\n          { this.state.drag && <DropzoneDecoration /> }\n        </div>\n      </React.Fragment>\n    )\n  }\n\n}\n","// Columns available in all views\nconst COLUMNS_GENERAL = [\n  // Aggregate fields\n  // 'agg_document',\n\n  // Common fields\n  'author',\n  'title',\n  'language',\n  'date_freeform',\n  'uploaded_at',\n  'last_edit_at',\n  'last_edit_by',\n  'annotations',\n  'public_visibility',\n  'status_ratio'\n  // 'activity'\n];\n\n// Columns specific to SHARED_WITH_ME view\nconst COLUMNS_SHARED_WITH_ME = [\n  'owner',\n  'shared_by',\n  'access_level'\n];\n\nexport const COLUMNS = COLUMNS_GENERAL.concat(COLUMNS_SHARED_WITH_ME);\n\n// Labels to use for fields\nexport const HEADER_NAMES = {\n  // agg_document    : 'Document',\n\n  author            : 'Author',\n  title             : 'Title',\n  language          : 'Language',\n  date_freeform     : 'Date',\n  uploaded_at       : 'Uploaded at',\n  last_edit_at      : 'Last edit',\n  last_edit_by      : 'Last edit by',\n  annotations       : 'Annotations',\n  public_visibility : 'Visibility',\n  status_ratio      : 'Verification ratio',\n  activity          : 'Activity graph',\n\n  owner             : 'Document owner',\n  shared_by         : 'Shared by',\n  access_level      : 'Access'\n};\n\n// Relative width requirements per column (XL, L, M, S)\nexport const COLUMN_WIDTH = {\n  agg_document    : 'XL',\n\n  author            : 'M',\n  title             : 'L',\n  language          : 'M',\n  date_freeform     : 'M',\n  uploaded_at       : 'M',\n  last_edit_at      : 'M',\n  last_edit_by      : 'M',\n  annotations       : 'M',\n  public_visibility : 'M',\n  status_ratio      : 'M',\n  activity          : 'M',\n\n  owner             : 'M',\n  shared_by         : 'M',\n  access_level      : 'M'\n};\n\nexport const AGGREGATE_COLUMNS = {\n  agg_document: [ 'author', 'document' ]\n};\n\n// Static helper methods \nexport class Columns {\n\n  static getSpan(field) {\n    const w = COLUMN_WIDTH[field];\n    if (w === 'XL') \n      return 6;\n    else if (w === 'L')\n      return 4;\n    else if (w === 'M')\n      return 2;\n    else if (w === 'S')\n      return 1;\n  }\n\n  /** Expands agg_ columns to those that are required to build them **/\n  static expandAggregatedColumns(columns) {\n    return columns.reduce((result, field) => {\n      if (field.startsWith('agg_'))\n        result = result.concat(AGGREGATE_COLUMNS[field]);\n      else\n        // Just append\n        result.push(field);\n\n      return result;\n    }, []);\n  }\n\n  /** Removes the columns that are not applicable in the given view **/\n  static filterByView(columns, view) { \n    if (view === 'MY_DOCUMENTS')\n      // Remove columns specific to 'Shared With Me'\n      return columns.filter(c => !COLUMNS_SHARED_WITH_ME.includes(c));\n    else\n      // All\n      return columns; \n  }\n\n}","export default class Selection {\n    \n  constructor(allItems, selection) {\n    this._allItems = allItems;\n    this._selection = selection;\n  }\n\n  clear() {\n    this._selection = [];\n  }\n\n  isEmpty() {\n    return this._selection.length === 0;\n  }\n\n  getSelectedItems() {\n    return this._selection;\n  }\n\n  selectItem(item, isCtrlPressed) {\n    const thisIdx = this._selection.indexOf(item);\n    const isSelected = thisIdx > -1;\n\n    if (isCtrlPressed) {\n      // Toggle this item, leave the rest of the selection unchanged\n      if (isSelected)\n        this._selection.splice(thisIdx, 1);\n      else\n        this._selection.push(item);      \n    } else {\n      // Toggle state of this item and clear the rest of the selection\n      this._selection = [ item ];\n    }\n  }\n\n  /**\n   * Range selection: SHIFT + click. \n   * \n   * Behavior follows Mac conventions, cf. \n   * https://stackoverflow.com/questions/2959887/algorithm-for-shift-clicking-items-in-a-collection-to-select-them\n   */\n  selectRange(toIdx) {\n    const selectedIndices = this._selection.map(item => {\n      return this._allItems.indexOf(item);\n    });   \n    \n    const minIdx = Math.min.apply(null, selectedIndices);\n    const maxIdx = Math.max.apply(null, selectedIndices);\n\n    const isOutside = (toIdx > maxIdx) || (toIdx < minIdx);\n\n    const slice = (from, to) => this._allItems.slice(from, to + 1);\n\n    if (isOutside && toIdx > maxIdx)\n      // Expand selection downwards\n      this._selection = slice(minIdx, toIdx);\n    else if (isOutside)\n      // Expand selection upwards\n      this._selection = slice(toIdx, maxIdx);\n    else\n      // Fill from topmost\n      this._selection = slice(minIdx, toIdx);\n  }\n\n  static isSingleSelection(selected) {\n    return selected.length === 1;\n  }\n\n  static isSingleFolder(selected) {\n    return selected.length === 1 && selected[0].type === 'FOLDER';\n  }\n\n  static isSingleDocument(selected) {\n    return selected.length === 1 && selected[0].type === 'DOCUMENT';\n  }\n\n  static includesText(selected) {\n    const withText = selected.filter(item => {\n      return item.filetypes && item.filetypes.find(ft => ft.startsWith(\"TEXT\"));\n    });\n    return withText.length > 0;\n  }\n\n}","import React, { Component } from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport ContentEditable from 'react-sane-contenteditable';\n\nconst INITIAL_STATE = {\n  editing: false,\n  modifiedContent: null\n}\n\nexport default class Readme extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {};\n\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  onKeydown(evt) {\n    if (evt.which === 27) // Esc\n      this.onCancel(); \n    else if (evt.ctrlKey && evt.which === 13) // Ctrl+Enter \n      this.onSave();\n  }\n\n  onEdit() {\n    document.addEventListener('keydown', this.onKeydown, false);\n    this.setState({ editing: true });\n  }\n\n  onChange(_, value) {\n    this.setState({ modifiedContent: value });\n  }\n\n  onDelete() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n    this.props.onDelete && this.props.onDelete();\n  }\n\n  onSave() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n    this.props.onUpdate && this.props.onUpdate(this.state.modifiedContent);\n    this.setState(INITIAL_STATE);\n  }\n\n  onCancel() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n    if (typeof this.props.content === 'boolean')\n      this.onDelete();\n    else\n      this.setState(INITIAL_STATE);\n  }\n\n  renderView(content) {\n    return (\n      <div className=\"readme\">\n        <div className=\"wrapper\">\n          <div className=\"textbox\">\n            <ReactMarkdown source={content} />       \n          </div>\n\n          {this.props.onUpdate && this.props.onDelete &&\n            <span className=\"buttons modify\">\n              <button\n                className=\"icon nostyle\"\n                title=\"Edit\"\n                onClick={this.onEdit.bind(this)}>&#xf040;</button>\n            </span>\n          }\n        </div>\n      </div>\n    )\n  }\n\n  renderEdit(content) {\n    return (\n      <div className=\"readme editing\">\n        <div className=\"wrapper\">\n          <ContentEditable \n            tagName=\"div\"\n            className=\"textbox\"\n            content={content} \n            editable={true} \n            multiLine={true}\n            onChange={this.onChange.bind(this)}/>            \n\n          <div className=\"editbar\">\n            <span className=\"hint\">Supports styling with <a href=\"# \">Markdown</a></span>\n            <span className=\"buttons\">\n              <button\n                className=\"label nostyle\"\n                onClick={this.onDelete.bind(this)}>Delete description</button>\n\n              <button \n                className=\"icon nostyle\"\n                onClick={this.onSave.bind(this)}>&#xf00c;</button>\n\n              <button \n                className=\"icon nostyle\"\n                onClick={this.onCancel.bind(this)}>&#xf00d;</button>\n            </span>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  render() {\n    const editOnOpen = typeof this.props.content === 'boolean';\n\n    if (editOnOpen)\n      document.addEventListener('keydown', this.onKeydown, false);\n\n    const content = editOnOpen ? '' : \n      (this.state.modifiedContent ? this.state.modifiedContent : this.props.content);\n\n    return (this.state.editing || editOnOpen) ? this.renderEdit(content) : this.renderView(content);\n  }\n\n}\n","export default class StoredUIState {\n\n  static load() {\n    const state = {};\n\n    const addIfDefined = (key) => {\n      const value = localStorage.getItem(`r2.workspace.${key}`);\n      if (value) state[key] = JSON.parse(value);\n    }\n\n    ['view', 'presentation', 'table_columns', 'table_sorting'].map(addIfDefined)\n\n    return state;\n  }\n\n  static save(key, value) {\n    const prefixed = `r2.workspace.${key}`\n    localStorage.setItem(prefixed, JSON.stringify(value));\n  }\n\n}","import React, { Component } from 'react';\nimport Draggable from 'react-draggable';\n\nexport default class Modal extends Component {\n\n  render() {\n    return (\n      <div className={`clicktrap ${this.props.className}`}>\n        <div className=\"modal-wrapper\">\n          <Draggable handle=\".modal-header\">\n            <div className=\"modal\">\n              <div className=\"modal-header\">\n                <h1 className=\"title\">{this.props.title}</h1>\n                <button\n                  className=\"close nostyle\"\n                  onClick={this.props.onClose}>&#xe897;</button>\n              </div>\n\n              <div className=\"modal-body\">\n                {this.props.children}\n              </div>\n            </div>\n          </Draggable>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport posed from 'react-pose';\n\nconst AnimatedDiv = posed.div({\n  open:   { \n    bottom: '30px',\n    transition: {\n      ease: 'easeOut',\n      duration:200\n    }\n  },\n  closed: { bottom: '-140px' }\n});\n\nexport default class DropzoneDecoration extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { visible: false };\n  }\n\n  componentDidMount() {\n    this.setState({ visible: true });\n  }\n\n  render() {\n    return (\n      <div className=\"dropzone-decoration\">\n        <AnimatedDiv className=\"inner\" pose={this.state.visible ? 'open' : 'closed'}>\n          <span className=\"icon\">&#xf0ee;</span>\n          <p className=\"instructions\">\n            Drop files or IIIF manifest URLs to add them to your workspace.\n          </p>\n          <p className=\"supported\">\n            Supported formats: plain text (UTF-8), TEI/XML, image files, CSV (UTF-8)\n          </p>\n        </AnimatedDiv>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class Avatar extends Component {\n\n  // https://medium.com/@pppped/compute-an-arbitrary-color-for-user-avatar-starting-from-his-username-with-javascript-cd0675943b66\n  stringToHslColor(str) {\n    let hash = 0;\n    for (let i=0; i<str.length; i++) {\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\n    }\n    return hash % 360;\n  }\n\n  render() {\n    const color = this.props.username ? `hsl(${this.stringToHslColor(this.props.username)}, 35%, 65%)` : '#e2e2e2';\n\n    return (\n      <div className=\"avatar\" style={{ backgroundColor: color }}>\n        <div className=\"inner\">\n          { this.props.username && this.props.username.charAt(0).toUpperCase() }\n        </div>\n      </div>\n    )\n  }\n\n}","import axios from 'axios';\n\nconst fetchDocuments = (path, config) => {\n  return axios.post(`/api/directory/${path}`, config);\n};\n\nexport default class API {\n\n  static accountData() {\n    return axios.get('/api/account/my');\n  }\n\n  static myDocuments(config, opt_folder) {\n    return opt_folder ?\n      fetchDocuments(`my/${opt_folder}`, config) : fetchDocuments('my', config);\n  }\n\n  static sharedWithMe(config, opt_folder) {\n    return opt_folder ? \n      fetchDocuments(`my/shared/${opt_folder}`, config) : fetchDocuments('my/shared', config);\n  }\n\n  // ~~~ Service announcement\n  static latestAnnouncement() {\n    return axios.get('/api/announcements/my/latest');\n  }\n\n  static confirmAnnouncement(uuid) {\n    return axios.put(`/api/announcements/${uuid}`);\n  }\n\n  // ~~~ Folder actions ~~~\n  static createFolder(title, parentId) {\n    return axios.post('/api/folder', {\n      title: title,\n      parent: parentId\n    });\n  }\n\n  static renameFolder(id, title) {\n    return axios.put(`/api/folder/${id}?title=${title}`);\n  }\n\n  static deleteFolder(id) {\n    return axios.delete(`/api/folder/${id}`);\n  }\n\n  // ~~~ Document actions ~~~\n  static bulkDeleteFolders(ids) {\n    return axios.delete(`/api/folder/bulk`, { data: ids });\n  }\n\n  // Deletes one document via the API\n  static deleteDocument(id) {\n    return axios.delete(`/api/document/${id}`);\n  }\n\n  // Deletes multiple documents in one go via the bulk API\n  static bulkDeleteDocuments(ids) {\n    return axios.delete('/api/document/bulk', { data: ids });\n  }\n\n  static unshareDocument(id) {\n    return axios.delete(`/api/shared/document/${id}`);\n  }\n\n  static bulkUnshareDocuments(ids) {\n    return axios.delete('/api/shared/document/bulk', { data: ids });\n  }\n\n  // ~~~ Readme actions ~~~\n  static updateReadme(content, opt_folder_id) {\n    if (opt_folder_id)\n      return axios.post(`/api/folder/${opt_folder_id}/readme`, { data: content });\n    else\n      return axios.post('/api/directory/my/readme', { data: content });\n  }\n\n  static deleteReadme(opt_folder_id) {\n    if (opt_folder_id)\n      return axios.delete(`/api/folder/${opt_folder_id}/readme`);\n    else\n      return axios.delete('/api/directory/my/readme');\n  }\n\n}","import React, { Component } from 'react';\nimport ReactMarkdown from 'react-markdown';\n\nimport API from './API.js';\nimport Modal from '../common/components/Modal.jsx';\n\nexport default class BasePopupForm extends Component {\n\n  confirm = () => {\n    API.confirmAnnouncement(this.props.id).then(() => {\n      this.props.onClose();\n    });\n  }\n\n  render() {\n    return (\n      <Modal \n        title=\"A Message from Recogito\" \n        className=\"announcement\"\n        onClose={this.confirm}>\n\n        <div className=\"content\">\n          <ReactMarkdown source={this.props.message} />\n        </div>\n\n        <div className=\"buttons\">\n          <button\n            className=\"btn \"\n            onClick={this.confirm}>Got it, thanks!</button>\n        </div>\n      </Modal>\n    )\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class Meter extends Component {\n\n  render() {\n    return (\n      <div\n        className=\"meter\"\n        style={{ position: 'relative' }}>\n\n        <div\n          className=\"bar\"\n          style={{\n            width: `${100 * this.props.value}%`,\n            height: '100%'\n          }} />\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\n\nimport Meter from '../../components/Meter.jsx';\n\nexport default class Uploader extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = this._emptyState(props);\n    this.start();\n  }\n\n  _emptyState(props) {\n    return {\n      files: props.files,\n      remoteSource: props.url,\n      phase: 'Uploading',\n      totalSize: props.files.reduce((total, f) => total + f.size, 0),\n      filepartIds: (props.files.length > 0) ? props.files.map(() => null) : [ null ],\n      uploadId: null,\n      uploadStatus: (props.files.length > 0) ? props.files.map(() => 'UPLOADING') : [ 'UPLOADING'],\n      progress: (props.files.length > 0) ? props.files.map(() => 0) : [ 0 ],\n      errors: []\n    };\n  }\n\n  componentWillReceiveProps(next) {\n    if (this.props.files === next.files && this.props.url === next.url)\n      return;\n\n    this.setState(this._emptyState(next), () => this.start());\n  }\n\n  /** \n   * Starts a new upload.\n   * \n   * Since one document generally consists of multiple files, the \n   * upload process is multi-stage: \n   * \n   * - first, the new document is initialized, and assigned an ID on the server\n   * - then, all files are uploaded to this document\n   * - finally, a finalization requests closes the document, and waits for any\n   *   processing (image tiling, TEI conversion) to finish\n   */\n  start() {\n    this.initNewDocument()\n      .then((result) => { \n        this.setState({ uploadId: result.data.id });\n\n        // Branch based on files vs. remote URL\n        if (this.state.files.length > 0)\n          return this.uploadFiles() \n        else if (this.state.remoteSource)\n          return this.registerURL()\n      })\n      .catch(error => {\n        this.setState(prev => {\n          const errors = prev.errors.slice(0);\n          errors.push(error.response.data);\n          return { errors: errors };\n        });\n      })\n      .then(this.finalizeDocument.bind(this));\n  }\n\n  /**\n   * Initializes a new document, using the filename as title,\n   * or a 'New document' placeholder in case there are multiple files.\n   */\n  initNewDocument() {\n    const title = (this.state.files.length === 1) ? this.state.files[0].name : 'New document';\n    const formdata = new FormData();\n    formdata.append('title', title);\n\n    return axios.post('/my/upload', formdata, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    });\n  }\n\n  registerURL() {\n    this.setState({ phase: 'Importing' });\n\n    const formdata = new FormData();\n    formdata.append('url', this.state.remoteSource);\n\n    return axios.post(`/my/upload/${this.state.uploadId}/file`, formdata, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    });\n  }\n\n  /**\n   * Uploads the files in parallel.\n   */\n  uploadFiles() {\n    // Helper: handles upload for one file\n    const uploadOne = (file, idx) => {\n      const formdata = new FormData();\n      formdata.append('file', file);\n\n      const onUploadProgress = (evt) => {\n        const progress = this.state.progress.slice(0); // Clone progress array\n        progress[idx] = evt.loaded;\n        this.setState({ progress: progress });\n      }\n\n      return axios.post(`/my/upload/${this.state.uploadId}/file`, formdata, {\n        headers: { 'X-Requested-With': 'XMLHttpRequest' },\n        onUploadProgress: onUploadProgress\n      }).then(result => {\n        this.setState(prev => {\n          const filepartIds = prev.filepartIds.slice(0);\n          filepartIds[idx] = result.data.uuid;\n          return { filepartIds: filepartIds };\n        });\n\n        return result;\n      }).catch(error => {\n        this.setState(prev => {\n          const uploadStatus = prev.uploadStatus.slice(0);\n          uploadStatus[idx] = 'FAILED';\n\n          const errors = prev.errors.slice(0);\n          errors.push(error.response.data);\n\n          return { \n            uploadStatus: uploadStatus,\n            errors: errors \n          };\n        });\n      });\n    }\n    \n    // The list of request promises...\n    const requests = this.state.files.map((file, idx) => uploadOne(file, idx));\n\n    // ... rolled into a promise of the list of request results\n    return Promise.all(requests);\n  }\n\n  /**\n   * Finalizes the upload, creating the document and starting processing tasks (if any)\n   */\n  finalizeDocument()  {\n    const currentFolder = document.location.hash.substring(1);\n\n    const url = currentFolder ?\n      `/my/upload/${this.state.uploadId}/finalize?folder=${currentFolder}` :\n      `/my/upload/${this.state.uploadId}/finalize`;\n\n    return axios.post(url, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    }).then(result => {\n      const tasks = result.data.running_tasks;\n      if (tasks.length > 0) {\n        this.setState({ phase: 'Importing...' });\n        this.pollTaskProgress(result.data.document_id, tasks);\n      } else {\n        this.props.onUploadComplete();\n      }\n    }).catch(error => {\n      // console.log('Upload contained errors');\n    });\n  }\n\n  updateStatusForFile(filepartId, pollResult) {\n    const progress = pollResult.subtasks.find(t => t.filepart_id === filepartId);\n    const idx = this.state.filepartIds.indexOf(filepartId);\n\n    const setUploadStatus = (value) => {\n      this.setState(prev => {\n        const uploadStatus = prev.uploadStatus.slice(0);\n        uploadStatus[idx] = value;\n        return { uploadStatus: uploadStatus };\n      })\n    }\n\n    if (progress)\n      setUploadStatus(progress.status);\n    else // No task running for this file - complete\n      setUploadStatus('COMPLETED');\n  }\n\n  /**\n   * Polls import task progress\n   */\n  pollTaskProgress(documentId, taskTypes) {    \n    axios.get(`/api/job?id=${documentId}`)\n      .then(result => {\n        // Update status per file\n        this.state.filepartIds.map(id => this.updateStatusForFile(id, result.data));\n        const isDone = result.data.status === 'COMPLETED' || result.data.status === 'FAILED';\n        if (isDone)\n          this.props.onUploadComplete()\n        else\n          setTimeout(() => this.pollTaskProgress(documentId, taskTypes), 1000);\n      })\n      .catch(error => {\n        if (error.response.status === 404)\n          // Tasks might still be initializing\n          setTimeout(() => this.pollTaskProgress(documentId, taskTypes), 1000);\n      });\n  }\n\n  isUploadComplete() {\n    return this.state.uploadStatus\n      .reduce((complete, next) => complete && (next === 'COMPLETED' || next === 'FAILED'));\n  }\n\n  onCancel(evt) {\n    if (this.isUploadComplete())\n      this.props.onUploadComplete();\n  }\n\n  render() {\n    const totalLoaded = this.state.progress.reduce((total, next) => total + next, 0);\n\n    return (\n      <div className=\"upload-progress\">\n        <div className=\"phase\">\n          {this.state.phase}\n          <button \n            className=\"close nostyle\"\n            onClick={this.onCancel.bind(this)}>&#xe897;</button>\n        </div>\n        <ul className={`files${(this.state.errors.length > 0) ? ' has-errors' : ''}`}>\n          {this.state.files.map((f, idx) =>\n            <li key={idx}>\n              {f.name}\n              <span className={`icon spinner ${this.state.uploadStatus[idx]}`}></span>\n            </li>\n          )}\n\n          {this.state.remoteSource &&\n            <li>\n              Fetching content from remote source...\n              <span className=\"icon spinner RUNNING\"></span>\n            </li>\n          }\n        </ul>\n        {this.state.errors.length > 0 && \n          <ul className=\"errors\">\n            {this.state.errors.map((message, idx) => <li key={idx}>{message}</li>)}\n          </ul>\n        }\n        <div className=\"progress\">\n          <Meter value={totalLoaded / this.state.totalSize} />\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class AdvancedSearch extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.onMousedown = this.onMousedown.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.onMousedown, false);\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMousedown, false);\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onMousedown(evt) {\n    const isClickOutside = !this._node.contains(evt.target);\n    const isClickOnToggle = evt.target.classList.contains('advanced');\n    if (isClickOutside && !isClickOnToggle) this.props.onClose();\n  }\n\n  onKeydown(evt) {\n    if (evt.which === 27) this.props.onClose();\n  }\n\n  render() {\n    return (\n      <div\n        ref={n => this._node = n}\n        className=\"advanced-search\">\n        <button\n          className=\"close nostyle\"\n          onClick={this.props.onClose}>&#xe897;</button>\n\n        <form>\n          <fieldset>\n            <p>\n              <label>Search in</label>\n              <select>\n                <option>All of Recogito</option>\n                <option>My documents</option>\n                <option>Shared with me</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Document type</label>\n              <select>\n                <option>Any</option>\n                <option>Text</option>\n                <option>Image</option>\n                <option>Table</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Owner</label>\n              <select>\n                <option>Anyone</option>\n                <option>me</option>\n                <option>specific user</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Metadata contains</label>\n              <input type=\"text\" />\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Last modified</label>\n              <select>\n                <option>Any time</option>\n                <option>this week</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n          </fieldset>\n          <fieldset className=\"buttons\">\n            <button className=\"nostyle clear\">Clear</button>\n            <button type=\"submit\" className=\"btn\">Search</button>\n          </fieldset>\n        </form>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nimport AdvancedSearch from './AdvancedSearch.jsx';\n\nexport default class Search extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { advancedSearchOpen: false }\n  }\n\n  toggleAdvancedSearch() {\n    this.setState(prev => (\n      { advancedSearchOpen: !prev.advancedSearchOpen }\n    ));\n  }\n\n  render() {\n    return (\n      <div className=\"wrapper\">\n        <div className=\"search\">\n          <div className=\"wrapper\">\n            <input placeholder=\"Search Recogito...\"/>\n            {/* <button\n              className=\"icon nostyle advanced\"\n            onClick={this.toggleAdvancedSearch.bind(this)}>{'\\ue688'}</button> */}\n          </div>\n          <span className=\"icon hand-lens\">&#xf002;</span>\n        </div>\n        {this.state.advancedSearchOpen &&\n          <AdvancedSearch onClose={this.toggleAdvancedSearch.bind(this)}/>\n        }\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class MenuPopup extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.onMousedown = this.onMousedown.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.onMousedown, false);\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMousedown, false);\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onMousedown(evt) {\n    const isClickOutside = !this._node.contains(evt.target);\n    if (isClickOutside) this.props.onCancel();\n  }\n\n  onKeydown(evt) {\n    if (evt.which === 27) this.props.onCancel();\n  }\n\n  render() {\n    return (\n      <div\n        ref={n => this._node = n}\n        className={`modal-menu ${this.props.className}`}>\n        <ul>\n          {this.props.menu.map(group =>\n            <li\n              key={group.group}\n              className={`group ${group.group}`}>\n\n              <ul>\n                {group.options.map(option =>\n                  <li\n                    key={option.value || option.link}\n                    className={`option${option.disabled ? ' disabled' : '' }`}\n                    onClick={(option.disabled || !option.value) ? null : this.props.onSelect.bind(this, option.value) }>\n\n                    {(option.link) ? \n                      <a href={option.link}>\n                        <span className=\"icon\">{option.icon}</span> {option.label}\n                      </a>\n                      : \n                      <span>\n                        {option.icon && <span className=\"icon\">{option.icon}</span>} {option.label}\n                      </span>\n                    }\n                  </li>\n                )}\n              </ul>\n            </li>\n          )}\n        </ul>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport Draggable from 'react-draggable';\n\nexport default class Prompt extends Component {\n\n  constructor(props) {\n    super(props);\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  /** Clear selection on ESC **/\n  onKeydown(evt) {\n    if (evt.which === 27) this.props.onNo();\n  }\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  render() {\n    const className = (this.props.type) ? `prompt ${this.props.type.toLowerCase()}` : 'prompt';\n\n    return (\n      <div className=\"clicktrap\">\n        <Draggable handle=\".prompt-header\">\n          <div className={className}>\n            <div className=\"prompt-header\">\n              <h1 className=\"title\">{this.props.title}</h1>\n            </div>\n\n            <div className=\"prompt-body\">\n              <p className=\"message\">{this.props.message}</p>\n              <p className=\"buttons\">\n                 <button className=\"btn yes\" onClick={this.props.onYes}>YES</button>\n                 <button className=\"btn outline no\" onClick={this.props.onNo}>NO</button>\n              </p>\n            </div>\n          </div>\n        </Draggable>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport API from '../API.js';\nimport Prompt from '../../common/components/Prompt.jsx';\n\nexport default class DeleteAction extends Component {\n\n  deleteFolders(folders) {\n    const ids = folders.map(f => f.id);\n    if (ids.length > 0) {\n      return ids.length === 1 ?\n        API.deleteFolder(ids[0]) : API.bulkDeleteFolders(ids);\n    } else {\n      return new Promise((resolve) => { resolve(); });\n    }\n  }\n\n  deleteDocuments(documents) {\n    const ids = documents.map(d => d.id);\n\n    if (ids.length > 0) {\n      return ids.length === 1 ? (\n        this.props.view === 'MY_DOCUMENTS' ?\n          API.deleteDocument(ids[0]) : API.unshareDocument(ids[0]) \n      ) : (\n        this.props.view === 'MY_DOCUMENTS' ?\n          API.bulkDeleteDocuments(ids) : API.bulkUnshareDocuments(ids)\n      )\n    } else {\n      return new Promise((resolve) => { resolve(); });\n    }\n  }\n\n  executeDelete() {\n    const folders = this.props.selection.filter(i => i.type === 'FOLDER');\n    const documents = this.props.selection.filter(i => i.type === 'DOCUMENT');\n\n    if (folders.length + documents.length > 0) {\n      this.props.onStart();\n\n      this.deleteDocuments(documents)\n          .then(() => this.deleteFolders(folders))\n          .then(() => {\n            this.props.onSuccess();\n          }).catch((error) => {\n            this.props.onError(error);\n          });\n    } else {\n      this.props.onCancel();\n    }\n  }\n\n  render() {\n    const message = (this.props.view === 'MY_DOCUMENTS') ?\n      \"You are about to permanently delete the selected documents. Are you sure?\" :\n      \"This will remove the selected documents from your shared documents list. Are you sure?\";\n\n    return ReactDOM.createPortal(\n      <Prompt \n        title=\"Delete\"\n        type=\"WARNING\"\n        message={message}\n        onNo={this.props.onCancel}\n        onYes={this.executeDelete.bind(this)} />,\n\n      document.body\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport axios from 'axios';\n\nimport Meter from '../../components/Meter.jsx';\n\nexport default class JobProgress extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      status: 'PENDING',\n      progress: 0, // 0 - 100\n      tasks: 0,\n      tasksCompleted: 0\n    };\n\n    this.pollProgress();\n  }\n\n  pollProgress() { \n    axios.get(`/api/job/${this.props.jobId}`)\n      .then(result => {\n        this.setState({\n          status: result.data.status,\n          progress: result.data.progress,\n          tasks: result.data.subtasks.length,\n          tasksCompleted: result.data.subtasks.filter(t => t.status === 'COMPLETED').length,\n          tasksFailed: result.data.subtasks.filter(t => t.status === 'FAILED').length\n        });\n\n        const isDone = result.data.status === 'COMPLETED' || result.data.status === 'FAILED';\n        if (isDone)\n          this.props.onComplete && this.props.onComplete();\n        else\n          setTimeout(() => this.pollProgress(), 1000);\n      })\n      .catch(error => {\n        if (error.response.status === 404)\n          // Tasks might still be initializing\n          setTimeout(() => this.pollProgress(), 1000);\n      });\n  }\n\n  handleClose = () => {\n    this.props.onClose && this.props.onClose();\n  }\n\n  render() {\n    const isDone = \n      this.state.status === 'COMPLETED' || \n      this.state.status === 'FAILED';\n\n    const labelCompleted = this.props.labelCompleted || 'Completed';\n    const labelTasks = this.props.labelTasks || 'tasks';\n\n    return ReactDOM.createPortal(\n      <div className=\"job-progress\">\n        <div className=\"header\">\n          {this.props.title}\n          {isDone && <button \n            className=\"close nostyle\"\n            onClick={this.handleClose}>&#xe897;</button>\n          }\n        </div>\n\n        <div className=\"body\">\n          <div className=\"message\">\n            {labelCompleted} {this.state.tasksCompleted} of {this.state.tasks} {labelTasks}\n            <span className={`icon spinner ${this.state.status}`}></span>\n          </div>\n\n          <div className=\"progress\">\n            <Meter value={this.state.progress / 100} />\n          </div>\n        </div>\n      </div>,\n      document.body\n    )\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class AuthoritySelection extends Component {\n\n  onChange(identifier) {   \n    const selection = this.props.selected; \n    const currentIdx = selection.indexOf(identifier);\n\n    if (currentIdx < 0)\n      selection.push(identifier);\n    else\n      selection.splice(currentIdx, 1); \n\n    this.props.onChange(selection);\n  }\n\n  render() {    \n    return (\n      <div className=\"authorities\">\n        <h2>Authority Files</h2>\n\n        <input\n          type=\"checkbox\" \n          id=\"use-all-authorities\"\n          checked={this.props.useAll} \n          onChange={this.props.onToggleAll} />\n        <label htmlFor=\"use-all-authorities\">identify entities against all available authority files</label>\n\n        <div className={`authority-list${this.props.useAll ? ' disabled' : ''}`}>\n          <table>\n            <tbody>\n              {this.props.authorities.map(authority => \n                <tr key={authority.identifier}>\n                  <td>\n                    <input \n                      type=\"checkbox\" \n                      id={authority.identifier} \n                      checked={this.props.selected.includes(authority.identifier)} \n                      onChange={this.onChange.bind(this, authority.identifier)} />\n                    <label htmlFor={authority.identifier} />\n                  </td>\n\n                  <td className=\"shortname\">\n                    <span style={{ backgroundColor: authority.color}}>\n                      {authority.homepage ? \n                        <a href={authority.homepage} \n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\">{authority.shortname}</a>\n                        : \n                        authority.shortname\n                      }\n                    </span>\n                  </td>\n\n                  <td className=\"fullname\">\n                    {authority.fullname}\n                  </td>\n                </tr>\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class EngineSelection extends Component {\n\n  render() {\n    return (\n      <div className=\"engines\">\n        <h2>Recognition Engines</h2>\n        <table cellSpacing=\"0\">\n          <tbody>\n            {this.props.engines.map((engine, idx) =>\n              <React.Fragment key={idx}>\n                <tr>\n                  <td className=\"name\">\n                    <input \n                      id={engine.identifier}\n                      type=\"radio\" \n                      group=\"engines\" \n                      checked={this.props.selected === engine.identifier}\n                      onChange={this.props.onChange.bind(this, engine.identifier)} />\n                    \n                    <label htmlFor={engine.identifier}>\n                      <span className=\"name\">{engine.name}</span>\n                    </label>\n                  </td>\n\n                  <td className=\"languages\">\n                    { engine.languages.map(lang => <span key={lang}>{lang}</span>) }\n                  </td>\n\n                  <td className=\"description\">\n                    {engine.description}\n                  </td>\n                </tr>\n                \n                <tr className=\"spacer\"></tr>\n              </React.Fragment>\n            )}\n          </tbody>\n        </table>\n        <p className=\"note\">\n          Note: different engines can provide different results and are generally \n          optimized for a specific language.\n        </p>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\n\nimport Modal from '../../components/Modal.jsx';\nimport AuthoritySelection from './authorities/AuthoritySelection.jsx';\nimport EngineSelection from './engines/EngineSelection.jsx';\n\nexport default class NERModal extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      available_engines: [],\n      available_authorities: [],\n\n      selected_engine: null,\n      selected_all_authorities: true,\n      selected_authorities: []\n    };\n\n    this.initAvailableAuthorities();\n    this.initAvailableEngines();\n  }\n\n  isInitComplete() {\n    return this.state.available_engines.length > 0 &&\n      this.state.available_authorities.length > 0;\n  }\n\n  initAvailableEngines() {\n    if (this.state.available_engines.length === 0)\n      axios.get('/api/plugins/ner')\n        .then(result => {\n          const diff = { available_engines: result.data };\n\n          if (!this.state.selected_engine) // Select first as default\n            diff.selected_engine = result.data[0] && result.data[0].identifier;\n\n          this.setState(diff);\n        });\n  }\n\n  initAvailableAuthorities() {\n    axios.get('/api/authorities/gazetteers')\n      .then(result => {\n        const diff = { available_authorities: result.data };\n\n        if (this.state.selected_all_authorities || \n             (!this.state.selected_all_authorities && this.state.selected_authorities.length === 0))\n          diff.selected_authorities = result.data.map(a => a.identifier);\n\n        this.setState(diff);\n      });\n  }\n\n  changeEngine(identifier) {\n    this.setState({ selected_engine: identifier });\n  }\n\n  toggleAllAuthorities() {\n    this.setState(prev => {\n      return { selected_all_authorities: !prev.selected_all_authorities }\n    });\n  }\n\n  changeAuthorities(authorities) {\n    this.setState({ selected_authorities: authorities });\n  }\n\n  onStart() {\n    const response = { engine: this.state.selected_engine };\n\n    if (this.state.selected_all_authorities)\n      response.all_authorities = true;\n    else \n      response.authorities = this.state.selected_authorities;\n\n    this.props.onStart(response);\n  }\n\n  render() {\n    return (\n      <Modal\n        className=\"ner\" \n        title=\"Named Entity Recognition (NER)\"\n        onClose={this.props.onCancel}>\n\n        <p>\n          NER identifies places and persons in your text automatically. \n          Depending on the length of your text, this may take a while. \n        </p>\n\n        <EngineSelection \n          engines={this.state.available_engines} \n          selected={this.state.selected_engine}\n          onChange={this.changeEngine.bind(this)} />\n\n        <AuthoritySelection \n          authorities={this.state.available_authorities} \n          useAll={this.state.selected_all_authorities}\n          selected={this.state.selected_authorities}\n          onToggleAll={this.toggleAllAuthorities.bind(this)} \n          onChange={this.changeAuthorities.bind(this)} />\n\n        <div className=\"buttons\">\n          <button\n            className=\"btn start\"\n            onClick={this.onStart.bind(this)}>Start NER</button>\n\n          <button \n            className=\"btn outline cancel\"\n            onClick={this.props.onCancel}>Cancel</button>\n        </div>\n      </Modal>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport axios from 'axios';\n\nimport JobProgress from '../../common/content/job/JobProgress.jsx';\nimport NERModal from '../../common/content/ner/NERModal.jsx';\n\nexport default class NERAction extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { running: false };\n  }\n\n  startNER = (config) => {\n    const documents = this.props.selection.filter(d => {\n      const isDocument = d.type === 'DOCUMENT'\n      const hasTextParts = d.filetypes.filter(t => t.startsWith('TEXT_')).length > 0;\n      return isDocument && hasTextParts\n    });\n\n    const taskDefinition = Object.assign(\n      { task_type: 'NER', documents: documents.map(d => d.id) }, \n      config\n    );\n\n    axios.post('/api/job', taskDefinition)\n      .then(response => {\n        this.setState({\n          running: true,\n          jobId: response.data.job_id\n        });\n      });\n  }\n\n  handleCompleted = () => {\n    this.props.onComplete && this.props.onComplete();\n  }\n\n  render() {\n    if (this.state.running) {\n      return <JobProgress \n        title=\"Named Entity Recognition\"\n        jobId={this.state.jobId} \n        onComplete={this.handleCompleted}\n        onClose={this.props.onClose}\n        labelCompleted=\"Parsed\"\n        labelTasks=\"files\" />\n    } else {\n      return ReactDOM.createPortal(\n        <NERModal \n          onStart={this.startNER}\n          onCancel={this.props.onCancel} />, \n        document.body\n      )\n    }\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\n\nexport default class PublicAccess extends Component {\n\n  state = {\n    visibility: 'PRIVATE',\n    access_level: 'READ_ALL'\n  }\n\n  componentDidMount() {\n    axios.get(`/api/sharing/folders/${this.props.item.id}/visibility`)\n      .then(result => {\n        const { visibility, access_level } = result.data;\n        this.setState({ visibility: visibility, access_level: access_level || 'READ_ALL' });\n      });\n  }\n\n  updateSetting = (update) => {\n    this.setState(update, () => {\n      axios.post('/api/sharing/folders/visibility', {\n        ...this.state, ids: [ this.props.item.id ]\n      }).catch(error => {\n        // TODO \n      });\n    });\n  }\n\n  onChangeVisibility = (visibility) => {\n    this.updateSetting({ visibility: visibility });\n  }\n\n  onChangeAccessLevel = (evt) => {\n    this.updateSetting({ access_level: evt.target.value });\n  }\n\n  render() {\n    return (\n      <div className=\"public-access\">\n        <div className=\"multi-share-section\">\n          <h3>Enable Public Access</h3>\n          <div>\n            <input \n              type=\"radio\" \n              name=\"public-access\" id=\"pa-off\"\n              checked={this.state.visibility === 'PRIVATE'} \n              onChange={() => this.onChangeVisibility('PRIVATE')} />\n            <label htmlFor=\"pa-off\">Off</label>\n            <p>\n              Only people you explicitly add as collaborators have access.\n            </p>\n          </div>\n\n          <div>\n            <input \n              type=\"radio\" \n              name=\"public-access\" \n              id=\"pa-public\" \n              checked={this.state.visibility === 'PUBLIC'} \n              onChange={() => this.onChangeVisibility('PUBLIC')} />\n            <label htmlFor=\"pa-public\">Anyone on the Web</label>\n            <p>\n              Public documents are listed on your profile page, and anyone on the Internet can find them.\n            </p>\n          </div>\n\n          <div>\n            <input \n              type=\"radio\"\n              name=\"public-access\" \n              id=\"pa-with-link\" \n              checked={this.state.visibility === 'WITH_LINK'} \n              onChange={() => this.onChangeVisibility('WITH_LINK')} />\n            <label htmlFor=\"pa-with-link\">Anyone with the Link</label>\n            <p>\n              Accessible to anyone who has the link, but it is not listed on your profile page.\n            </p>\n          </div>\n        </div>\n\n        <div className=\"multi-share-section\">\n          <strong>Access:</strong> anyone can\n\n          <select value={this.state.access_level} onChange={this.onChangeAccessLevel}>\n            <option value=\"READ_ALL\">view</option>\n            <option value=\"READ_DATA\">view map and downloads but not document content</option>\n            <option value=\"WRITE\">annotate</option>\n          </select>\n\n          <p>\n            Annotating requires a Recogito account. Visitors who are not logged in can view\n            documents (if enabled), and download annotations from the download page. But \n            they cannot add annotations, even when public annotation is enabled. Blocking \n            access to document content will also limit some of the download options.\n          </p>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { render} from 'react-dom';\n\nclass PermissionSelector extends Component {\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.onMousedown, false);\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMousedown, false);\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onMousedown = (evt) => {\n    const isClickOutside = !this._node.contains(evt.target);\n    if (isClickOutside) this.props.onCancel();\n  }\n\n  onKeydown = (evt) => {\n    evt.stopPropagation();\n    if (evt.which === 27) this.props.onCancel();\n  }\n\n  handleCancel= () => {\n    this.props.onCancel();\n  }\n\n  changeLevel(level) {\n    this.props.onChangeLevel(level);\n  }\n\n  render() {\n    return (\n      <div \n        className=\"permission-selector\"\n        ref={n => this._node = n}>\n\n        <h3>Permission Level\n          <span className=\"close outline-icon\" onClick={this.handleCancel}>{'\\ue897'}</span>\n        </h3>\n        <ul>\n          <li\n            className=\"READ\"\n            onClick={() => this.changeLevel('READ')}>\n            <div className=\"checked\">\n              <div className=\"icon\">\n                {this.props.accessLevel === 'READ' && '\\uf00c' }\n              </div>\n            </div>\n            <h4>Read</h4>\n            <p>Collaborators can read document and annotations, but not edit.</p>\n          </li>\n\n          <li \n            className=\"WRITE\"\n            onClick={() => this.changeLevel('WRITE')}>\n            <div className=\"checked\">\n              <div className=\"icon\">\n                {this.props.accessLevel === 'WRITE' && '\\uf00c' }\n              </div>\n            </div>\n            <h4>Write</h4>\n            <p>Collaborators can read document and annotations, create new annotations, add and reply to comments.</p>\n          </li>\n\n          <li\n            className=\"ADMIN\"\n            onClick={() => this.changeLevel('ADMIN')}>\n            <div className=\"checked\">\n              <div className=\"icon\">\n                {this.props.accessLevel === 'ADMIN' && '\\uf00c' }\n              </div>\n            </div>\n            <h4>Admin</h4>\n            <p>Admins can edit document metadata, invite other collaborators, backup and restore, and roll back the edit history.</p>\n          </li>\n        </ul>\n      </div>\n    )\n  }\n\n}\n\nexport function openSelector(config) {\n  const parent = config.parent;\n  const root = document.createElement('div');\n  parent.append(root);\n\n  const onCancel = () => {\n    root.remove(); \n  }\n\n  const onChangeLevel = (level) => {\n    config.onChangeLevel(level);\n    root.remove();\n  }\n\n  render(\n    <PermissionSelector \n      accessLevel={config.accessLevel}\n      onChangeLevel={onChangeLevel}\n      onCancel={onCancel} />, \n  root);\n}","import React, { Component } from 'react';\nimport { AsyncTypeahead } from 'react-bootstrap-typeahead'; \nimport axios from 'axios';\n\nexport default class AutoComplete extends Component {\n\n  state = {\n    isLoading: false,\n    options: [],\n    selected: null,\n    inputValue: null\n  }\n\n  fetchSuggestions = query => {\n    this.setState({isLoading: true});\n    axios.get(`/api/sharing/search?q=${query}`)\n      .then(result => this.setState({\n        isLoading: false,\n        options: result.data.filter(username => !this.props.exclude.includes(username))\n      }));\n  }\n\n  onChange = (selected) => {\n    // this.props.onSelect(selected[0]);\n    this.setState({ selected: selected });\n  }\n\n  onInputChange = (value) => {\n    this.setState({ inputValue: value });\n  }\n\n  clear = () => {\n    this._input.getInstance().clear();\n    this.setState({ \n      selected: null,\n      inputValue: null\n    });\n  }\n\n  onKeyDown = (evt) => {\n    const { selected, inputValue, options } = this.state;\n    if (evt.which === 13) { // Enter\n      if (selected && selected.length === 1) {\n        this.props.onSelect(selected[0]);\n        this.clear();\n      } else if (inputValue && options.includes(inputValue)) {\n        this.props.onSelect(inputValue);\n        this.clear();\n      }\n    }\n  }\n\n  render() {\n    return (\n      <AsyncTypeahead\n        id=\"add-collaborator-input\"\n        ref={r => this._input = r}\n        className=\"autocomplete\"\n        placeholder=\"Enter username\"\n        selected={this.state.selected}\n        onChange={this.onChange}\n        onInputChange={this.onInputChange}\n        onKeyDown={this.onKeyDown}\n        isLoading={this.state.isLoading}\n        onSearch={this.fetchSuggestions} \n        options={this.state.options} />\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport axios from 'axios';\nimport { openSelector } from './PermissionSelector.js';\nimport Autocomplete from './Autocomplete.jsx';\n\nexport default class Collaborators extends Component {\n\n  state = {\n    collaborators: []\n  }\n\n  componentDidMount() {\n    axios.get(`/api/sharing/folders/${this.props.item.id}/collaborators`)\n    .then(result => {\n      this.setState({ collaborators: result.data.collaborators });\n    });\n  }\n\n  storeCollaborator = (setting) => {\n    axios.post('/api/sharing/folders/collaborator', {\n      ...setting, ids: [ this.props.item.id ]\n    }).catch(error => {\n      // TODO \n    });\n  }\n  \n  openPermissionsSelector = (evt, collaborator) => {\n    const button = evt.target.nodeName === 'BUTTON' ? evt.target : evt.target.parentNode;\n\n    openSelector({\n      parent: button.parentNode, \n      accessLevel: collaborator.access_level,\n\n      onChangeLevel: level => { \n        const update= { username: collaborator.username, access_level: level } \n        this.storeCollaborator(update);\n        this.setState(prev => {\n          return {\n            collaborators: prev.collaborators.map(c => {\n              return (c.username === collaborator.username) ? update : c;\n            })\n          }\n        }) \n      }\n    });\n  }\n\n  removeCollaborator = (collaborator) => {\n    this.setState(prev => {\n      return { collaborators: prev.collaborators.filter(c => c.username !== collaborator.username) }\n    });\n\n    axios.delete('/api/sharing/folders/collaborator', { data: {\n      ids: [ this.props.item.id ],\n      username: collaborator.username\n    }}).catch(error => {\n      // TODO\n    })\n  }\n\n  addCollaborator = (username) => {\n    const update = { username: username, access_level: 'READ' }\n    this.storeCollaborator(update);\n    this.setState(prev => {\n      return { \n        collaborators:  [ ...prev.collaborators, update ]\n      }\n    });\n  }\n\n  render() {\n    const collaborators = this.state.collaborators.map(c => \n      <tr key={c.username}>\n        <td>{c.username}</td>\n        <td>\n          <button\n            className=\"btn small permissions\"\n            onClick={(evt) => this.openPermissionsSelector(evt, c)}>\n            <span className=\"label\">{c.access_level}</span>\n            <span className=\"icon\">{'\\uf0dd'}</span>\n          </button>\n        </td>\n        <td className=\"col-actions remove-collaborator\">\n          <button \n            className=\"nostyle outline-icon\"\n            onClick={() => this.removeCollaborator(c)}>{'\\ue897'}</button>\n        </td>\n      </tr>\n    );\n\n    return (\n      <div className=\"collaborators\">\n        <div className=\"multi-share-section\">\n          <h3>Collaborators</h3>\n          <table className=\"collaborators\">\n            <tbody>\n              {collaborators.length > 0 ? \n                  collaborators : <p className=\"no-collaborators\">There are no collaborators yet. Enter a username below to add one.</p>\n              }\n            </tbody>\n          </table>\n        </div>\n        <div className=\"multi-share-section add-collaborator\">\n          <Autocomplete \n            exclude={this.state.collaborators.map(c => c.username)} \n            onSelect={this.addCollaborator} />\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport Modal from '../../components/Modal.jsx';\nimport PublicAccess from './public/PublicAccess.jsx';\nimport Collaborators from './collaborators/Collaborators.jsx';\n\nexport default class ShareModal extends Component {\n\n  state = {\n    view: 'PUBLIC_ACCESS'\n  };\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onKeydown = (evt) => {\n    evt.stopPropagation();\n    if (evt.which === 27) this.props.onCancel();\n  }\n\n  setView = (name) => {\n    this.setState({ view: name });\n  }\n\n  renderPublicAccess = () => {\n    return <PublicAccess item={this.props.selection[0]} />\n  }\n\n  renderCollaborators = () => {\n    return <Collaborators item={this.props.selection[0]} />\n  }\n\n  getView = () => {\n    if (this.state.view === 'PUBLIC_ACCESS')\n      return this.renderPublicAccess();\n    else if (this.state.view === 'COLLABORATORS')\n      return this.renderCollaborators();\n  }\n\n  render() {\n    return (\n      <Modal\n        className=\"multi-share-modal\" \n        title=\"Share\"\n        onClose={this.props.onCancel}>\n        <div className=\"multi-share\">\n          <div className=\"multi-share-tabs\">\n            <ul>\n              <li \n                className={this.state.view === 'PUBLIC_ACCESS' ? 'active': ''}\n                onClick={() => this.setView('PUBLIC_ACCESS')} >\n                Public Access\n              </li>\n\n              <li \n                className={this.state.view === 'COLLABORATORS' ? 'active': ''}\n                onClick={() => this.setView('COLLABORATORS')} >\n                Collaborators\n              </li>\n\n              <li className=\"disabled\">\n                Distribute Copies\n              </li>\n            </ul>\n          </div>\n\n          <div className=\"multi-share-body\">\n            <div className=\"view-container\">\n              { this.getView() }     \n            </div>     \n\n            <div className=\"footer\">\n              <button\n                className=\"btn\"\n                onClick={this.props.onCancel}>Done</button>\n            </div>\n          </div>\n        </div>\n      </Modal>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { CSSTransition } from 'react-transition-group';\n\nimport Search from './search/Search.jsx';\nimport HeaderIcon from '../../common/content/HeaderIcon.jsx';\nimport Selection from '../../common/content/Selection.js';\nimport Breadcrumbs from '../../common/content/Breadcrumbs.jsx';\nimport MenuPopup from '../../common/components/MenuPopup.jsx';\nimport DeleteAction from '../actions/DeleteAction.jsx';\nimport NERAction from '../actions/NERAction.jsx';\n\nimport ShareModal from '../../common/content/share/ShareModal.jsx';\n\nexport default class Header extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      action: null,\n      menuVisible: false\n    };\n\n    document.body.addEventListener('keydown', this.onKeydown.bind(this), false);\n  }\n\n  onKeydown(evt) {\n    if (this.props.selection.length > 0 && evt.which === 46)\n      this.startDeleteAction();\n  }\n\n  /** User clicked the DELETE button in the mini-menu */\n  startDeleteAction() {\n    const deleteAction =\n      <DeleteAction\n        view={this.props.view}\n        selection={this.props.selection}\n        onStart={this.props.onDelete}\n        onSuccess={this.onDeleteSuccess.bind(this)}\n        onError={this.onDeleteError.bind(this)}\n        onCancel={this.cancelAction.bind(this)} />\n\n    this.setState({ action: deleteAction });\n  }\n\n  /** User clicked CANCEL in the warning prompt **/\n  cancelAction() {\n    this.setState({ action: null });\n  }\n\n  /** Delete executed successfully **/\n  onDeleteSuccess() {\n    this.setState({ action: null }, () => {\n      this.props.afterAction();\n    });\n  }\n\n  onDeleteError(error) {\n    this.setState({ action: null }, () => {\n      this.props.afterAction(); // TODO error message\n    });\n  }\n\n  handleNERComplete() {\n    setTimeout(() => this.props.afterAction(), 500);\n  }\n\n  showActionsMenu() {\n    this.setState({ menuVisible: true });\n  }\n\n  actionStarted(jobId) {\n    this.setState({ action: null });\n  }\n\n  onSelectMenuOption(option) { \n    this.setState({ menuVisible: false });\n\n    const firstSelected = this.props.selection[0];\n\n    if (option === 'OPEN') {\n      if (Selection.isSingleDocument(this.props.selection)) \n        window.location.href= `document/${firstSelected.id}/part/1/edit`;\n      else if (Selection.isSingleFolder(this.props.selection))\n        window.location.hash = firstSelected.id;\n    } else if (option === 'OPEN_TAB') {\n      if (Selection.isSingleDocument(this.props.selection)) \n        window.open(`document/${firstSelected.id}/part/1/edit`, '_blank');\n    } else if (option === 'DELETE') {\n      this.startDeleteAction();\n    } else if (option === 'SHARE') {\n      this.setState({ action: \n        <ShareModal \n          selection={this.props.selection}\n          onCancel={this.cancelAction.bind(this)} /> \n      });\n    } else if (option === 'NER') {\n      this.setState({ action: \n        <NERAction\n          selection={this.props.selection}\n          onStarted={this.actionStarted.bind(this)}\n          onComplete={this.handleNERComplete.bind(this)}\n          onCancel={this.cancelAction.bind(this)} \n          onClose={this.cancelAction.bind(this)} /> \n      });\n    }\n  }\n\n  onCancelMenu() {\n    this.setState({ menuVisible: false });\n  }\n\n  render() {\n    const isOpen = this.props.selection.length > 0;\n\n    return (\n      <div className={this.props.readme ? \"header\" : \"header no-readme\"}>\n        <div className=\"top-row\">\n          <Search/>\n          <div className=\"header-icons\">\n            <HeaderIcon icon=\"&#xe64a;\" className=\"help stroke7\" link=\"/help\" />\n          </div>\n        </div>\n        <div className=\"subheader\">\n          <Breadcrumbs \n            view={this.props.view}\n            path={this.props.breadcrumbs}\n            count={this.props.docCount}>\n\n            {!this.props.readme && this.props.view === 'MY_DOCUMENTS' &&\n              <button \n                className=\"add-abstract nostyle\"\n                onClick={this.props.onCreateReadme} >\n                <span className=\"icon\">&#xf055;</span>\n                <span className=\"label\">Add a description...</span>\n              </button>\n            }\n          </Breadcrumbs>\n\n          <div className=\"subheader-icons\">\n            <CSSTransition\n              in={isOpen} \n              timeout={500} \n              classNames=\"selection-actions\">\n\n              <div \n                className=\"selection-actions\"\n                onClick={this.showActionsMenu.bind(this)}>              \n                <span className=\"label\">Options</span>\n                <span className=\"more icon\">&#xf078;</span>\n              </div>\n            </CSSTransition>\n\n            {this.state.menuVisible &&\n              <MenuPopup\n                className=\"selection-actions-menu\"\n                menu={[\n                  { group: 'open', options: [\n                    { label: 'Open', value: 'OPEN', disabled: !Selection.isSingleSelection(this.props.selection) },\n                    { label: 'Open in new tab', value: 'OPEN_TAB', disabled: !Selection.isSingleDocument(this.props.selection) }\n                  ]},\n                  { group: 'file-ops', options: [\n                    { icon: '\\uf114', label: 'Move to', value: 'MOVE_TO', disabled: true },\n                    { icon: '\\uf0c5', label: 'Duplicate', value: 'DUPLICATE', disabled: true },\n                    { icon: '\\uf014', label: 'Delete', value: 'DELETE' }\n                  ]},\n                  { group: 'share', options: [\n                    { \n                      icon: '\\uf234', \n                      label: 'Share', \n                      value: 'SHARE', \n                      disabled: !(\n                        Selection.isSingleFolder(this.props.selection) && \n                        this.props.view === 'MY_DOCUMENTS' && \n                        this.props.folderSharing\n                      )\n                    }\n                  ]},\n                  { group: 'jobs', options: [\n                    { \n                      icon: '\\uf085', \n                      label: 'Named Entity Recognition', \n                      value: 'NER', \n                      disabled: !Selection.includesText(this.props.selection) \n                    }\n                  ]}\n                ]} \n                onSelect={this.onSelectMenuOption.bind(this)}\n                onCancel={this.onCancelMenu.bind(this)} />\n            }\n\n            <HeaderIcon\n              className=\"presentation-toggle stroke7\"\n              icon={(this.props.presentation === 'TABLE') ? '\\ue645' : '\\ue636'} \n              onClick={this.props.onTogglePresentation} />\n\n            {this.state.action}\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nimport ProfileInfo from '../../../common/content/profile/ProfileInfo.jsx';\nimport MenuPopup from '../../../common/components/MenuPopup.jsx';\n\nexport default class Account extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { menuVisible: false };\n  }\n\n  onSelectMenuOption(option) {\n    if (option === 'SETTINGS')\n      window.location.href= '/settings/account';\n    else if (option === 'SIGNOUT')\n      window.location.href= '/logout';\n    else if (option === 'HELP');\n      window.location.href= '/help';\n  }\n\n  showMenu() {\n    this.setState({ menuVisible: true });\n  }\n\n  closeMenu() {\n    this.setState({ menuVisible: false });\n  }\n\n  render() {\n    return (\n      <div\n        className=\"section account\"\n        onClick={this.showMenu.bind(this)} >\n\n        <ProfileInfo account={this.props.account} />\n\n        { this.state.menuVisible &&\n          <MenuPopup\n            className=\"account-menu\"\n            menu={[\n              { group: 'settings', options: [\n                { icon: '\\uf0ad', label: 'Account settings', link: '/settings/account' }\n              ]},\n              { group: 'general', options: [\n                { icon: '\\uf128', label: 'Help', link: '/help' },\n                { icon: '\\uf011', label: 'Sign out', link: '/logout' }\n              ]}\n            ]}\n            onSelect={this.onSelectMenuOption.bind(this)}\n            onCancel={this.closeMenu.bind(this)} />\n        }\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class BasePopupForm extends Component {\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeydown, false);\n  }\n\n  handleKeydown = (evt) => {\n    // Escape key\n    if (evt.which === 27) this.handleCancel();\n  }\n\n  handleOk = () => {\n    this.props.onOk && this.props.onOk();\n  }\n\n  handleCancel = () => {\n    this.props.onCancel && this.props.onCancel();    \n  }\n\n  render() {\n    return (\n      <div className={`clicktrap ${this.props.className}`}>\n        <div\n          className={`modal-wrapper popup-form ${this.props.className}`}>\n          <div className=\"modal\">\n            <div className=\"modal-body\">\n              <div className=\"form-body\">\n                {this.props.children}\n              </div>\n\n              <div className=\"buttons\">\n                <button \n                  className=\"btn outline tiny\"\n                  onClick={this.handleCancel}>Cancel</button>\n\n                <button\n                  className=\"btn tiny\"\n                  onClick={this.handleOk}>Ok</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport BasePopupForm from './BasePopupForm.jsx';\n\nexport default class CreateFolderForm extends Component {\n\n  state = { folderName: null }\n  \n  handleChange = (evt) => {\n    this.setState({ folderName: evt.target.value });\n  }\n\n  handleOk = () => {\n    this.props.onSubmit && this.props.onSubmit({\n      type: 'NEW_FOLDER',\n      name: this.state.folderName\n    });    \n  }\n\n  handleKeyPress = (evt) => {\n    if (evt.which === 13) // Enter\n      this.handleOk();\n  }\n\n  render() {\n    const popup =\n      <BasePopupForm\n        onOk={this.handleOk}\n        onCancel={this.props.onCancel}>\n        <input \n          type=\"text\" \n          autoFocus={true}\n          placeholder=\"Folder name\"\n          value={this.state.folderName || ''}\n          onChange={this.handleChange} \n          onKeyPress={this.handleKeyPress} />\n      </BasePopupForm>\n\n    return ReactDOM.createPortal(popup, document.body);\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class URLInput extends Component {\n\n  state = {\n    value: this.props.value || ''\n  }\n\n  handleChange = (evt) => {\n    const val = evt.target.value;\n\n    this.setState({ value: val });\n    this.props.onChange && this.props.onChange(val);\n  }\n\n  handleDrop = (evt) => {\n    const url = evt.dataTransfer.getData('text');\n    this.setState({ value: url });\n  }\n\n  handleKeyPress = (evt) => {\n    if (evt.which === 13) // Enter\n      this.props.onSubmit && this.props.onSubmit();\n  }\n\n  render() {\n    const placeholder = this.props.placeholder || 'Paste or drag URL';\n\n    return (\n      <input \n        type=\"text\" \n        autoFocus={this.props.autofocus}\n        className=\"url-input\"\n        value={this.state.value}\n        placeholder={placeholder} \n        onChange={this.handleChange}\n        onDrop={this.handleDrop}\n        onKeyPress={this.handleKeyPress} />\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport BasePopupForm from './BasePopupForm.jsx';\nimport URLInput from '../../../../common/components/URLInput.jsx';\n\nexport default class IIIFSourceForm extends Component {\n\n  state = { sourceURL: null }\n  \n  handleChange = (value) => {\n    this.setState({ sourceURL: value });\n  }\n\n  handleOk = () => {\n    this.props.onSubmit && this.props.onSubmit({\n      type: 'IIIF_SOURCE',\n      url: this.state.sourceURL\n    });    \n  }\n\n  render() {\n    const popup =\n      <BasePopupForm\n        className=\"iiif\"\n        onOk={this.handleOk}\n        onCancel={this.props.onCancel}>\n\n        <URLInput \n          autofocus={true}\n          placeholder=\"Paste or drag IIIF manifest URL\"\n          onChange={this.handleChange}\n          onSubmit={this.handleOk} />\n      </BasePopupForm>\n\n    return ReactDOM.createPortal(popup, document.body);\n  }\n\n}","import React, { Component } from 'react';\n\nimport API from '../../API.js';\nimport MenuPopup from '../../../common/components/MenuPopup.jsx';\nimport CreateFolderForm from './forms/CreateFolderForm.jsx';\nimport IIIFSourceForm from './forms/IIIFSourceForm.jsx';\n\nexport default class CreateNew extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { \n      menuVisible: false,\n      createNewForm: null // Popup form for specifying data source details\n    };\n  }\n\n  onShowOptions() {\n    this.setState({ menuVisible: true });\n  }\n\n  onSelectOption(option) {\n    this.setState({ menuVisible: false });\n    if (option === 'FOLDER') {\n      this.setState({\n        createNewForm: \n          <CreateFolderForm \n            onSubmit={this.handleFormSubmit}\n            onCancel={this.handleFormCancel} />\n      });\n    } else if (option === 'FILE') {\n      this._input.click();\n    } else if (option === 'IIIF') {\n      this.setState({\n        createNewForm:\n          <IIIFSourceForm \n            onSubmit={this.handleFormSubmit} \n            onCancel={this.handleFormCancel} /> \n      });\n    }\n  }\n\n  handleFormSubmit = (value) => {\n    if (value.type === 'IIIF_SOURCE') {\n      this.props.onCreateFromSource && this.props.onCreateFromSource(value);\n    } else if (value.type === 'NEW_FOLDER') {\n      const currentFolderId = document.location.hash.substring(1);\n      API.createFolder(value.name || 'Unnamed Folder', currentFolderId)\n         .then(() => this.props.onFolderCreated());\n    }\n\n    this.setState({ createNewForm: null });\n  }\n\n  handleFormCancel = () => {\n    this.setState({ createNewForm: null });\n  }\n\n  onUploadFiles(evt) {\n    const files = Array.from(evt.target.files);\n    this.props.onUploadFiles(files);\n  }\n\n  onCancel() {\n    this.setState({ menuVisible: false });\n  }\n\n  render() {\n    return (\n      <div className=\"section create-new\">\n        <button\n          className=\"btn create-new\"\n          onClick={this.onShowOptions.bind(this)}>\n          <span className=\"icon\">&#xf067;</span>\n          <span className=\"label\">New</span>\n        </button>\n        <input\n          ref={c => this._input = c}\n          type=\"file\"\n          name=\"file\"\n          multiple\n          onChange={this.onUploadFiles.bind(this)}\n          style={{ display: 'none' }} />\n\n        {this.state.menuVisible &&\n          <MenuPopup\n            className=\"create-new\"\n            menu={[\n              { group: 'local', options: [\n                { icon: '\\uf07b', label: 'Folder', value: 'FOLDER' },\n                { icon: '\\uf15b', label: 'File upload', value: 'FILE' }\n              ]},\n\n              { group: 'remote', options: [\n                { icon: '\\uf0c1', label: 'From IIIF manifest', value: 'IIIF' },\n                { icon: '\\uf121', label: 'From CTS service', value: 'CTS', disabled: true }\n              ]}\n            ]}\n            onSelect={this.onSelectOption.bind(this)}\n            onCancel={this.onCancel.bind(this)} />\n        }\n\n        {this.state.createNewForm}\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nclass ViewListItem extends Component {\n\n  render() {\n    return (\n      <li\n        className={this.props.current ? 'current' : null}\n        onClick={this.props.onClick}>\n        <span className=\"icon\">{this.props.icon}</span> {\n          this.props.children\n        }\n      </li>\n    )\n  }\n\n}\n\nexport default class ViewList extends Component {\n\n  render() {\n    return (\n      <div className=\"section views\">\n        <ul>\n          <ViewListItem\n            icon=\"&#xf2be;\"\n            current={this.props.currentView === 'MY_DOCUMENTS'}\n            onClick={this.props.onChangeView.bind(this, 'MY_DOCUMENTS')}>\n            My Documents\n          </ViewListItem>\n\n          <ViewListItem\n            icon=\"&#xf064;\"\n            current={this.props.currentView === 'SHARED_WITH_ME'}\n            onClick={this.props.onChangeView.bind(this, 'SHARED_WITH_ME')}>\n            Shared with me\n          </ViewListItem>\n\n          {/* <ViewListItem\n            icon=\"&#xf017;\"\n            current={this.props.currentView == 'RECENT'}\n            onClick={this.props.onChangeView.bind(this, 'RECENT')}>\n            Recent\n          </ViewListItem> */}\n        </ul>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport NumberFormat from 'react-number-format';\n\nimport Meter from '../../../common/components/Meter.jsx';\n\nexport default class Storage extends Component {\n\n  render() {\n    const dataAvailable = this.props.account && this.props.account.storage;\n    const quota = dataAvailable ? this.props.account.storage.quota_mb : 0;\n    const used = dataAvailable ? this.props.account.storage.used_mb : 0;\n\n    return (\n      <div className=\"section storage\">\n        <span className=\"icon\">&#xf1c0;</span> Storage\n        <div className=\"used-diskspace\">\n          <Meter\n            value={(quota > 0) ? Math.min(1, used / quota) : 0} />\n\n          <div className=\"label\">\n            <NumberFormat \n              displayType=\"text\"\n              value={used}\n              thousandSeparator={true} /> \n            {' of  '}\n            <NumberFormat \n              displayType=\"text\"\n              value={quota}\n              thousandSeparator={true} /> MB used\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nimport ActivityWidget from '../../common/content/activity/ActivityWidget.jsx';\nimport CollaboratorList from '../../common/content/profile/CollaboratorList.jsx';\n\nimport Account   from './sections/Account.jsx';\nimport CreateNew from './sections/CreateNew.jsx';\nimport ViewList  from './sections/Views.jsx';\nimport Storage   from './sections/Storage.jsx';\n\nexport default class Sidebar extends Component {\n\n  state = { collaborators: [] };\n\n  handleCreateFromSource = (value) => {\n    if (value.type === 'IIIF_SOURCE') {\n      this.props.onCreateFromSource && this.props.onCreateFromSource(value.url);\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"sidebar\">\n        <Account\n          account={this.props.account} />\n\n        <CreateNew \n          onFolderCreated={this.props.onFolderCreated}\n          onUploadFiles={this.props.onUploadFiles} \n          onCreateFromSource={this.handleCreateFromSource}/>\n          \n        <ViewList\n          account={this.props.account}\n          currentView={this.props.currentView}\n          onChangeView={this.props.onChangeView} />\n\n        <Storage \n          account={this.props.account} /> \n\n        <ActivityWidget \n          className=\"section\" \n          width={237}\n          height={55}\n          fill=\"#4483c4\"\n          stats={this.props.account && this.props.account.stats} />\n\n        <CollaboratorList \n          className=\"section collaborators\"\n          title=\"My top collaborators\"\n          username={this.props.account && this.props.account.username} />\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { render } from 'react-dom';\n\nimport Announcement from  './Announcement.jsx';\nimport API from './API.js';\nimport GridPane from '../common/content/grid/GridPane.jsx';\nimport TablePane from '../common/content/table/TablePane.jsx';\nimport Readme from '../common/content/Readme.jsx';\nimport { Columns } from '../common/content/table/Columns.js';\nimport StoredUIState from '../common/StoredUIState.js';\nimport Uploader from '../common/content/upload/Uploader.jsx';\nimport Header from './header/Header.jsx';\nimport Sidebar from './sidebar/Sidebar.jsx';\n\nimport '../../assets/style/workspace/index.scss';\n\nexport default class App extends Component {\n\n  constructor(props) {\n    super(props);\n\n    const state = {\n      account       : null,           // account info\n      view          : 'MY_DOCUMENTS', // view, as selected in sidebar (My Documents, Shared, Recent)\n      breadcrumbs   : [],             // the current folder (and parent folders) we are in\n      presentation  : 'TABLE',        // presentation mode TABLE or GRID\n      table_columns : [               // current table view columns configuration\n        \"author\",\n        \"title\",\n        \"language\",\n        \"date_freeform\",\n        \"uploaded_at\",\n        \"last_edit_at\"\n      ],\n      table_sorting : null,          // current table sorting (if any)\n      busy          : false,          // Document pane in 'busy' state? (Docs loading, action onging, etc.)\n      folders       : [],             // Folders\n      documents     : [],             // Documents in view\n      total_docs    : null,           // Total number of documents\n      readme        : null,           // Current folder readme\n      selection     : [],             // Selected items (folders and documents)\n      fileUploads   : [],             // Files currently uploading\n      urlUpload     : null,           // URLs currently uploading/registering\n      announcement  : null\n    };\n\n    Object.assign(state, StoredUIState.load());\n    this.state = state;\n\n    this._root = document.getElementById('app');\n\n    this.onKeydown = this.onKeydown.bind(this);\n    this.onMousedown = this.onMousedown.bind(this);\n\n    window.onhashchange = this.changeFolder.bind(this);\n  }\n\n  /** Clear selection on ESC key **/\n  onKeydown(evt) {\n    if (evt.which === 27) this.setState({ selection: [] });\n  }\n\n  /** Clear selection on click ouside the document pane **/\n  onMousedown(evt) {\n    const isClickOutside = !(\n      document.querySelector('.documents-pane').contains(evt.target) ||\n      document.querySelector('.subheader-icons').contains(evt.target)\n    );\n\n    if (isClickOutside) this.setState({ selection: [] });\n  }\n\n  componentDidMount() {\n    this._root.addEventListener('keydown', this.onKeydown, false);\n    this._root.addEventListener('mousedown', this.onMousedown, false);\n\n    this.fetchAccountData();\n    this.refreshCurrentView();\n    \n    API.latestAnnouncement().then(result => {\n      this.setState({ announcement: result.data });\n    })\n  }\n\n  componentWillUnmount() {\n    this._root.removeEventListener('keydown', this.onKeydown, false);\n    this._root.removeEventListener('mousedown', this.onMousedown, false);\n  }\n\n  getDisplayConfig() {\n    if (this.state.presentation === 'GRID')\n      return; // No configs for grid view\n\n    return {\n      columns: Columns.expandAggregatedColumns(this.state.table_columns),\n      sort: this.state.table_sorting\n    };\n  }\n\n  fetchAccountData() {\n    return API.accountData().then(result => { this.setState({ account: result.data }) });\n  }\n\n  fetchMyDocuments() {\n    this.setState({ busy: true });\n    const currentFolderId = document.location.hash.substring(1);\n    return API.myDocuments(this.getDisplayConfig(), currentFolderId).then(result => {\n      this.setState({\n        breadcrumbs: result.data.breadcrumbs,\n        readme: result.data.readme,\n        documents: result.data.items, \n        total_docs: result.data.total,\n        busy: false \n      });\n    });\n  }\n\n  fetchSharedWithMe() {\n    this.setState({ busy: true });\n    const currentFolderId = document.location.hash.substring(1);\n    return API.sharedWithMe(this.getDisplayConfig(), currentFolderId).then(result => { \n      this.setState({\n        breadcrumbs: result.data.breadcrumbs,\n        documents: result.data.items, \n        total_docs: result.data.total,\n        busy: false \n      }) \n    });\n  }\n\n  /** Switch between different document views (currently: 'my' vs. 'shared') **/\n  changeView(view) {\n    if (this.state.view !== view) {\n      StoredUIState.save('view', view);\n\n      this.setState({\n        view: view,\n        documents:[]\n      }, () => {\n        (view === 'MY_DOCUMENTS') ? this.fetchMyDocuments() : this.fetchSharedWithMe();\n      });\n    }\n  }\n\n  /** Reloads the current view from the API */\n  refreshCurrentView() {\n    if (this.state.view === 'MY_DOCUMENTS')\n      return this.fetchMyDocuments();\n    else \n      return this.fetchSharedWithMe();\n  }\n\n  changeFolder() {\n    this.setState({ selection: [] });\n    this.refreshCurrentView();\n  }\n\n  /** Toggles the view presentation (table vs. grid) **/\n  togglePresentation() {\n    this.setState(before => { \n      const p = (before.presentation === 'TABLE') ? 'GRID' : 'TABLE';\n      StoredUIState.save('presentation', p);\n      return { presentation: p };\n    });\n  }\n\n  onChangeColumnPrefs(columns) {\n    StoredUIState.save('table_columns', columns);\n    this.setState({ table_columns: columns }, () => {\n      this.refreshCurrentView();\n    });\n  }\n  \n  onSortTable(sorting) {\n    StoredUIState.save('table_sorting', sorting);\n    this.setState({ table_sorting: sorting }, () => {\n      this.refreshCurrentView();\n    });\n  }\n\n  /** File selection **/\n  onSelect(selection) {\n    this.setState({ selection: selection });\n  }\n\n  onRenameFolder(folder, title) {\n    API.renameFolder(folder.id, title)\n       .then(() => this.refreshCurrentView());\n  }\n\n  createReadme() {\n    this.setState({ readme: true });\n  }\n\n  onUpdateReadme(readme) {\n    const currentFolderId = document.location.hash.substring(1);\n    API.updateReadme(readme, currentFolderId)\n       .then(this.setState({ readme: readme }));\n  }\n\n  onDeleteReadme() {\n    const currentFolderId = document.location.hash.substring(1);\n    API.deleteReadme(currentFolderId)\n       .then(this.setState({ readme: null })); \n  }\n\n  /** File upload **/\n  startUpload(files) {\n    this.setState({ \n      fileUploads: files, \n      urlUpload: null\n    });\n  }\n\n  /** Remote file registration (IIIF, CTS) **/\n  startRegisterRemoteSource(url) {\n    this.setState({ \n      fileUploads: [],\n      urlUpload: url\n    });\n  } \n\n  onUploadComplete() {\n    this.setState({ \n      view: 'MY_DOCUMENTS', // Force view back to 'My Documents'\n      fileUploads: [], \n      urlUpload: null \n    }, () => {\n      this.refreshCurrentView()\n        .then(this.fetchAccountData.bind(this));\n    });\n  }\n\n  setBusy(busy) {\n    this.setState({ busy: busy });\n  }\n\n  afterAction() {\n    this.refreshCurrentView()\n      .then(() => this.setState({ busy: false, selection: []}))\n      .then(this.fetchAccountData.bind(this));\n  }\n\n  render() {\n    const isUploading = this.state.fileUploads.length > 0 || this.state.urlUpload;\n\n    return(\n      <React.Fragment>\n        <Sidebar\n          account={this.state.account}\n          onFolderCreated={this.refreshCurrentView.bind(this)}\n          onUploadFiles={this.startUpload.bind(this)}\n          currentView={this.state.view}\n          onChangeView={this.changeView.bind(this)} \n          onCreateFromSource={this.startRegisterRemoteSource.bind(this)} />\n\n        <div className=\"container\">\n          <Header\n            view={this.state.view}\n            breadcrumbs={this.state.breadcrumbs}\n            readme={this.state.readme}\n            docCount={this.state.total_docs}\n            selection={this.state.selection}\n            presentation={this.state.presentation}\n            onDelete={this.setBusy.bind(this, true)}\n            afterAction={this.afterAction.bind(this)}\n            folderSharing={\n              this.state.account && \n              this.state.account.feature_toggles && \n              this.state.account.feature_toggles.includes('folder-sharing')\n            }\n            onTogglePresentation={this.togglePresentation.bind(this)} \n            onCreateReadme={this.createReadme.bind(this)} />\n\n          {this.state.presentation === 'TABLE' ?\n            <TablePane\n              view={this.state.view}\n              folders={this.state.folders}\n              documents={this.state.documents}\n              columns={this.state.table_columns}\n              sorting={this.state.table_sorting}\n              busy={this.state.busy}\n              selection={this.state.selection}\n              disableFiledrop={this.state.view !== 'MY_DOCUMENTS'}\n              onSort={this.onSortTable.bind(this)}\n              onSelect={this.onSelect.bind(this)} \n              onDropFiles={this.startUpload.bind(this)} \n              onDropURL={this.startRegisterRemoteSource.bind(this)} \n              onChangeColumnPrefs={this.onChangeColumnPrefs.bind(this)} \n              onRenameFolder={this.onRenameFolder.bind(this)}>\n\n              {this.state.readme && \n                <Readme\n                  content={this.state.readme} \n                  onUpdate={this.onUpdateReadme.bind(this)} \n                  onDelete={this.onDeleteReadme.bind(this)} /> \n              }\n            </TablePane>\n            :\n            <GridPane\n              folders={this.state.folders}\n              documents={this.state.documents}\n              busy={this.state.busy}\n              selection={this.state.selection}\n              onSelect={this.onSelect.bind(this)} \n              disableFiledrop={this.state.view !== 'MY_DOCUMENTS'}\n              onDropFiles={this.startUpload.bind(this)}\n              onDropURL={this.startRegisterRemoteSource.bind(this)} >\n              \n              {this.state.readme && \n                <Readme \n                  content={this.state.readme} \n                  onUpdate={this.onUpdateReadme.bind(this)} \n                  onDelete={this.onDeleteReadme.bind(this)} /> \n              }\n            </GridPane>\n          }\n        </div>\n\n        { isUploading && \n          <Uploader\n            files={this.state.fileUploads} \n            url={this.state.urlUpload}\n            onUploadComplete={this.onUploadComplete.bind(this)} /> \n        }\n\n        {this.state.announcement && \n          <Announcement\n            id={this.state.announcement.id}\n            message={this.state.announcement.content} \n            onClose={e => this.setState({ announcement: null })} />\n        }\n      </React.Fragment>\n    )\n  }\n\n}\n\nrender(<App />, document.getElementById('app'));\n","import React, { Component } from 'react';\n\nexport default class HeaderIcon extends Component {\n\n  render() {\n    return (\n      <div\n        className={`header-icon ${this.props.className}`}\n        onClick={this.props.onClick}>\n        {(this.props.link) ? \n          <a href={this.props.link} className=\"icon inner\">\n            {this.props.icon}\n          </a> :\n\n          <span className=\"icon inner\">\n            {this.props.icon}\n          </span>\n        }\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nconst VIEW_LABELS = {\n  MY_DOCUMENTS: 'My Documents',\n  SHARED_WITH_ME: 'Shared with me'\n}\n\nexport default class Breadcrumbs extends Component {\n\n  render() {\n    const title = this.props.view ? VIEW_LABELS[this.props.view] : this.props.label;\n\n    return (\n      <div className=\"breadcrumbs\">\n        <h2>\n          <a className=\"root\" href=\"#\">{title}</a>\n\n          {this.props.path && this.props.path.map(b => \n            <a className=\"folder\" href={`#${b.id}`} key={b.id}>{b.title}</a>\n          )}\n        </h2>\n        \n        {this.props.count !== null &&\n          <span className=\"count\">{`(${this.props.count})`}</span>\n        }\n\n        {this.props.children}\n      </div>\n    )\n  }\n\n}\n"],"sourceRoot":""}