(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{18:function(e,t,a){"use strict";a.d(t,"a",function(){return m});var n=a(2),r=a(3),l=a(6),s=a(4),o=a(5),c=a(0),i=a.n(c),u=a(20),m=(a(25),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1},a.onMousedown=function(e){!a._node.contains(e.target)&&a.setState({open:!1})},a.onKeydown=function(e){27===e.which&&a.setState({open:!1})},a.toggle=function(){a.setState(function(e){return{open:!e.open}})},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.onMousedown,!1),document.addEventListener("keydown",this.onKeydown,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.onMousedown,!1),document.removeEventListener("keydown",this.onKeydown,!1)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"nav-menu",ref:function(t){return e._node=t}},i.a.createElement(u.CSSTransition,{classNames:"menu-options",in:this.state.open,timeout:150},i.a.createElement("ul",{className:"menu-options"},i.a.createElement("li",null,i.a.createElement("a",{href:"/admin"},"Activity Dashboard")),i.a.createElement("li",null,i.a.createElement("a",{href:"/admin/users"},"User Management")),i.a.createElement("li",null,i.a.createElement("a",{href:"/admin/authorities"},"Entity Management")),i.a.createElement("li",null,i.a.createElement("a",{href:"/admin/maintenance"},"Maintenance")))),i.a.createElement("div",{className:"tab",onClick:this.toggle},i.a.createElement("span",{className:"icon"},"\uf0c9")))}}]),t}(c.Component))},25:function(e,t,a){},329:function(e,t,a){e.exports=a(339)},330:function(e,t,a){},331:function(e,t,a){},332:function(e,t,a){},333:function(e,t,a){},334:function(e,t,a){},335:function(e,t,a){},336:function(e,t,a){},339:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a(3),l=a(6),s=a(4),o=a(5),c=a(0),i=a.n(c),u=a(11),m=a(18),h=a(10),p=a.n(h),d=a(20),f=(a(330),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1},a.toggle=function(){a.setState(function(e){return{open:!e.open}})},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=["foldable-panel"];return this.props.className&&e.push(this.props.className),this.state.open?e.push("open"):e.push("closed"),i.a.createElement("div",{className:e.join(" ")},i.a.createElement("h2",{onClick:this.toggle},i.a.createElement("span",{className:"icon toggle"},this.state.open?"\uf106":"\uf107"),this.props.title),i.a.createElement(d.CSSTransition,{classNames:"inner",in:this.state.open,timeout:250},i.a.createElement("div",{className:"inner"},this.props.children)))}}]),t}(c.Component)),E=a(34),b=(a(331),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={file:null,successMessage:null,errorMessage:null},a.handleAttachBackup=function(e){a.setState({file:e},function(){return a.handleRestoreBackup()})},a.handleRestoreBackup=function(){var e=new FormData;e.append("backup",a.state.file);p.a.post("/admin/maintenance/restore",e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){a.setState({successMessage:"Ok."})}).catch(function(e){a.setState({errorMessage:"Error: ".concat(e.response.statusText)})})},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement(f,{title:"Restore Document Backup"},i.a.createElement("form",{ref:function(t){return e._form=t},className:"crud restore-backup",onSubmit:this.handleRestoreBackup},i.a.createElement("div",{className:"instructions"},"Restore a document from a ZIP backup package. Unlike the normal ",i.a.createElement("strong",null,"Restore")," feature, which is available to every user, this Admin version allows you to:",i.a.createElement("ul",null,i.a.createElement("li",null,"restore ",i.a.createElement("strong",null,"modified")," backup packages"),i.a.createElement("li",null,"restore to any users' workspace - just modify the owner metadata in the ZIP accordingly"))),i.a.createElement(E.a,{name:"file",buttonOnly:!0,label:"Upload ZIP backup package",onChange:this.handleAttachBackup,buttonClass:"btn add-file"}),this.state.successMessage&&i.a.createElement("span",{className:"success message"},this.state.successMessage),this.state.errorMessage&&i.a.createElement("span",{className:"error message"},this.state.errorMessage)))}}]),t}(c.Component)),g=(a(332),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={uploads:[]},a.handleDeleteAll=function(){p.a.delete("/admin/maintenance/uploads").then(function(e){a.refresh()})},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"refresh",value:function(){var e=this;p.a.get("/admin/maintenance/uploads.json").then(function(t){e.setState({uploads:t.data})})}},{key:"componentDidMount",value:function(){this.refresh()}},{key:"render",value:function(){var e=this.state.uploads.map(function(e){return i.a.createElement("tr",null,i.a.createElement("td",null,e.owner),i.a.createElement("td",null,e.title),i.a.createElement("td",null,e.created_at))});return i.a.createElement(f,{className:"pending-uploads",title:"Pending Uploads"},i.a.createElement("table",null,i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Owner"),i.a.createElement("th",null,"Title"),i.a.createElement("th",null,"Created at"))),e.length>0?i.a.createElement("tbody",null,e):i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"3",className:"no-pending-uploads"},"There are no pending uploads")))),i.a.createElement("div",{className:"footer"},i.a.createElement("button",{className:"btn red",onClick:this.handleDeleteAll},"Delete All")))}}]),t}(c.Component)),v=function(e){function t(){return Object(n.a)(this,t),Object(l.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement(f,{className:"database",title:"Database"},i.a.createElement("div",{className:"instructions"},"Recogito stores the following data in the database:",i.a.createElement("ul",null,i.a.createElement("li",null,"User account information"),i.a.createElement("li",null,"User folder hierarchies"),i.a.createElement("li",null,"Document metadata"),i.a.createElement("li",null,"Document sharing information"),i.a.createElement("li",null,"Auxiliary information such as authority file metadata, georesolution and NER task progress, etc.")),"Make sure you perform regular backups of your database. Instructions for set up backups are ",i.a.createElement("a",{href:"https://github.com/pelagios/recogito2/wiki/Notes-on-Postgres-backup",target:"_blank",rel:"noopener noreferrer"},"here"),"."))}}]),t}(c.Component),y=a(23),j=a.n(y),O=(a(333),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={size:null},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;p.a.get("/admin/maintenance/filestore/size.json").then(function(t){e.setState({size:t.data.size})})}},{key:"render",value:function(){var e=this.state.size?(this.state.size/1024).toFixed(2):null;return i.a.createElement(f,{className:"filestore",title:"File Storage"},i.a.createElement("div",{className:"instructions"},"The ",i.a.createElement("strong",null,"file storage")," is the folder where user uploads get stored. This folder will take up the most space of your installation. Make sure you reserve enough space."),i.a.createElement("span",{className:"label"},"Current usage:"),i.a.createElement("span",{className:"value"},i.a.createElement(j.a,{displayType:"text",value:e,thousandSeparator:!0})," MB"))}}]),t}(c.Component)),k=(a(334),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={total_docs:null},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;p.a.get("/admin/maintenance/elasticsearch/props.json").then(function(t){e.setState({total_docs:t.data.total_documents})})}},{key:"render",value:function(){return i.a.createElement(f,{className:"elasticsearch",title:"ElasticSearch"},i.a.createElement("div",{className:"instructions"},"Recogito stores the following data in the ElasticSearch index:",i.a.createElement("ul",null,i.a.createElement("li",null,"Annotations and previous annotation versions"),i.a.createElement("li",null,"Entities from authority files"),i.a.createElement("li",null,"Activity stats"),i.a.createElement("li",null,"User visit stats")),"The total number of records in your ElasticSearch index is currently:",i.a.createElement("span",{className:"total-records"},i.a.createElement(j.a,{displayType:"text",value:this.state.total_docs,thousandSeparator:!0})),i.a.createElement("p",null,"You can back up your index by creating snapshots. Instructions for how to do this are ",i.a.createElement("a",{href:"https://www.elastic.co/guide/en/elasticsearch/reference/5.6/modules-snapshots.html",target:"_blank",rel:"noopener noreferrer"},"here"),".")))}}]),t}(c.Component)),w=(a(335),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={log_path:null},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;p.a.get("/admin/maintenance/logs/path.json").then(function(t){e.setState({log_path:t.data.path})})}},{key:"render",value:function(){return i.a.createElement(f,{className:"logs",title:"Logs"},i.a.createElement("div",{className:"instructions"},"Your system logs can give you information in case errors occur during operation. For the time being, you cannot see your logs in the Web interface. Recogito keeps the system logs at the following location:",i.a.createElement("p",{className:"log-path"},this.state.log_path)))}}]),t}(c.Component));a(336);a.d(t,"default",function(){return N});var N=function(e){function t(){return Object(n.a)(this,t),Object(l.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(m.a,null),i.a.createElement("h1",{className:"page-title"},"System Maintenance"),i.a.createElement("div",{className:"panels"},i.a.createElement(g,null),i.a.createElement(O,null),i.a.createElement(v,null),i.a.createElement(k,null),i.a.createElement(w,null),i.a.createElement(b,null)))}}]),t}(c.Component);Object(u.render)(i.a.createElement(N,null),document.getElementById("app"))},34:function(e,t,a){"use strict";a.d(t,"a",function(){return u});var n=a(2),r=a(3),l=a(6),s=a(4),o=a(5),c=a(0),i=a.n(c),u=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={file:null},a.onAttachFile=function(e){var t=e.target.files[0];a.setState({file:t}),a.props.onChange(t)},a}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement("dl",{className:"fileupload"},i.a.createElement("dt",null,i.a.createElement("label",{htmlFor:"".concat(this.props.name,"_name")},this.props.label)),i.a.createElement("dd",null,!this.props.buttonOnly&&i.a.createElement("input",{type:"text",id:"".concat(this.props.name,"_name"),name:"".concat(this.props.name,"_name"),disabled:!0,value:this.state.file&&this.state.file.name||""}),i.a.createElement("input",{type:"file",id:this.props.name,name:this.props.name,style:{display:"none"},onChange:this.onAttachFile}),i.a.createElement("label",{className:this.props.buttonClass,htmlFor:this.props.name},i.a.createElement("span",{className:"icon"},"\uf055"))))}}]),t}(c.Component)}},[[329,8,0,1]]]);
//# sourceMappingURL=maintenance.96156ef6.chunk.js.map