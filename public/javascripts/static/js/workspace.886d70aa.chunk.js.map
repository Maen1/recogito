{"version":3,"sources":["workspace/API.js","workspace/Announcement.jsx","common/components/Meter.jsx","common/content/upload/Uploader.jsx","workspace/header/search/AdvancedSearch.jsx","workspace/header/search/Search.jsx","common/components/MenuPopup.jsx","common/components/Prompt.jsx","workspace/actions/DeleteAction.jsx","common/content/job/JobProgress.jsx","common/content/ner/authorities/AuthoritySelection.jsx","common/content/ner/engines/EngineSelection.jsx","common/content/ner/NERModal.jsx","workspace/actions/NERAction.jsx","workspace/header/Header.jsx","workspace/sidebar/sections/Account.jsx","workspace/sidebar/sections/forms/BasePopupForm.jsx","workspace/sidebar/sections/forms/CreateFolderForm.jsx","common/components/URLInput.jsx","workspace/sidebar/sections/forms/IIIFSourceForm.jsx","workspace/sidebar/sections/CreateNew.jsx","workspace/sidebar/sections/Views.jsx","workspace/sidebar/sections/Storage.jsx","workspace/sidebar/Sidebar.jsx","workspace/App.jsx"],"names":["fetchDocuments","path","config","axios","post","concat","API","get","opt_folder","uuid","put","title","parentId","parent","id","delete","ids","data","content","opt_folder_id","BasePopupForm","handleOk","confirmAnnouncement","_this","props","then","onClose","console","log","this","react_default","a","createElement","Modal","className","react_markdown_default","source","message","onClick","Component","Meter","style","position","width","value","height","Uploader","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","_emptyState","start","files","remoteSource","url","phase","totalSize","reduce","total","f","size","filepartIds","length","map","uploadId","uploadStatus","progress","errors","next","_this2","setState","_this3","initNewDocument","result","uploadFiles","registerURL","catch","error","prev","slice","push","response","finalizeDocument","bind","name","formdata","FormData","append","headers","X-Requested-With","_this4","requests","file","idx","onUploadProgress","evt","loaded","uploadOne","Promise","all","_this5","currentFolder","document","location","hash","substring","tasks","running_tasks","pollTaskProgress","document_id","onUploadComplete","filepartId","pollResult","_this6","subtasks","find","t","filepart_id","indexOf","setUploadStatus","status","documentId","taskTypes","_this7","updateStatusForFile","setTimeout","complete","isUploadComplete","_this8","totalLoaded","onCancel","key","Meter_Meter","AdvancedSearch","onMousedown","assertThisInitialized","onKeydown","addEventListener","removeEventListener","isClickOutside","_node","contains","target","isClickOnToggle","classList","which","ref","n","type","Search","advancedSearchOpen","placeholder","AdvancedSearch_AdvancedSearch","toggleAdvancedSearch","MenuPopup","menu","group","options","option","link","disabled","onSelect","href","icon","label","Prompt","onNo","toLowerCase","react_draggable_default","handle","onYes","DeleteAction","folders","deleteFolder","bulkDeleteFolders","resolve","documents","d","view","deleteDocument","unshareDocument","bulkDeleteDocuments","bulkUnshareDocuments","selection","filter","i","onStart","deleteDocuments","deleteFolders","onSuccess","onError","ReactDOM","createPortal","Prompt_Prompt","executeDelete","body","JobProgress","handleClose","tasksCompleted","pollProgress","jobId","tasksFailed","onComplete","isDone","labelCompleted","labelTasks","AuthoritySelection","identifier","selected","currentIdx","splice","onChange","checked","useAll","onToggleAll","htmlFor","authorities","authority","includes","backgroundColor","color","homepage","rel","shortname","fullname","EngineSelection","cellSpacing","engines","engine","Fragment","languages","lang","description","NERModal","available_engines","available_authorities","selected_engine","selected_all_authorities","selected_authorities","initAvailableAuthorities","initAvailableEngines","diff","all_authorities","EngineSelection_EngineSelection","changeEngine","AuthoritySelection_AuthoritySelection","toggleAllAuthorities","changeAuthorities","NERAction","startNER","isDocument","hasTextParts","filetypes","startsWith","taskDefinition","assign","task_type","running","job_id","handleCompleted","JobProgress_JobProgress","NERModal_NERModal","Header","action","menuVisible","startDeleteAction","deleteAction","DeleteAction_DeleteAction","onDelete","onDeleteSuccess","onDeleteError","cancelAction","afterAction","firstSelected","Selection","isSingleDocument","window","isSingleFolder","open","NERAction_NERAction","onStarted","actionStarted","handleNERComplete","isOpen","readme","Search_Search","HeaderIcon","Breadcrumbs","breadcrumbs","count","docCount","onCreateReadme","react_transition_group","in","timeout","classNames","showActionsMenu","MenuPopup_MenuPopup","isSingleSelection","includesText","onSelectMenuOption","onCancelMenu","presentation","onTogglePresentation","Account","showMenu","ProfileInfo","account","closeMenu","handleKeydown","handleCancel","onOk","children","CreateFolderForm","folderName","handleChange","onSubmit","handleKeyPress","popup","BasePopupForm_BasePopupForm","autoFocus","onKeyPress","URLInput","val","handleDrop","dataTransfer","getData","autofocus","onDrop","IIIFSourceForm","sourceURL","URLInput_URLInput","CreateNew","handleFormSubmit","onCreateFromSource","currentFolderId","createFolder","onFolderCreated","createNewForm","handleFormCancel","CreateFolderForm_CreateFolderForm","_input","click","IIIFSourceForm_IIIFSourceForm","Array","from","onUploadFiles","onShowOptions","c","multiple","display","onSelectOption","ViewListItem","current","ViewList","Views_ViewListItem","currentView","onChangeView","Storage","dataAvailable","storage","quota","quota_mb","used","used_mb","number_format_default","displayType","thousandSeparator","Sidebar","collaborators","handleCreateFromSource","Account_Account","CreateNew_CreateNew","Views_ViewList","Storage_Storage","ActivityWidget","fill","stats","CollaboratorList","username","App","table_columns","table_sorting","busy","total_docs","fileUploads","urlUpload","announcement","StoredUIState","load","_root","getElementById","onhashchange","changeFolder","querySelector","fetchAccountData","refreshCurrentView","latestAnnouncement","columns","Columns","expandAggregatedColumns","sort","accountData","myDocuments","getDisplayConfig","items","sharedWithMe","save","fetchMyDocuments","fetchSharedWithMe","before","p","sorting","folder","_this9","renameFolder","updateReadme","deleteReadme","_this10","_this11","_this12","isUploading","Sidebar_Sidebar","startUpload","changeView","startRegisterRemoteSource","Header_Header","setBusy","togglePresentation","createReadme","TablePane","disableFiledrop","onSort","onSortTable","onDropFiles","onDropURL","onChangeColumnPrefs","onRenameFolder","Readme","onUpdate","onUpdateReadme","onDeleteReadme","GridPane","Uploader_Uploader","Announcement_BasePopupForm","e","render","App_App"],"mappings":"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","file":"static/js/workspace.886d70aa.chunk.js","sourcesContent":["import axios from 'axios';\n\nconst fetchDocuments = (path, config) => {\n  return axios.post(`/api/directory/${path}`, config);\n};\n\nexport default class API {\n\n  static accountData() {\n    return axios.get('/api/account/my');\n  }\n\n  static myDocuments(config, opt_folder) {\n    return opt_folder ?\n      fetchDocuments(`my/${opt_folder}`, config) : fetchDocuments('my', config);\n  }\n\n  static sharedWithMe(config) {\n    return fetchDocuments('my/shared', config);\n  }\n\n  // ~~~ Service announcement\n  static latestAnnouncement() {\n    return axios.get('/api/announcements/my/latest');\n  }\n\n  static confirmAnnouncement(uuid) {\n    return axios.put(`/api/announcements/${uuid}`);\n  }\n\n  // ~~~ Folder actions ~~~\n  static createFolder(title, parentId) {\n    return axios.post('/api/folder', {\n      title: title,\n      parent: parentId\n    });\n  }\n\n  static renameFolder(id, title) {\n    return axios.put(`/api/folder/${id}?title=${title}`);\n  }\n\n  static deleteFolder(id) {\n    return axios.delete(`/api/folder/${id}`);\n  }\n\n  // ~~~ Document actions ~~~\n  static bulkDeleteFolders(ids) {\n    return axios.delete(`/api/folder/bulk`, { data: ids });\n  }\n\n  // Deletes one document via the API\n  static deleteDocument(id) {\n    return axios.delete(`/api/document/${id}`);\n  }\n\n  // Deletes multiple documents in one go via the bulk API\n  static bulkDeleteDocuments(ids) {\n    return axios.delete('/api/document/bulk', { data: ids });\n  }\n\n  static unshareDocument(id) {\n    return axios.delete(`/api/shared/document/${id}`);\n  }\n\n  static bulkUnshareDocuments(ids) {\n    return axios.delete('/api/shared/document/bulk', { data: ids });\n  }\n\n  // ~~~ Readme actions ~~~\n  static updateReadme(content, opt_folder_id) {\n    if (opt_folder_id)\n      return axios.post(`/api/folder/${opt_folder_id}/readme`, { data: content });\n    else\n      return axios.post('/api/directory/my/readme', { data: content });\n  }\n\n  static deleteReadme(opt_folder_id) {\n    if (opt_folder_id)\n      return axios.delete(`/api/folder/${opt_folder_id}/readme`);\n    else\n      return axios.delete('/api/directory/my/readme');\n  }\n\n}","import React, { Component } from 'react';\nimport ReactMarkdown from 'react-markdown';\n\nimport API from './API.js';\nimport Modal from '../common/components/Modal.jsx';\n\nexport default class BasePopupForm extends Component {\n\n  handleOk = () => {\n    // TODO confirm via API\n    API.confirmAnnouncement(this.props.id).then(() => {\n      this.props.onClose();\n    });\n  }\n\n  render() {\n    console.log(this.props.id);\n    return (\n      <Modal \n        title=\"A Message from Recogito\" \n        className=\"announcement\"\n        onClose={this.props.onClose}>\n\n        <div className=\"content\">\n          <ReactMarkdown source={this.props.message} />\n        </div>\n\n        <div className=\"buttons\">\n          <button\n            className=\"btn \"\n            onClick={this.handleOk}>Got it, thanks!</button>\n        </div>\n      </Modal>\n    )\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class Meter extends Component {\n\n  render() {\n    return (\n      <div\n        className=\"meter\"\n        style={{ position: 'relative' }}>\n\n        <div\n          className=\"bar\"\n          style={{\n            width: `${100 * this.props.value}%`,\n            height: '100%'\n          }} />\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\n\nimport Meter from '../../components/Meter.jsx';\n\nexport default class Uploader extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = this._emptyState(props);\n    this.start();\n  }\n\n  _emptyState(props) {\n    return {\n      files: props.files,\n      remoteSource: props.url,\n      phase: 'Uploading',\n      totalSize: props.files.reduce((total, f) => total + f.size, 0),\n      filepartIds: (props.files.length > 0) ? props.files.map(() => null) : [ null ],\n      uploadId: null,\n      uploadStatus: (props.files.length > 0) ? props.files.map(() => 'UPLOADING') : [ 'UPLOADING'],\n      progress: (props.files.length > 0) ? props.files.map(() => 0) : [ 0 ],\n      errors: []\n    };\n  }\n\n  componentWillReceiveProps(next) {\n    if (this.props.files === next.files && this.props.url === next.url)\n      return;\n\n    this.setState(this._emptyState(next), () => this.start());\n  }\n\n  /** \n   * Starts a new upload.\n   * \n   * Since one document generally consists of multiple files, the \n   * upload process is multi-stage: \n   * \n   * - first, the new document is initialized, and assigned an ID on the server\n   * - then, all files are uploaded to this document\n   * - finally, a finalization requests closes the document, and waits for any\n   *   processing (image tiling, TEI conversion) to finish\n   */\n  start() {\n    this.initNewDocument()\n      .then((result) => { \n        this.setState({ uploadId: result.data.id });\n\n        // Branch based on files vs. remote URL\n        if (this.state.files.length > 0)\n          return this.uploadFiles() \n        else if (this.state.remoteSource)\n          return this.registerURL()\n      })\n      .catch(error => {\n        this.setState(prev => {\n          const errors = prev.errors.slice(0);\n          errors.push(error.response.data);\n          return { errors: errors };\n        });\n      })\n      .then(this.finalizeDocument.bind(this));\n  }\n\n  /**\n   * Initializes a new document, using the filename as title,\n   * or a 'New document' placeholder in case there are multiple files.\n   */\n  initNewDocument() {\n    const title = (this.state.files.length === 1) ? this.state.files[0].name : 'New document';\n    const formdata = new FormData();\n    formdata.append('title', title);\n\n    return axios.post('/my/upload', formdata, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    });\n  }\n\n  registerURL() {\n    this.setState({ phase: 'Importing' });\n\n    const formdata = new FormData();\n    formdata.append('url', this.state.remoteSource);\n\n    return axios.post(`/my/upload/${this.state.uploadId}/file`, formdata, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    });\n  }\n\n  /**\n   * Uploads the files in parallel.\n   */\n  uploadFiles() {\n    // Helper: handles upload for one file\n    const uploadOne = (file, idx) => {\n      const formdata = new FormData();\n      formdata.append('file', file);\n\n      const onUploadProgress = (evt) => {\n        const progress = this.state.progress.slice(0); // Clone progress array\n        progress[idx] = evt.loaded;\n        this.setState({ progress: progress });\n      }\n\n      return axios.post(`/my/upload/${this.state.uploadId}/file`, formdata, {\n        headers: { 'X-Requested-With': 'XMLHttpRequest' },\n        onUploadProgress: onUploadProgress\n      }).then(result => {\n        this.setState(prev => {\n          const filepartIds = prev.filepartIds.slice(0);\n          filepartIds[idx] = result.data.uuid;\n          return { filepartIds: filepartIds };\n        });\n\n        return result;\n      }).catch(error => {\n        this.setState(prev => {\n          const uploadStatus = prev.uploadStatus.slice(0);\n          uploadStatus[idx] = 'FAILED';\n\n          const errors = prev.errors.slice(0);\n          errors.push(error.response.data);\n\n          return { \n            uploadStatus: uploadStatus,\n            errors: errors \n          };\n        });\n      });\n    }\n    \n    // The list of request promises...\n    const requests = this.state.files.map((file, idx) => uploadOne(file, idx));\n\n    // ... rolled into a promise of the list of request results\n    return Promise.all(requests);\n  }\n\n  /**\n   * Finalizes the upload, creating the document and starting processing tasks (if any)\n   */\n  finalizeDocument()  {\n    const currentFolder = document.location.hash.substring(1);\n\n    const url = currentFolder ?\n      `/my/upload/${this.state.uploadId}/finalize?folder=${currentFolder}` :\n      `/my/upload/${this.state.uploadId}/finalize`;\n\n    return axios.post(url, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    }).then(result => {\n      const tasks = result.data.running_tasks;\n      if (tasks.length > 0) {\n        this.setState({ phase: 'Importing...' });\n        this.pollTaskProgress(result.data.document_id, tasks);\n      } else {\n        this.props.onUploadComplete();\n      }\n    }).catch(error => {\n      // console.log('Upload contained errors');\n    });\n  }\n\n  updateStatusForFile(filepartId, pollResult) {\n    const progress = pollResult.subtasks.find(t => t.filepart_id === filepartId);\n    const idx = this.state.filepartIds.indexOf(filepartId);\n\n    const setUploadStatus = (value) => {\n      this.setState(prev => {\n        const uploadStatus = prev.uploadStatus.slice(0);\n        uploadStatus[idx] = value;\n        return { uploadStatus: uploadStatus };\n      })\n    }\n\n    if (progress)\n      setUploadStatus(progress.status);\n    else // No task running for this file - complete\n      setUploadStatus('COMPLETED');\n  }\n\n  /**\n   * Polls import task progress\n   */\n  pollTaskProgress(documentId, taskTypes) {    \n    axios.get(`/api/job?id=${documentId}`)\n      .then(result => {\n        // Update status per file\n        this.state.filepartIds.map(id => this.updateStatusForFile(id, result.data));\n        const isDone = result.data.status === 'COMPLETED' || result.data.status === 'FAILED';\n        if (isDone)\n          this.props.onUploadComplete()\n        else\n          setTimeout(() => this.pollTaskProgress(documentId, taskTypes), 1000);\n      })\n      .catch(error => {\n        if (error.response.status === 404)\n          // Tasks might still be initializing\n          setTimeout(() => this.pollTaskProgress(documentId, taskTypes), 1000);\n      });\n  }\n\n  isUploadComplete() {\n    return this.state.uploadStatus\n      .reduce((complete, next) => complete && (next === 'COMPLETED' || next === 'FAILED'));\n  }\n\n  onCancel(evt) {\n    if (this.isUploadComplete())\n      this.props.onUploadComplete();\n  }\n\n  render() {\n    const totalLoaded = this.state.progress.reduce((total, next) => total + next, 0);\n\n    return (\n      <div className=\"upload-progress\">\n        <div className=\"phase\">\n          {this.state.phase}\n          <button \n            className=\"close nostyle\"\n            onClick={this.onCancel.bind(this)}>&#xe897;</button>\n        </div>\n        <ul className={`files${(this.state.errors.length > 0) ? ' has-errors' : ''}`}>\n          {this.state.files.map((f, idx) =>\n            <li key={idx}>\n              {f.name}\n              <span className={`icon spinner ${this.state.uploadStatus[idx]}`}></span>\n            </li>\n          )}\n\n          {this.state.remoteSource &&\n            <li>\n              Fetching content from remote source...\n              <span className=\"icon spinner RUNNING\"></span>\n            </li>\n          }\n        </ul>\n        {this.state.errors.length > 0 && \n          <ul className=\"errors\">\n            {this.state.errors.map((message, idx) => <li key={idx}>{message}</li>)}\n          </ul>\n        }\n        <div className=\"progress\">\n          <Meter value={totalLoaded / this.state.totalSize} />\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class AdvancedSearch extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.onMousedown = this.onMousedown.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.onMousedown, false);\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMousedown, false);\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onMousedown(evt) {\n    const isClickOutside = !this._node.contains(evt.target);\n    const isClickOnToggle = evt.target.classList.contains('advanced');\n    if (isClickOutside && !isClickOnToggle) this.props.onClose();\n  }\n\n  onKeydown(evt) {\n    if (evt.which === 27) this.props.onClose();\n  }\n\n  render() {\n    return (\n      <div\n        ref={n => this._node = n}\n        className=\"advanced-search\">\n        <button\n          className=\"close nostyle\"\n          onClick={this.props.onClose}>&#xe897;</button>\n\n        <form>\n          <fieldset>\n            <p>\n              <label>Search in</label>\n              <select>\n                <option>All of Recogito</option>\n                <option>My documents</option>\n                <option>Shared with me</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Document type</label>\n              <select>\n                <option>Any</option>\n                <option>Text</option>\n                <option>Image</option>\n                <option>Table</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Owner</label>\n              <select>\n                <option>Anyone</option>\n                <option>me</option>\n                <option>specific user</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Metadata contains</label>\n              <input type=\"text\" />\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Last modified</label>\n              <select>\n                <option>Any time</option>\n                <option>this week</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n          </fieldset>\n          <fieldset className=\"buttons\">\n            <button className=\"nostyle clear\">Clear</button>\n            <button type=\"submit\" className=\"btn\">Search</button>\n          </fieldset>\n        </form>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nimport AdvancedSearch from './AdvancedSearch.jsx';\n\nexport default class Search extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { advancedSearchOpen: false }\n  }\n\n  toggleAdvancedSearch() {\n    this.setState(prev => (\n      { advancedSearchOpen: !prev.advancedSearchOpen }\n    ));\n  }\n\n  render() {\n    return (\n      <div className=\"wrapper\">\n        <div className=\"search\">\n          <div className=\"wrapper\">\n            <input placeholder=\"Search Recogito...\"/>\n            {/* <button\n              className=\"icon nostyle advanced\"\n            onClick={this.toggleAdvancedSearch.bind(this)}>{'\\ue688'}</button> */}\n          </div>\n          <span className=\"icon hand-lens\">&#xf002;</span>\n        </div>\n        {this.state.advancedSearchOpen &&\n          <AdvancedSearch onClose={this.toggleAdvancedSearch.bind(this)}/>\n        }\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class MenuPopup extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.onMousedown = this.onMousedown.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.onMousedown, false);\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMousedown, false);\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onMousedown(evt) {\n    const isClickOutside = !this._node.contains(evt.target);\n    if (isClickOutside) this.props.onCancel();\n  }\n\n  onKeydown(evt) {\n    if (evt.which === 27) this.props.onCancel();\n  }\n\n  render() {\n    return (\n      <div\n        ref={n => this._node = n}\n        className={`modal-menu ${this.props.className}`}>\n        <ul>\n          {this.props.menu.map(group =>\n            <li\n              key={group.group}\n              className={`group ${group.group}`}>\n\n              <ul>\n                {group.options.map(option =>\n                  <li\n                    key={option.value || option.link}\n                    className={`option${option.disabled ? ' disabled' : '' }`}\n                    onClick={(option.disabled || !option.value) ? null : this.props.onSelect.bind(this, option.value) }>\n\n                    {(option.link) ? \n                      <a href={option.link}>\n                        <span className=\"icon\">{option.icon}</span> {option.label}\n                      </a>\n                      : \n                      <span>\n                        {option.icon && <span className=\"icon\">{option.icon}</span>} {option.label}\n                      </span>\n                    }\n                  </li>\n                )}\n              </ul>\n            </li>\n          )}\n        </ul>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport Draggable from 'react-draggable';\n\nexport default class Prompt extends Component {\n\n  constructor(props) {\n    super(props);\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  /** Clear selection on ESC **/\n  onKeydown(evt) {\n    if (evt.which === 27) this.props.onNo();\n  }\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  render() {\n    const className = (this.props.type) ? `prompt ${this.props.type.toLowerCase()}` : 'prompt';\n\n    return (\n      <div className=\"clicktrap\">\n        <Draggable handle=\".prompt-header\">\n          <div className={className}>\n            <div className=\"prompt-header\">\n              <h1 className=\"title\">{this.props.title}</h1>\n            </div>\n\n            <div className=\"prompt-body\">\n              <p className=\"message\">{this.props.message}</p>\n              <p className=\"buttons\">\n                 <button className=\"btn yes\" onClick={this.props.onYes}>YES</button>\n                 <button className=\"btn outline no\" onClick={this.props.onNo}>NO</button>\n              </p>\n            </div>\n          </div>\n        </Draggable>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport API from '../API.js';\nimport Prompt from '../../common/components/Prompt.jsx';\n\nexport default class DeleteAction extends Component {\n\n  deleteFolders(folders) {\n    const ids = folders.map(f => f.id);\n    if (ids.length > 0) {\n      return ids.length === 1 ?\n        API.deleteFolder(ids[0]) : API.bulkDeleteFolders(ids);\n    } else {\n      return new Promise((resolve) => { resolve(); });\n    }\n  }\n\n  deleteDocuments(documents) {\n    const ids = documents.map(d => d.id);\n\n    if (ids.length > 0) {\n      return ids.length === 1 ? (\n        this.props.view === 'MY_DOCUMENTS' ?\n          API.deleteDocument(ids[0]) : API.unshareDocument(ids[0]) \n      ) : (\n        this.props.view === 'MY_DOCUMENTS' ?\n          API.bulkDeleteDocuments(ids) : API.bulkUnshareDocuments(ids)\n      )\n    } else {\n      return new Promise((resolve) => { resolve(); });\n    }\n  }\n\n  executeDelete() {\n    const folders = this.props.selection.filter(i => i.type === 'FOLDER');\n    const documents = this.props.selection.filter(i => i.type === 'DOCUMENT');\n\n    if (folders.length + documents.length > 0) {\n      this.props.onStart();\n\n      this.deleteDocuments(documents)\n          .then(() => this.deleteFolders(folders))\n          .then(() => {\n            this.props.onSuccess();\n          }).catch((error) => {\n            this.props.onError(error);\n          });\n    } else {\n      this.props.onCancel();\n    }\n  }\n\n  render() {\n    const message = (this.props.view === 'MY_DOCUMENTS') ?\n      \"You are about to permanently delete the selected documents. Are you sure?\" :\n      \"This will remove the selected documents from your shared documents list. Are you sure?\";\n\n    return ReactDOM.createPortal(\n      <Prompt \n        title=\"Delete\"\n        type=\"WARNING\"\n        message={message}\n        onNo={this.props.onCancel}\n        onYes={this.executeDelete.bind(this)} />,\n\n      document.body\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport axios from 'axios';\n\nimport Meter from '../../components/Meter.jsx';\n\nexport default class JobProgress extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      status: 'PENDING',\n      progress: 0, // 0 - 100\n      tasks: 0,\n      tasksCompleted: 0\n    };\n\n    this.pollProgress();\n  }\n\n  pollProgress() { \n    axios.get(`/api/job/${this.props.jobId}`)\n      .then(result => {\n        this.setState({\n          status: result.data.status,\n          progress: result.data.progress,\n          tasks: result.data.subtasks.length,\n          tasksCompleted: result.data.subtasks.filter(t => t.status === 'COMPLETED').length,\n          tasksFailed: result.data.subtasks.filter(t => t.status === 'FAILED').length\n        });\n\n        const isDone = result.data.status === 'COMPLETED' || result.data.status === 'FAILED';\n        if (isDone)\n          this.props.onComplete && this.props.onComplete();\n        else\n          setTimeout(() => this.pollProgress(), 1000);\n      })\n      .catch(error => {\n        if (error.response.status === 404)\n          // Tasks might still be initializing\n          setTimeout(() => this.pollProgress(), 1000);\n      });\n  }\n\n  handleClose = () => {\n    this.props.onClose && this.props.onClose();\n  }\n\n  render() {\n    const isDone = \n      this.state.status === 'COMPLETED' || \n      this.state.status === 'FAILED';\n\n    const labelCompleted = this.props.labelCompleted || 'Completed';\n    const labelTasks = this.props.labelTasks || 'tasks';\n\n    return ReactDOM.createPortal(\n      <div className=\"job-progress\">\n        <div className=\"header\">\n          {this.props.title}\n          {isDone && <button \n            className=\"close nostyle\"\n            onClick={this.handleClose}>&#xe897;</button>\n          }\n        </div>\n\n        <div className=\"body\">\n          <div className=\"message\">\n            {labelCompleted} {this.state.tasksCompleted} of {this.state.tasks} {labelTasks}\n            <span className={`icon spinner ${this.state.status}`}></span>\n          </div>\n\n          <div className=\"progress\">\n            <Meter value={this.state.progress / 100} />\n          </div>\n        </div>\n      </div>,\n      document.body\n    )\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class AuthoritySelection extends Component {\n\n  onChange(identifier) {   \n    const selection = this.props.selected; \n    const currentIdx = selection.indexOf(identifier);\n\n    if (currentIdx < 0)\n      selection.push(identifier);\n    else\n      selection.splice(currentIdx, 1); \n\n    this.props.onChange(selection);\n  }\n\n  render() {    \n    return (\n      <div className=\"authorities\">\n        <h2>Authority Files</h2>\n\n        <input\n          type=\"checkbox\" \n          id=\"use-all-authorities\"\n          checked={this.props.useAll} \n          onChange={this.props.onToggleAll} />\n        <label htmlFor=\"use-all-authorities\">identify entities against all available authority files</label>\n\n        <div className={`authority-list${this.props.useAll ? ' disabled' : ''}`}>\n          <table>\n            <tbody>\n              {this.props.authorities.map(authority => \n                <tr key={authority.identifier}>\n                  <td>\n                    <input \n                      type=\"checkbox\" \n                      id={authority.identifier} \n                      checked={this.props.selected.includes(authority.identifier)} \n                      onChange={this.onChange.bind(this, authority.identifier)} />\n                    <label htmlFor={authority.identifier} />\n                  </td>\n\n                  <td className=\"shortname\">\n                    <span style={{ backgroundColor: authority.color}}>\n                      {authority.homepage ? \n                        <a href={authority.homepage} \n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\">{authority.shortname}</a>\n                        : \n                        authority.shortname\n                      }\n                    </span>\n                  </td>\n\n                  <td className=\"fullname\">\n                    {authority.fullname}\n                  </td>\n                </tr>\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class EngineSelection extends Component {\n\n  render() {\n    return (\n      <div className=\"engines\">\n        <h2>Recognition Engines</h2>\n        <table cellSpacing=\"0\">\n          <tbody>\n            {this.props.engines.map((engine, idx) =>\n              <React.Fragment key={idx}>\n                <tr>\n                  <td className=\"name\">\n                    <input \n                      id={engine.identifier}\n                      type=\"radio\" \n                      group=\"engines\" \n                      checked={this.props.selected === engine.identifier}\n                      onChange={this.props.onChange.bind(this, engine.identifier)} />\n                    \n                    <label htmlFor={engine.identifier}>\n                      <span className=\"name\">{engine.name}</span>\n                    </label>\n                  </td>\n\n                  <td className=\"languages\">\n                    { engine.languages.map(lang => <span key={lang}>{lang}</span>) }\n                  </td>\n\n                  <td className=\"description\">\n                    {engine.description}\n                  </td>\n                </tr>\n                \n                <tr className=\"spacer\"></tr>\n              </React.Fragment>\n            )}\n          </tbody>\n        </table>\n        <p className=\"note\">\n          Note: different engines can provide different results and are generally \n          optimized for a specific language.\n        </p>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\n\nimport Modal from '../../components/Modal.jsx';\nimport AuthoritySelection from './authorities/AuthoritySelection.jsx';\nimport EngineSelection from './engines/EngineSelection.jsx';\n\nexport default class NERModal extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      available_engines: [],\n      available_authorities: [],\n\n      selected_engine: null,\n      selected_all_authorities: true,\n      selected_authorities: []\n    };\n\n    this.initAvailableAuthorities();\n    this.initAvailableEngines();\n  }\n\n  isInitComplete() {\n    return this.state.available_engines.length > 0 &&\n      this.state.available_authorities.length > 0;\n  }\n\n  initAvailableEngines() {\n    if (this.state.available_engines.length === 0)\n      axios.get('/api/plugins/ner')\n        .then(result => {\n          const diff = { available_engines: result.data };\n\n          if (!this.state.selected_engine) // Select first as default\n            diff.selected_engine = result.data[0] && result.data[0].identifier;\n\n          this.setState(diff);\n        });\n  }\n\n  initAvailableAuthorities() {\n    axios.get('/api/authorities/gazetteers')\n      .then(result => {\n        const diff = { available_authorities: result.data };\n\n        if (this.state.selected_all_authorities || \n             (!this.state.selected_all_authorities && this.state.selected_authorities.length === 0))\n          diff.selected_authorities = result.data.map(a => a.identifier);\n\n        this.setState(diff);\n      });\n  }\n\n  changeEngine(identifier) {\n    this.setState({ selected_engine: identifier });\n  }\n\n  toggleAllAuthorities() {\n    this.setState(prev => {\n      return { selected_all_authorities: !prev.selected_all_authorities }\n    });\n  }\n\n  changeAuthorities(authorities) {\n    this.setState({ selected_authorities: authorities });\n  }\n\n  onStart() {\n    const response = { engine: this.state.selected_engine };\n\n    if (this.state.selected_all_authorities)\n      response.all_authorities = true;\n    else \n      response.authorities = this.state.selected_authorities;\n\n    this.props.onStart(response);\n  }\n\n  render() {\n    return (\n      <Modal\n        className=\"ner\" \n        title=\"Named Entity Recognition (NER)\"\n        onClose={this.props.onCancel}>\n\n        <p>\n          NER identifies places and persons in your text automatically. \n          Depending on the length of your text, this may take a while. \n        </p>\n\n        <EngineSelection \n          engines={this.state.available_engines} \n          selected={this.state.selected_engine}\n          onChange={this.changeEngine.bind(this)} />\n\n        <AuthoritySelection \n          authorities={this.state.available_authorities} \n          useAll={this.state.selected_all_authorities}\n          selected={this.state.selected_authorities}\n          onToggleAll={this.toggleAllAuthorities.bind(this)} \n          onChange={this.changeAuthorities.bind(this)} />\n\n        <div className=\"buttons\">\n          <button\n            className=\"btn start\"\n            onClick={this.onStart.bind(this)}>Start NER</button>\n\n          <button \n            className=\"btn outline cancel\"\n            onClick={this.props.onCancel}>Cancel</button>\n        </div>\n      </Modal>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport axios from 'axios';\n\nimport JobProgress from '../../common/content/job/JobProgress.jsx';\nimport NERModal from '../../common/content/ner/NERModal.jsx';\n\nexport default class NERAction extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { running: false };\n  }\n\n  startNER = (config) => {\n    const documents = this.props.selection.filter(d => {\n      const isDocument = d.type === 'DOCUMENT'\n      const hasTextParts = d.filetypes.filter(t => t.startsWith('TEXT_')).length > 0;\n      return isDocument && hasTextParts\n    });\n\n    const taskDefinition = Object.assign(\n      { task_type: 'NER', documents: documents.map(d => d.id) }, \n      config\n    );\n\n    axios.post('/api/job', taskDefinition)\n      .then(response => {\n        this.setState({\n          running: true,\n          jobId: response.data.job_id\n        });\n      });\n  }\n\n  handleCompleted = () => {\n    this.props.onComplete && this.props.onComplete();\n  }\n\n  render() {\n    if (this.state.running) {\n      return <JobProgress \n        title=\"Named Entity Recognition\"\n        jobId={this.state.jobId} \n        onComplete={this.handleCompleted}\n        onClose={this.props.onClose}\n        labelCompleted=\"Parsed\"\n        labelTasks=\"files\" />\n    } else {\n      return ReactDOM.createPortal(\n        <NERModal \n          onStart={this.startNER}\n          onCancel={this.props.onCancel} />, \n        document.body\n      )\n    }\n  }\n\n}\n","import React, { Component } from 'react';\nimport { CSSTransition } from 'react-transition-group';\n\nimport Search from './search/Search.jsx';\nimport HeaderIcon from '../../common/content/HeaderIcon.jsx';\nimport Selection from '../../common/content/Selection.js';\nimport Breadcrumbs from '../../common/content/Breadcrumbs.jsx';\nimport MenuPopup from '../../common/components/MenuPopup.jsx';\nimport DeleteAction from '../actions/DeleteAction.jsx';\nimport NERAction from '../actions/NERAction.jsx';\n\nexport default class Header extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      action: null,\n      menuVisible: false\n    };\n\n    document.body.addEventListener('keydown', this.onKeydown.bind(this), false);\n  }\n\n  onKeydown(evt) {\n    if (this.props.selection.length > 0 && evt.which === 46)\n      this.startDeleteAction();\n  }\n\n  /** User clicked the DELETE button in the mini-menu */\n  startDeleteAction() {\n    const deleteAction =\n      <DeleteAction\n        view={this.props.view}\n        selection={this.props.selection}\n        onStart={this.props.onDelete}\n        onSuccess={this.onDeleteSuccess.bind(this)}\n        onError={this.onDeleteError.bind(this)}\n        onCancel={this.cancelAction.bind(this)} />\n\n    this.setState({ action: deleteAction });\n  }\n\n  /** User clicked CANCEL in the warning prompt **/\n  cancelAction() {\n    this.setState({ action: null });\n  }\n\n  /** Delete executed successfully **/\n  onDeleteSuccess() {\n    this.setState({ action: null }, () => {\n      this.props.afterAction();\n    });\n  }\n\n  onDeleteError(error) {\n    this.setState({ action: null }, () => {\n      this.props.afterAction(); // TODO error message\n    });\n  }\n\n  handleNERComplete() {\n    setTimeout(() => this.props.afterAction(), 500);\n  }\n\n  showActionsMenu() {\n    this.setState({ menuVisible: true });\n  }\n\n  actionStarted(jobId) {\n    this.setState({ action: null });\n  }\n\n  onSelectMenuOption(option) { \n    this.setState({ menuVisible: false });\n\n    const firstSelected = this.props.selection[0];\n\n    if (option === 'OPEN') {\n      if (Selection.isSingleDocument(this.props.selection)) \n        window.location.href= `document/${firstSelected.id}/part/1/edit`;\n      else if (Selection.isSingleFolder(this.props.selection))\n        window.location.hash = firstSelected.id;\n    } else if (option === 'OPEN_TAB') {\n      if (Selection.isSingleDocument(this.props.selection)) \n        window.open(`document/${firstSelected.id}/part/1/edit`, '_blank');\n    } else if (option === 'DELETE') {\n      this.startDeleteAction();\n    } else if (option === 'NER') {\n      this.setState({ action: \n        <NERAction\n          selection={this.props.selection}\n          onStarted={this.actionStarted.bind(this)}\n          onComplete={this.handleNERComplete.bind(this)}\n          onCancel={this.cancelAction.bind(this)} \n          onClose={this.cancelAction.bind(this)} /> \n      });\n    }\n  }\n\n  onCancelMenu() {\n    this.setState({ menuVisible: false });\n  }\n\n  render() {\n    const isOpen = this.props.selection.length > 0;\n\n    return (\n      <div className={this.props.readme ? \"header\" : \"header no-readme\"}>\n        <div className=\"top-row\">\n          <Search/>\n          <div className=\"header-icons\">\n            <HeaderIcon icon=\"&#xe64a;\" className=\"help stroke7\" link=\"/help\" />\n            {/* <HeaderIcon icon=\"&#xe8ae;\" className=\"stats\" />\n            <HeaderIcon icon=\"&#xe8c1;\" className=\"notifications\" /> */}\n          </div>\n        </div>\n        <div className=\"subheader\">\n          <Breadcrumbs \n            view={this.props.view}\n            path={this.props.breadcrumbs}\n            count={this.props.docCount}>\n\n            {!this.props.readme && this.props.view === 'MY_DOCUMENTS' &&\n              <button \n                className=\"add-abstract nostyle\"\n                onClick={this.props.onCreateReadme} >\n                <span className=\"icon\">&#xf055;</span>\n                <span className=\"label\">Add a description...</span>\n              </button>\n            }\n          </Breadcrumbs>\n\n          <div className=\"subheader-icons\">\n            <CSSTransition\n              in={isOpen} \n              timeout={500} \n              classNames=\"selection-actions\">\n\n              <div \n                className=\"selection-actions\"\n                onClick={this.showActionsMenu.bind(this)}>              \n                <span className=\"label\">Options</span>\n                <span className=\"more icon\">&#xf078;</span>\n              </div>\n            </CSSTransition>\n\n            {this.state.menuVisible &&\n              <MenuPopup\n                className=\"selection-actions-menu\"\n                menu={[\n                  { group: 'open', options: [\n                    { label: 'Open', value: 'OPEN', disabled: !Selection.isSingleSelection(this.props.selection) },\n                    { label: 'Open in new tab', value: 'OPEN_TAB', disabled: !Selection.isSingleDocument(this.props.selection) }\n                  ]},\n                  { group: 'file-ops', options: [\n                    { icon: '\\uf114', label: 'Move to', value: 'MOVE_TO', disabled: true },\n                    { icon: '\\uf0c5', label: 'Duplicate', value: 'DUPLICATE', disabled: true },\n                    { icon: '\\uf014', label: 'Delete', value: 'DELETE' }\n                  ]},\n                  { group: 'jobs', options: [\n                    { \n                      icon: '\\uf085', \n                      label: 'Named Entity Recognition', \n                      value: 'NER', \n                      disabled: !Selection.includesText(this.props.selection) \n                    }\n                  ]}\n                ]} \n                onSelect={this.onSelectMenuOption.bind(this)}\n                onCancel={this.onCancelMenu.bind(this)} />\n            }\n\n            <HeaderIcon\n              className=\"presentation-toggle stroke7\"\n              icon={(this.props.presentation === 'TABLE') ? '\\ue645' : '\\ue636'} \n              onClick={this.props.onTogglePresentation} />\n\n            {this.state.action}\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nimport ProfileInfo from '../../../common/content/profile/ProfileInfo.jsx';\nimport MenuPopup from '../../../common/components/MenuPopup.jsx';\n\nexport default class Account extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { menuVisible: false };\n  }\n\n  onSelectMenuOption(option) {\n    if (option === 'SETTINGS')\n      window.location.href= '/settings/account';\n    else if (option === 'SIGNOUT')\n      window.location.href= '/logout';\n    else if (option === 'HELP');\n      window.location.href= '/help';\n  }\n\n  showMenu() {\n    this.setState({ menuVisible: true });\n  }\n\n  closeMenu() {\n    this.setState({ menuVisible: false });\n  }\n\n  render() {\n    return (\n      <div\n        className=\"section account\"\n        onClick={this.showMenu.bind(this)} >\n\n        <ProfileInfo account={this.props.account} />\n\n        { this.state.menuVisible &&\n          <MenuPopup\n            className=\"account-menu\"\n            menu={[\n              { group: 'settings', options: [\n                { icon: '\\uf0ad', label: 'Account settings', link: '/settings/account' }\n              ]},\n              { group: 'general', options: [\n                { icon: '\\uf128', label: 'Help', link: '/help' },\n                { icon: '\\uf011', label: 'Sign out', link: '/logout' }\n              ]}\n            ]}\n            onSelect={this.onSelectMenuOption.bind(this)}\n            onCancel={this.closeMenu.bind(this)} />\n        }\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class BasePopupForm extends Component {\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.handleKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeydown, false);\n  }\n\n  handleKeydown = (evt) => {\n    // Escape key\n    if (evt.which === 27) this.handleCancel();\n  }\n\n  handleOk = () => {\n    this.props.onOk && this.props.onOk();\n  }\n\n  handleCancel = () => {\n    this.props.onCancel && this.props.onCancel();    \n  }\n\n  render() {\n    return (\n      <div className={`clicktrap ${this.props.className}`}>\n        <div\n          className={`modal-wrapper popup-form ${this.props.className}`}>\n          <div className=\"modal\">\n            <div className=\"modal-body\">\n              <div className=\"form-body\">\n                {this.props.children}\n              </div>\n\n              <div className=\"buttons\">\n                <button \n                  className=\"btn outline tiny\"\n                  onClick={this.handleCancel}>Cancel</button>\n\n                <button\n                  className=\"btn tiny\"\n                  onClick={this.handleOk}>Ok</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport BasePopupForm from './BasePopupForm.jsx';\n\nexport default class CreateFolderForm extends Component {\n\n  state = { folderName: null }\n  \n  handleChange = (evt) => {\n    this.setState({ folderName: evt.target.value });\n  }\n\n  handleOk = () => {\n    this.props.onSubmit && this.props.onSubmit({\n      type: 'NEW_FOLDER',\n      name: this.state.folderName\n    });    \n  }\n\n  handleKeyPress = (evt) => {\n    if (evt.which === 13) // Enter\n      this.handleOk();\n  }\n\n  render() {\n    const popup =\n      <BasePopupForm\n        onOk={this.handleOk}\n        onCancel={this.props.onCancel}>\n        <input \n          type=\"text\" \n          autoFocus={true}\n          placeholder=\"Folder name\"\n          value={this.state.folderName || ''}\n          onChange={this.handleChange} \n          onKeyPress={this.handleKeyPress} />\n      </BasePopupForm>\n\n    return ReactDOM.createPortal(popup, document.body);\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class URLInput extends Component {\n\n  state = {\n    value: this.props.value || ''\n  }\n\n  handleChange = (evt) => {\n    const val = evt.target.value;\n\n    this.setState({ value: val });\n    this.props.onChange && this.props.onChange(val);\n  }\n\n  handleDrop = (evt) => {\n    const url = evt.dataTransfer.getData('text');\n    this.setState({ value: url });\n  }\n\n  handleKeyPress = (evt) => {\n    if (evt.which === 13) // Enter\n      this.props.onSubmit && this.props.onSubmit();\n  }\n\n  render() {\n    const placeholder = this.props.placeholder || 'Paste or drag URL';\n\n    return (\n      <input \n        type=\"text\" \n        autoFocus={this.props.autofocus}\n        className=\"url-input\"\n        value={this.state.value}\n        placeholder={placeholder} \n        onChange={this.handleChange}\n        onDrop={this.handleDrop}\n        onKeyPress={this.handleKeyPress} />\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport BasePopupForm from './BasePopupForm.jsx';\nimport URLInput from '../../../../common/components/URLInput.jsx';\n\nexport default class IIIFSourceForm extends Component {\n\n  state = { sourceURL: null }\n  \n  handleChange = (value) => {\n    this.setState({ sourceURL: value });\n  }\n\n  handleOk = () => {\n    this.props.onSubmit && this.props.onSubmit({\n      type: 'IIIF_SOURCE',\n      url: this.state.sourceURL\n    });    \n  }\n\n  render() {\n    const popup =\n      <BasePopupForm\n        className=\"iiif\"\n        onOk={this.handleOk}\n        onCancel={this.props.onCancel}>\n\n        <URLInput \n          autofocus={true}\n          placeholder=\"Paste or drag IIIF manifest URL\"\n          onChange={this.handleChange}\n          onSubmit={this.handleOk} />\n      </BasePopupForm>\n\n    return ReactDOM.createPortal(popup, document.body);\n  }\n\n}","import React, { Component } from 'react';\n\nimport API from '../../API.js';\nimport MenuPopup from '../../../common/components/MenuPopup.jsx';\nimport CreateFolderForm from './forms/CreateFolderForm.jsx';\nimport IIIFSourceForm from './forms/IIIFSourceForm.jsx';\n\nexport default class CreateNew extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { \n      menuVisible: false,\n      createNewForm: null // Popup form for specifying data source details\n    };\n  }\n\n  onShowOptions() {\n    this.setState({ menuVisible: true });\n  }\n\n  onSelectOption(option) {\n    this.setState({ menuVisible: false });\n    if (option === 'FOLDER') {\n      this.setState({\n        createNewForm: \n          <CreateFolderForm \n            onSubmit={this.handleFormSubmit}\n            onCancel={this.handleFormCancel} />\n      });\n    } else if (option === 'FILE') {\n      this._input.click();\n    } else if (option === 'IIIF') {\n      this.setState({\n        createNewForm:\n          <IIIFSourceForm \n            onSubmit={this.handleFormSubmit} \n            onCancel={this.handleFormCancel} /> \n      });\n    }\n  }\n\n  handleFormSubmit = (value) => {\n    if (value.type === 'IIIF_SOURCE') {\n      this.props.onCreateFromSource && this.props.onCreateFromSource(value);\n    } else if (value.type === 'NEW_FOLDER') {\n      const currentFolderId = document.location.hash.substring(1);\n      API.createFolder(value.name || 'Unnamed Folder', currentFolderId)\n         .then(() => this.props.onFolderCreated());\n    }\n\n    this.setState({ createNewForm: null });\n  }\n\n  handleFormCancel = () => {\n    this.setState({ createNewForm: null });\n  }\n\n  onUploadFiles(evt) {\n    const files = Array.from(evt.target.files);\n    this.props.onUploadFiles(files);\n  }\n\n  onCancel() {\n    this.setState({ menuVisible: false });\n  }\n\n  render() {\n    return (\n      <div className=\"section create-new\">\n        <button\n          className=\"btn create-new\"\n          onClick={this.onShowOptions.bind(this)}>\n          <span className=\"icon\">&#xf067;</span>\n          <span className=\"label\">New</span>\n        </button>\n        <input\n          ref={c => this._input = c}\n          type=\"file\"\n          name=\"file\"\n          multiple\n          onChange={this.onUploadFiles.bind(this)}\n          style={{ display: 'none' }} />\n\n        {this.state.menuVisible &&\n          <MenuPopup\n            className=\"create-new\"\n            menu={[\n              { group: 'local', options: [\n                { icon: '\\uf07b', label: 'Folder', value: 'FOLDER' },\n                { icon: '\\uf15b', label: 'File upload', value: 'FILE' }\n              ]},\n\n              { group: 'remote', options: [\n                { icon: '\\uf0c1', label: 'From IIIF manifest', value: 'IIIF' },\n                { icon: '\\uf121', label: 'From CTS service', value: 'CTS', disabled: true }\n              ]}\n            ]}\n            onSelect={this.onSelectOption.bind(this)}\n            onCancel={this.onCancel.bind(this)} />\n        }\n\n        {this.state.createNewForm}\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nclass ViewListItem extends Component {\n\n  render() {\n    return (\n      <li\n        className={this.props.current ? 'current' : null}\n        onClick={this.props.onClick}>\n        <span className=\"icon\">{this.props.icon}</span> {\n          this.props.children\n        }\n      </li>\n    )\n  }\n\n}\n\nexport default class ViewList extends Component {\n\n  render() {\n    return (\n      <div className=\"section views\">\n        <ul>\n          <ViewListItem\n            icon=\"&#xf2be;\"\n            current={this.props.currentView === 'MY_DOCUMENTS'}\n            onClick={this.props.onChangeView.bind(this, 'MY_DOCUMENTS')}>\n            My Documents\n          </ViewListItem>\n\n          <ViewListItem\n            icon=\"&#xf064;\"\n            current={this.props.currentView === 'SHARED_WITH_ME'}\n            onClick={this.props.onChangeView.bind(this, 'SHARED_WITH_ME')}>\n            Shared with me\n          </ViewListItem>\n\n          {/* <ViewListItem\n            icon=\"&#xf017;\"\n            current={this.props.currentView == 'RECENT'}\n            onClick={this.props.onChangeView.bind(this, 'RECENT')}>\n            Recent\n          </ViewListItem> */}\n        </ul>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport NumberFormat from 'react-number-format';\n\nimport Meter from '../../../common/components/Meter.jsx';\n\nexport default class Storage extends Component {\n\n  render() {\n    const dataAvailable = this.props.account && this.props.account.storage;\n    const quota = dataAvailable ? this.props.account.storage.quota_mb : 0;\n    const used = dataAvailable ? this.props.account.storage.used_mb : 0;\n\n    return (\n      <div className=\"section storage\">\n        <span className=\"icon\">&#xf1c0;</span> Storage\n        <div className=\"used-diskspace\">\n          <Meter\n            value={(quota > 0) ? used / quota : 0} />\n\n          <div className=\"label\">\n            <NumberFormat \n              displayType=\"text\"\n              value={used}\n              thousandSeparator={true} /> \n            {' of  '}\n            <NumberFormat \n              displayType=\"text\"\n              value={quota}\n              thousandSeparator={true} /> MB used\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nimport ActivityWidget from '../../common/content/activity/ActivityWidget.jsx';\nimport CollaboratorList from '../../common/content/profile/CollaboratorList.jsx';\n\nimport Account   from './sections/Account.jsx';\nimport CreateNew from './sections/CreateNew.jsx';\nimport ViewList  from './sections/Views.jsx';\nimport Storage   from './sections/Storage.jsx';\n\nexport default class Sidebar extends Component {\n\n  state = { collaborators: [] };\n\n  handleCreateFromSource = (value) => {\n    if (value.source === 'IIIF') {\n      this.props.onCreateFromSource && this.props.onCreateFromSource(value.url);\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"sidebar\">\n        <Account\n          account={this.props.account} />\n\n        <CreateNew \n          onFolderCreated={this.props.onFolderCreated}\n          onUploadFiles={this.props.onUploadFiles} \n          onCreateFromSource={this.handleCreateFromSource}/>\n          \n        <ViewList\n          account={this.props.account}\n          currentView={this.props.currentView}\n          onChangeView={this.props.onChangeView} />\n\n        <Storage \n          account={this.props.account} /> \n\n        <ActivityWidget \n          className=\"section\" \n          width={237}\n          height={55}\n          fill=\"#4483c4\"\n          stats={this.props.account && this.props.account.stats} />\n\n        <CollaboratorList \n          className=\"section collaborators\"\n          title=\"My top collaborators\"\n          username={this.props.account && this.props.account.username} />\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { render } from 'react-dom';\n\nimport Announcement from  './Announcement.jsx';\nimport API from './API.js';\nimport GridPane from '../common/content/grid/GridPane.jsx';\nimport TablePane from '../common/content/table/TablePane.jsx';\nimport Readme from '../common/content/Readme.jsx';\nimport { Columns } from '../common/content/table/Columns.js';\nimport StoredUIState from '../common/StoredUIState.js';\nimport Uploader from '../common/content/upload/Uploader.jsx';\nimport Header from './header/Header.jsx';\nimport Sidebar from './sidebar/Sidebar.jsx';\n\nimport '../../assets/style/workspace/index.scss';\n\nexport default class App extends Component {\n\n  constructor(props) {\n    super(props);\n\n    const state = {\n      account       : null,           // account info\n      view          : 'MY_DOCUMENTS', // view, as selected in sidebar (My Documents, Shared, Recent)\n      breadcrumbs   : [],             // the current folder (and parent folders) we are in\n      presentation  : 'TABLE',        // presentation mode TABLE or GRID\n      table_columns : [               // current table view columns configuration\n        \"author\",\n        \"title\",\n        \"language\",\n        \"date_freeform\",\n        \"uploaded_at\",\n        \"last_edit_at\"\n      ],\n      table_sorting : null,          // current table sorting (if any)\n      busy          : false,          // Document pane in 'busy' state? (Docs loading, action onging, etc.)\n      folders       : [],             // Folders\n      documents     : [],             // Documents in view\n      total_docs    : null,           // Total number of documents\n      readme        : null,           // Current folder readme\n      selection     : [],             // Selected items (folders and documents)\n      fileUploads   : [],             // Files currently uploading\n      urlUpload     : null,           // URLs currently uploading/registering\n      announcement  : null\n    };\n\n    Object.assign(state, StoredUIState.load());\n    this.state = state;\n\n    this._root = document.getElementById('app');\n\n    this.onKeydown = this.onKeydown.bind(this);\n    this.onMousedown = this.onMousedown.bind(this);\n\n    window.onhashchange = this.changeFolder.bind(this);\n  }\n\n  /** Clear selection on ESC key **/\n  onKeydown(evt) {\n    if (evt.which === 27) this.setState({ selection: [] });\n  }\n\n  /** Clear selection on click ouside the document pane **/\n  onMousedown(evt) {\n    const isClickOutside = !(\n      document.querySelector('.documents-pane').contains(evt.target) ||\n      document.querySelector('.subheader-icons').contains(evt.target)\n    );\n\n    if (isClickOutside) this.setState({ selection: [] });\n  }\n\n  componentDidMount() {\n    this._root.addEventListener('keydown', this.onKeydown, false);\n    this._root.addEventListener('mousedown', this.onMousedown, false);\n\n    this.fetchAccountData();\n    this.refreshCurrentView();\n    \n    API.latestAnnouncement().then(result => {\n      this.setState({ announcement: result.data });\n    })\n  }\n\n  componentWillUnmount() {\n    this._root.removeEventListener('keydown', this.onKeydown, false);\n    this._root.removeEventListener('mousedown', this.onMousedown, false);\n  }\n\n  getDisplayConfig() {\n    if (this.state.presentation === 'GRID')\n      return; // No configs for grid view\n\n    return {\n      columns: Columns.expandAggregatedColumns(this.state.table_columns),\n      sort: this.state.table_sorting\n    };\n  }\n\n  fetchAccountData() {\n    return API.accountData().then(result => { this.setState({ account: result.data }) });\n  }\n\n  fetchMyDocuments() {\n    this.setState({ busy: true });\n    const currentFolderId = document.location.hash.substring(1);\n    return API.myDocuments(this.getDisplayConfig(), currentFolderId).then(result => {\n      this.setState({\n        breadcrumbs: result.data.breadcrumbs,\n        readme: result.data.readme,\n        documents: result.data.items, \n        total_docs: result.data.total,\n        busy: false \n      });\n    });\n  }\n\n  fetchSharedWithMe() {\n    this.setState({ busy: true });\n    return API.sharedWithMe(this.getDisplayConfig()).then(result => { \n      this.setState({\n        breadcrumbs: [],\n        documents: result.data.items, \n        total_docs: result.data.total,\n        busy: false \n      }) \n    });\n  }\n\n  /** Switch between different document views (currently: 'my' vs. 'shared') **/\n  changeView(view) {\n    if (this.state.view !== view) {\n      StoredUIState.save('view', view);\n\n      this.setState({\n        view: view,\n        documents:[]\n      }, () => {\n        (view === 'MY_DOCUMENTS') ? this.fetchMyDocuments() : this.fetchSharedWithMe();\n      });\n    }\n  }\n\n  /** Reloads the current view from the API */\n  refreshCurrentView() {\n    if (this.state.view === 'MY_DOCUMENTS')\n      return this.fetchMyDocuments();\n    else \n      return this.fetchSharedWithMe();\n  }\n\n  changeFolder() {\n    this.setState({ selection: [] });\n    this.refreshCurrentView();\n  }\n\n  /** Toggles the view presentation (table vs. grid) **/\n  togglePresentation() {\n    this.setState(before => { \n      const p = (before.presentation === 'TABLE') ? 'GRID' : 'TABLE';\n      StoredUIState.save('presentation', p);\n      return { presentation: p };\n    });\n  }\n\n  onChangeColumnPrefs(columns) {\n    StoredUIState.save('table_columns', columns);\n    this.setState({ table_columns: columns }, () => {\n      this.refreshCurrentView();\n    });\n  }\n  \n  onSortTable(sorting) {\n    StoredUIState.save('table_sorting', sorting);\n    this.setState({ table_sorting: sorting }, () => {\n      this.refreshCurrentView();\n    });\n  }\n\n  /** File selection **/\n  onSelect(selection) {\n    this.setState({ selection: selection });\n  }\n\n  onRenameFolder(folder, title) {\n    API.renameFolder(folder.id, title)\n       .then(() => this.refreshCurrentView());\n  }\n\n  createReadme() {\n    this.setState({ readme: true });\n  }\n\n  onUpdateReadme(readme) {\n    const currentFolderId = document.location.hash.substring(1);\n    API.updateReadme(readme, currentFolderId)\n       .then(this.setState({ readme: readme }));\n  }\n\n  onDeleteReadme() {\n    const currentFolderId = document.location.hash.substring(1);\n    API.deleteReadme(currentFolderId)\n       .then(this.setState({ readme: null })); \n  }\n\n  /** File upload **/\n  startUpload(files) {\n    this.setState({ \n      fileUploads: files, \n      urlUpload: null\n    });\n  }\n\n  /** Remote file registration (IIIF, CTS) **/\n  startRegisterRemoteSource(url) {\n    this.setState({ \n      fileUploads: [],\n      urlUpload: url\n    });\n  } \n\n  onUploadComplete() {\n    this.setState({ \n      view: 'MY_DOCUMENTS', // Force view back to 'My Documents'\n      fileUploads: [], \n      urlUpload: null \n    }, () => {\n      this.refreshCurrentView()\n        .then(this.fetchAccountData.bind(this));\n    });\n  }\n\n  setBusy(busy) {\n    this.setState({ busy: busy });\n  }\n\n  afterAction() {\n    this.refreshCurrentView()\n      .then(() => this.setState({ busy: false, selection: []}))\n      .then(this.fetchAccountData.bind(this));\n  }\n\n  render() {\n    const isUploading = this.state.fileUploads.length > 0 || this.state.urlUpload;\n\n    return(\n      <React.Fragment>\n        <Sidebar\n          account={this.state.account}\n          onFolderCreated={this.refreshCurrentView.bind(this)}\n          onUploadFiles={this.startUpload.bind(this)}\n          currentView={this.state.view}\n          onChangeView={this.changeView.bind(this)} \n          onCreateFromSource={this.startRegisterRemoteSource.bind(this)} />\n\n        <div className=\"container\">\n          <Header\n            view={this.state.view}\n            breadcrumbs={this.state.breadcrumbs}\n            readme={this.state.readme}\n            docCount={this.state.total_docs}\n            selection={this.state.selection}\n            presentation={this.state.presentation}\n            onDelete={this.setBusy.bind(this, true)}\n            afterAction={this.afterAction.bind(this)}\n            onTogglePresentation={this.togglePresentation.bind(this)} \n            onCreateReadme={this.createReadme.bind(this)} />\n\n          {this.state.presentation === 'TABLE' ?\n            <TablePane\n              view={this.state.view}\n              folders={this.state.folders}\n              documents={this.state.documents}\n              columns={this.state.table_columns}\n              sorting={this.state.table_sorting}\n              busy={this.state.busy}\n              selection={this.state.selection}\n              disableFiledrop={this.state.view !== 'MY_DOCUMENTS'}\n              onSort={this.onSortTable.bind(this)}\n              onSelect={this.onSelect.bind(this)} \n              onDropFiles={this.startUpload.bind(this)} \n              onDropURL={this.startRegisterRemoteSource.bind(this)} \n              onChangeColumnPrefs={this.onChangeColumnPrefs.bind(this)} \n              onRenameFolder={this.onRenameFolder.bind(this)}>\n\n              {this.state.readme && \n                <Readme\n                  content={this.state.readme} \n                  onUpdate={this.onUpdateReadme.bind(this)} \n                  onDelete={this.onDeleteReadme.bind(this)} /> \n              }\n            </TablePane>\n            :\n            <GridPane\n              folders={this.state.folders}\n              documents={this.state.documents}\n              busy={this.state.busy}\n              selection={this.state.selection}\n              onSelect={this.onSelect.bind(this)} \n              disableFiledrop={this.state.view !== 'MY_DOCUMENTS'}\n              onDropFiles={this.startUpload.bind(this)}\n              onDropURL={this.startRegisterRemoteSource.bind(this)} >\n              \n              {this.state.readme && \n                <Readme \n                  content={this.state.readme} \n                  onUpdate={this.onUpdateReadme.bind(this)} \n                  onDelete={this.onDeleteReadme.bind(this)} /> \n              }\n            </GridPane>\n          }\n        </div>\n\n        { isUploading && \n          <Uploader\n            files={this.state.fileUploads} \n            url={this.state.urlUpload}\n            onUploadComplete={this.onUploadComplete.bind(this)} /> \n        }\n\n        {this.state.announcement && \n          <Announcement\n            id={this.state.announcement.id}\n            message={this.state.announcement.content} \n            onClose={e => this.setState({ announcement: null })} />\n        }\n      </React.Fragment>\n    )\n  }\n\n}\n\nrender(<App />, document.getElementById('app'));\n"],"sourceRoot":""}