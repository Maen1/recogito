{"version":3,"sources":["common/content/table/Columns.js","common/content/Selection.js","common/content/Readme.jsx","common/StoredUIState.js","workspace/API.js","common/components/Meter.jsx","common/content/upload/Uploader.jsx","workspace/header/search/AdvancedSearch.jsx","workspace/header/search/Search.jsx","common/components/Prompt.jsx","workspace/actions/DeleteAction.jsx","workspace/header/Header.jsx","common/components/MenuPopup.jsx","workspace/sidebar/sections/Account.jsx","workspace/sidebar/sections/CreateNew.jsx","workspace/sidebar/sections/Views.jsx","workspace/sidebar/sections/Storage.jsx","workspace/sidebar/Sidebar.jsx","workspace/App.jsx","common/content/upload/DropzoneDecoration.jsx","common/content/profile/Avatar.jsx","common/content/HeaderIcon.jsx","common/content/Breadcrumbs.jsx","common/content/profile/CollaboratorList.jsx","common/content/profile/ProfileInfo.jsx","common/content/table/rows/BaseRowComponent.jsx","common/content/table/rows/HeaderRow.jsx","common/content/table/rows/DocumentRow.jsx","common/content/table/rows/FolderRow.jsx","common/components/Modal.jsx","common/content/table/preferences/ColumnOrder.jsx","common/content/table/preferences/PreferencesModal.jsx","common/content/table/TablePane.jsx","common/content/grid/Folder.jsx","common/content/grid/Document.jsx","common/content/grid/GridPane.jsx"],"names":["COLUMNS","HEADER_NAMES","author","title","language","date_freeform","uploaded_at","last_edit_at","last_edit_by","annotations","public_visibility","status_ratio","activity","owner","shared_by","access_level","COLUMN_WIDTH","agg_document","AGGREGATE_COLUMNS","Columns","Object","_home_simonr_Workspaces_pelagios_recogito2_workspace_frontend_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","_home_simonr_Workspaces_pelagios_recogito2_workspace_frontend_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","key","value","field","w","columns","reduce","result","startsWith","concat","push","Selection","allItems","selection","_allItems","_selection","length","item","isCtrlPressed","thisIdx","indexOf","splice","toIdx","_this","selectedIndices","map","minIdx","Math","min","apply","maxIdx","max","isOutside","slice","from","to","Readme","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","className","props","children","Component","StoredUIState","state","localStorage","getItem","JSON","parse","prefixed","setItem","stringify","fetchDocuments","path","config","axios","post","API","get","id","delete","ids","data","Meter","react_default","style","position","width","height","Uploader","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","_emptyState","start","files","remoteSource","url","phase","totalSize","total","f","size","filepartIds","uploadId","uploadStatus","progress","errors","next","_this2","setState","_this3","initNewDocument","then","uploadFiles","registerURL","catch","error","prev","response","finalizeDocument","bind","name","formdata","FormData","append","headers","X-Requested-With","_this4","requests","file","idx","onUploadProgress","evt","loaded","uuid","uploadOne","Promise","all","_this5","tasks","running_tasks","pollTaskProgress","document_id","onUploadComplete","console","log","filepartId","pollResult","_this6","subtasks","find","t","filepart_id","setUploadStatus","status","documentId","taskTypes","_this7","updateStatusForFile","setTimeout","complete","isUploadComplete","_this8","totalLoaded","onClick","onCancel","message","Meter_Meter","AdvancedSearch","onMousedown","assertThisInitialized","onKeydown","document","addEventListener","removeEventListener","isClickOutside","_node","contains","target","isClickOnToggle","classList","onClose","which","ref","n","type","Search","advancedSearchOpen","placeholder","AdvancedSearch_AdvancedSearch","toggleAdvancedSearch","Prompt","onNo","toLowerCase","react_draggable_default","handle","onYes","DeleteAction","r","onStart","deleteDocument","onSuccess","onError","bulkDeleteDocuments","ReactDOM","createPortal","Prompt_Prompt","executeDelete","body","Header","action","afterDelete","isOpen","Search_Search","HeaderIcon","icon","link","Breadcrumbs","view","react_transition_group","in","timeout","classNames","startDeleteAction","presentation","onTogglePresentation","DeleteAction_DeleteAction","onDelete","onDeleteSuccess","onDeleteError","cancelDelete","MenuPopup","menu","group","options","option","disabled","onSelect","href","label","Fragment","Account","menuVisible","window","location","showMenu","ProfileInfo","account","MenuPopup_MenuPopup","onSelectMenuOption","closeMenu","CreateNew","_input","click","Array","onUploadFiles","onShowOptions","c","multiple","onChange","display","onSelectOption","ViewListItem","current","count","ViewList","dataAvailable","documents","Views_ViewListItem","my_documents","currentView","onChangeView","shared_with_me","Storage","storage","quota","quota_mb","used","used_mb","number_format_default","displayType","thousandSeparator","Sidebar","collaborators","Account_Account","CreateNew_CreateNew","Views_ViewList","Storage_Storage","CollaboratorList","username","App","table_columns","table_sorting","busy","folders","readme","fileUploads","urlUpload","assign","load","_root","getElementById","querySelector","fetchAccountData","refreshCurrentView","expandAggregatedColumns","sort","accountData","myDocuments","getDisplayConfig","items","sharedWithMe","save","fetchMyDocuments","fetchSharedWithMe","before","p","sorting","_this9","isUploading","Sidebar_Sidebar","startUpload","changeView","Header_Header","setBusy","togglePresentation","TablePane","onSort","onSortTable","disableFiledrop","onDropFiles","onDropURL","startRegisterRemoteSource","onChangeColumnPrefs","GridPane","Uploader_Uploader","render","App_App","AnimatedDiv","posed","div","open","bottom","transition","ease","duration","closed","DropzoneDecoration","_home_simonr_Workspaces_pelagios_recogito2_workspace_frontend_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","_home_simonr_Workspaces_pelagios_recogito2_workspace_frontend_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","visible","pose","Avatar","str","hash","i","charCodeAt","color","stringToHslColor","backgroundColor","charAt","toUpperCase","VIEW_LABELS","MY_DOCUMENTS","SHARED_WITH_ME","fetchCollaborators","user","_Avatar_jsx__WEBPACK_IMPORTED_MODULE_7__","Identity","replace","member_since","_Avatar_jsx__WEBPACK_IMPORTED_MODULE_6__","real_name","Intl","DateTimeFormat","year","month","day","format","Date","bio","website","formatURL","BaseRowComponent","updateTotalRowSpan","_totalSpan","getSpan","HeaderRow","prototype","sortColumn","sortAsc","ICONS","TEXT_PLAIN","TEXT_TEIXML","IMAGE_UPLOAD","IMAGE_IIIF","DATA_CSV","FORMATTERS","datetime","lib_default","date","visibility","AGGREGATE_FIELDS","DocumentRow","substring","formatter","undefined","filetypes","selected","createAggregateField","createField","src","alt","FolderRow","Modal","SortableItem","SortableElement","_ref","SortableList","SortableContainer","_ref2","index","ColumnOrder","onSortEnd","e","oldIndex","newIndex","PreferencesModal","states","forEach","isChecked","includes","checked","toAppend","filter","checkAll","setAllRows","arrayMove","Modal_Modal","onClickAll","toggleOne","htmlFor","ColumnOrder_ColumnOrder","onSave","prefsOpen","isShift","getModifierState","isCtrl","selectRange","selectItem","getSelectedItems","preventDefault","args","FolderRow_FolderRow","DocumentRow_DocumentRow","asc","by","active","drag","_","dataTransfer","getData","hostname","React","Children","toArray","shift","tablePane","es","rowCount","rowHeight","rowRenderer","HeaderRow_HeaderRow","sortBy","showPreferences","dist_es","disableClick","onDragEnter","onDrag","onDragLeave","onDrop","PreferencesModal_PreferencesModal","onSavePreferences","Folder","Document","isStacked","fileCount","onDoubleClick","itemsPerRow","fromIndex","itemsInRow","renderedItems","fill","rowIdx","Folder_Folder","Document_Document","file_count","gridPane","itemCount","floor","ceil"],"mappings":"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","file":"static/js/workspace.5a6bc90d.chunk.js","sourcesContent":["export const COLUMNS = [\n  // Aggregate fields\n  // 'agg_document',\n\n  // Common fields\n  'author',\n  'title',\n  'language',\n  'date_freeform',\n  'uploaded_at',\n  'last_edit_at',\n  'last_edit_by',\n  'annotations',\n  'public_visibility',\n  // 'status_ratio',\n  // 'activity',\n\n  // Shared with me\n  // 'owner',\n  // 'shared_by',\n  // 'access_level'\n]\n\n// Labels to use for fields\nexport const HEADER_NAMES = {\n  // agg_document    : 'Document',\n\n  author            : 'Author',\n  title             : 'Title',\n  language          : 'Language',\n  date_freeform     : 'Date',\n  uploaded_at       : 'Uploaded at',\n  last_edit_at      : 'Last edit',\n  last_edit_by      : 'Last edit by',\n  annotations       : 'Annotations',\n  public_visibility : 'Visibility',\n  status_ratio      : 'Verification ratio',\n  activity          : 'Activity graph',\n\n  owner             : 'Document owner',\n  shared_by         : 'Shared by',\n  access_level      : 'Access level'\n}\n\n// Relative width requirements per column (XL, L, M, S)\nexport const COLUMN_WIDTH = {\n  agg_document    : 'XL',\n\n  author            : 'M',\n  title             : 'L',\n  language          : 'M',\n  date_freeform     : 'M',\n  uploaded_at       : 'M',\n  last_edit_at      : 'M',\n  last_edit_by      : 'M',\n  annotations       : 'M',\n  public_visibility : 'M',\n  status_ratio      : 'M',\n  activity          : 'M',\n\n  owner             : 'M',\n  shared_by         : 'M',\n  access_level      : 'S'\n}\n\nexport const AGGREGATE_COLUMNS = {\n  agg_document: [ 'author', 'document' ]\n}\n\n// Static helper methods \nexport class Columns {\n\n  static getSpan(field) {\n    const w = COLUMN_WIDTH[field];\n    if (w === 'XL') \n      return 6;\n    else if (w === 'L')\n      return 4;\n    else if (w === 'M')\n      return 2;\n    else if (w === 'S')\n      return 1;\n  }\n\n  /** Expands agg_ columns to those that are required to build them **/\n  static expandAggregatedColumns(columns) {\n    return columns.reduce((result, field) => {\n      if (field.startsWith('agg_'))\n        result = result.concat(AGGREGATE_COLUMNS[field]);\n      else\n        // Just append\n        result.push(field);\n\n      return result;\n    }, []);\n  }\n\n}","export default class Selection {\n    \n  constructor(allItems, selection) {\n    this._allItems = allItems;\n    this._selection = selection;\n  }\n\n  clear() {\n    this._selection = [];\n  }\n\n  isEmpty() {\n    return this._selection.length === 0;\n  }\n\n  getSelectedItems() {\n    return this._selection;\n  }\n\n  selectItem(item, isCtrlPressed) {\n    const thisIdx = this._selection.indexOf(item);\n    const isSelected = thisIdx > -1;\n\n    if (isCtrlPressed) {\n      // Toggle this item, leave the rest of the selection unchanged\n      if (isSelected)\n        this._selection.splice(thisIdx, 1);\n      else\n        this._selection.push(item);      \n    } else {\n      // Toggle state of this item and clear the rest of the selection\n      this._selection = [ item ];\n    }\n  }\n\n  /**\n   * Range selection: SHIFT + click. \n   * \n   * Behavior follows Mac conventions, cf. \n   * https://stackoverflow.com/questions/2959887/algorithm-for-shift-clicking-items-in-a-collection-to-select-them\n   */\n  selectRange(toIdx) {\n    const selectedIndices = this._selection.map(item => {\n      return this._allItems.indexOf(item);\n    });   \n    \n    const minIdx = Math.min.apply(null, selectedIndices);\n    const maxIdx = Math.max.apply(null, selectedIndices);\n\n    const isOutside = (toIdx > maxIdx) || (toIdx < minIdx);\n\n    const slice = (from, to) => this._allItems.slice(from, to + 1);\n\n    if (isOutside && toIdx > maxIdx)\n      // Expand selection downwards\n      this._selection = slice(minIdx, toIdx);\n    else if (isOutside)\n      // Expand selection upwards\n      this._selection = slice(toIdx, maxIdx);\n    else\n      // Fill from topmost\n      this._selection = slice(minIdx, toIdx);\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class Readme extends Component {\n\n  render() {\n    return (\n      <div className=\"readme\">\n        <div className=\"inner\">\n          {this.props.children}\n        </div>\n      </div>\n    )\n  }\n\n}\n","export default class StoredUIState {\n\n  static load() {\n    const state = {};\n\n    const addIfDefined = (key) => {\n      const value = localStorage.getItem(`r2.workspace.${key}`);\n      if (value) state[key] = JSON.parse(value);\n    }\n\n    ['view', 'presentation', 'table_columns', 'table_sorting'].map(addIfDefined)\n\n    return state;\n  }\n\n  static save(key, value) {\n    const prefixed = `r2.workspace.${key}`\n    localStorage.setItem(prefixed, JSON.stringify(value));\n  }\n\n}","import axios from 'axios';\n\nconst fetchDocuments = (path, config) => {\n  return axios.post(`/my/api/${path}`, config);\n};\n\nexport default class API {\n\n  static accountData() {\n    return axios.get('/my/api/account');\n  }\n\n  static myDocuments(config) {\n    return fetchDocuments('my-documents', config);\n  }\n\n  static sharedWithMe(config) {\n    return fetchDocuments('shared-with-me', config);\n  }\n\n  // Deletes one document via the API\n  static deleteDocument(id) {\n    return axios.delete(`/document/${id}`);\n  }\n\n  // Deletes multiple documents in one go via the bulk API\n  static bulkDeleteDocuments(ids) {\n    return axios.delete('/document/bulk', { data: ids });\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class Meter extends Component {\n\n  render() {\n    return (\n      <div\n        className=\"meter\"\n        style={{ position: 'relative' }}>\n\n        <div\n          className=\"bar\"\n          style={{\n            width: `${100 * this.props.value}%`,\n            height: '100%'\n          }} />\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\n\nimport Meter from '../../components/Meter.jsx';\n\nexport default class Uploader extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = this._emptyState(props);\n    this.start();\n  }\n\n  _emptyState(props) {\n    return {\n      files: props.files,\n      remoteSource: props.url,\n      phase: 'Uploading',\n      totalSize: props.files.reduce((total, f) => total + f.size, 0),\n      filepartIds: (props.files.length > 0) ? props.files.map(() => null) : [ null ],\n      uploadId: null,\n      uploadStatus: (props.files.length > 0) ? props.files.map(() => 'UPLOADING') : [ 'UPLOADING'],\n      progress: (props.files.length > 0) ? props.files.map(() => 0) : [ 0 ],\n      errors: []\n    };\n  }\n\n  componentWillReceiveProps(next) {\n    if (this.props.files === next.files && this.props.url === next.url)\n      return;\n\n    this.setState(this._emptyState(next), () => this.start());\n  }\n\n  /** \n   * Starts a new upload.\n   * \n   * Since one document generally consists of multiple files, the \n   * upload process is multi-stage: \n   * \n   * - first, the new document is initialized, and assigned an ID on the server\n   * - then, all files are uploaded to this document\n   * - finally, a finalization requests closes the document, and waits for any\n   *   processing (image tiling, TEI conversion) to finish\n   */\n  start() {\n    this.initNewDocument()\n      .then((result) => { \n        this.setState({ uploadId: result.data.id });\n\n        // Branch based on files vs. remote URL\n        if (this.state.files.length > 0)\n          return this.uploadFiles() \n        else if (this.state.remoteSource)\n          return this.registerURL()\n      })\n      .catch(error => {\n        this.setState(prev => {\n          const errors = prev.errors.slice(0);\n          errors.push(error.response.data);\n          return { errors: errors };\n        });\n      })\n      .then(this.finalizeDocument.bind(this));\n  }\n\n  /**\n   * Initializes a new document, using the filename as title,\n   * or a 'New document' placeholder in case there are multiple files.\n   */\n  initNewDocument() {\n    const title = (this.state.files.length === 1) ? this.state.files[0].name : 'New document';\n    const formdata = new FormData();\n    formdata.append('title', title);\n\n    return axios.post('/my/upload', formdata, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    });\n  }\n\n  registerURL() {\n    this.setState({ phase: 'Importing' });\n\n    const formdata = new FormData();\n    formdata.append('url', this.state.remoteSource);\n\n    return axios.post(`/my/upload/${this.state.uploadId}/file`, formdata, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    });\n  }\n\n  /**\n   * Uploads the files in parallel.\n   */\n  uploadFiles() {\n    // Helper: handles upload for one file\n    const uploadOne = (file, idx) => {\n      const formdata = new FormData();\n      formdata.append('file', file);\n\n      const onUploadProgress = (evt) => {\n        const progress = this.state.progress.slice(0); // Clone progress array\n        progress[idx] = evt.loaded;\n        this.setState({ progress: progress });\n      }\n\n      return axios.post(`/my/upload/${this.state.uploadId}/file`, formdata, {\n        headers: { 'X-Requested-With': 'XMLHttpRequest' },\n        onUploadProgress: onUploadProgress\n      }).then(result => {\n        this.setState(prev => {\n          const filepartIds = prev.filepartIds.slice(0);\n          filepartIds[idx] = result.data.uuid;\n          return { filepartIds: filepartIds };\n        });\n\n        return result;\n      }).catch(error => {\n        this.setState(prev => {\n          const uploadStatus = prev.uploadStatus.slice(0);\n          uploadStatus[idx] = 'FAILED';\n\n          const errors = prev.errors.slice(0);\n          errors.push(error.response.data);\n\n          return { \n            uploadStatus: uploadStatus,\n            errors: errors \n          };\n        });\n      });\n    }\n    \n    // The list of request promises...\n    const requests = this.state.files.map((file, idx) => uploadOne(file, idx));\n\n    // ... rolled into a promise of the list of request results\n    return Promise.all(requests);\n  }\n\n  /**\n   * Finalizes the upload, creating the document and starting processing tasks (if any)\n   */\n  finalizeDocument()  {\n    return axios.post(`/my/upload/${this.state.uploadId}/finalize`, {\n      headers: { 'X-Requested-With': 'XMLHttpRequest' }\n    }).then(result => {\n      const tasks = result.data.running_tasks;\n      if (tasks.length > 0) {\n        this.setState({ phase: 'Importing...' });\n        this.pollTaskProgress(result.data.document_id, tasks);\n      } else {\n        this.props.onUploadComplete();\n      }\n    }).catch(error => {\n      console.log('Upload contained errors');\n    });\n  }\n\n  updateStatusForFile(filepartId, pollResult) {\n    const progress = pollResult.subtasks.find(t => t.filepart_id === filepartId);\n    const idx = this.state.filepartIds.indexOf(filepartId);\n\n    const setUploadStatus = (value) => {\n      this.setState(prev => {\n        const uploadStatus = prev.uploadStatus.slice(0);\n        uploadStatus[idx] = value;\n        return { uploadStatus: uploadStatus };\n      })\n    }\n\n    if (progress)\n      setUploadStatus(progress.status);\n    else // No task running for this file - complete\n      setUploadStatus('COMPLETED');\n  }\n\n  /**\n   * Polls import task progress\n   */\n  pollTaskProgress(documentId, taskTypes) {    \n    axios.get(`/api/task?id=${documentId}`)\n      .then(result => {\n        // Update status per file\n        this.state.filepartIds.map(id => this.updateStatusForFile(id, result.data));\n        const isDone = result.data.status === 'COMPLETED' || result.data.status === 'FAILED';\n        if (isDone)\n          this.props.onUploadComplete()\n        else\n          setTimeout(() => this.pollTaskProgress(documentId, taskTypes), 1000);\n      });\n  }\n\n  isUploadComplete() {\n    return this.state.uploadStatus\n      .reduce((complete, next) => complete && (next === 'COMPLETED' || next === 'FAILED'));\n  }\n\n  onCancel(evt) {\n    if (this.isUploadComplete())\n      this.props.onUploadComplete();\n  }\n\n  render() {\n    const totalLoaded = this.state.progress.reduce((total, next) => total + next, 0);\n\n    return (\n      <div className=\"upload-progress\">\n        <div className=\"phase\">\n          {this.state.phase}\n          <button \n            className=\"close nostyle\"\n            onClick={this.onCancel.bind(this)}>&#xe897;</button>\n        </div>\n        <ul className={`files${(this.state.errors.length > 0) ? ' has-errors' : ''}`}>\n          {this.state.files.map((f, idx) =>\n            <li key={idx}>\n              {f.name}\n              <span className={`icon spinner ${this.state.uploadStatus[idx]}`}></span>\n            </li>\n          )}\n\n          {this.state.remoteSource &&\n            <li>\n              Fetching content from remote source...\n              <span className=\"icon spinner RUNNING\"></span>\n            </li>\n          }\n        </ul>\n        {this.state.errors.length > 0 && \n          <ul className=\"errors\">\n            {this.state.errors.map((message, idx) => <li key={idx}>{message}</li>)}\n          </ul>\n        }\n        <div className=\"progress\">\n          <Meter value={totalLoaded / this.state.totalSize} />\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class AdvancedSearch extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.onMousedown = this.onMousedown.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.onMousedown, false);\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMousedown, false);\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onMousedown(evt) {\n    const isClickOutside = !this._node.contains(evt.target);\n    const isClickOnToggle = evt.target.classList.contains('advanced');\n    if (isClickOutside && !isClickOnToggle) this.props.onClose();\n  }\n\n  onKeydown(evt) {\n    if (evt.which === 27) this.props.onClose();\n  }\n\n  render() {\n    return (\n      <div\n        ref={n => this._node = n}\n        className=\"advanced-search\">\n        <button\n          className=\"close nostyle\"\n          onClick={this.props.onClose}>&#xe897;</button>\n\n        <form>\n          <fieldset>\n            <p>\n              <label>Search in</label>\n              <select>\n                <option>All of Recogito</option>\n                <option>My documents</option>\n                <option>Shared with me</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Document type</label>\n              <select>\n                <option>Any</option>\n                <option>Text</option>\n                <option>Image</option>\n                <option>Table</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Owner</label>\n              <select>\n                <option>Anyone</option>\n                <option>me</option>\n                <option>specific user</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Metadata contains</label>\n              <input type=\"text\" />\n              <span className=\"hint\" />\n            </p>\n\n            <p>\n              <label>Last modified</label>\n              <select>\n                <option>Any time</option>\n                <option>this week</option>\n              </select>\n              <span className=\"hint\" />\n            </p>\n          </fieldset>\n          <fieldset className=\"buttons\">\n            <button className=\"nostyle clear\">Clear</button>\n            <button type=\"submit\" className=\"btn\">Search</button>\n          </fieldset>\n        </form>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nimport AdvancedSearch from './AdvancedSearch.jsx';\n\nexport default class Search extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { advancedSearchOpen: false }\n  }\n\n  toggleAdvancedSearch() {\n    this.setState(prev => (\n      { advancedSearchOpen: !prev.advancedSearchOpen }\n    ));\n  }\n\n  render() {\n    return (\n      <div className=\"wrapper\">\n        <div className=\"search\">\n          <div className=\"wrapper\">\n            <input placeholder=\"Search Recogito...\"/>\n            {/* <button\n              className=\"icon nostyle advanced\"\n            onClick={this.toggleAdvancedSearch.bind(this)}>{'\\ue688'}</button> */}\n          </div>\n          <span className=\"icon hand-lens\">&#xf002;</span>\n        </div>\n        {this.state.advancedSearchOpen &&\n          <AdvancedSearch onClose={this.toggleAdvancedSearch.bind(this)}/>\n        }\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport Draggable from 'react-draggable';\n\nexport default class Prompt extends Component {\n\n  constructor(props) {\n    super(props);\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  /** Clear selection on ESC **/\n  onKeydown(evt) {\n    if (evt.which === 27) this.props.onNo();\n  }\n\n  componentDidMount() {\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  render() {\n    const className = (this.props.type) ? `prompt ${this.props.type.toLowerCase()}` : 'prompt';\n\n    return (\n      <div className=\"clicktrap\">\n        <Draggable handle=\".prompt-header\">\n          <div className={className}>\n            <div className=\"prompt-header\">\n              <h1 className=\"title\">{this.props.title}</h1>\n            </div>\n\n            <div className=\"prompt-body\">\n              <p className=\"message\">{this.props.message}</p>\n              <p className=\"buttons\">\n                 <button className=\"btn yes\" onClick={this.props.onYes}>YES</button>\n                 <button className=\"btn outline no\" onClick={this.props.onNo}>NO</button>\n              </p>\n            </div>\n          </div>\n        </Draggable>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport API from '../API.js';\nimport Prompt from '../../common/components/Prompt.jsx';\n\nexport default class DeleteAction extends Component {\n\n  executeDelete() {\n    const ids = this.props.selection.map(r => r.id);\n\n    if (ids.length > 0) {\n      this.props.onStart();\n\n      if (ids.length === 1) {\n        API.deleteDocument(ids[0])\n           .then(() => {\n             this.props.onSuccess();\n           })\n           .catch((error) => {\n             this.props.onError(error);\n           });\n      } else {\n        API.bulkDeleteDocuments(ids)\n          .then(() => {\n            this.props.onSuccess();\n          })\n          .catch((error) => {\n            this.props.onError(error);\n          });\n      }\n    } else {\n      this.props.onCancel();\n    }\n  }\n\n  render() {\n    return ReactDOM.createPortal(\n      <Prompt \n        title=\"Delete Document\"\n        type=\"WARNING\"\n        message=\"You cannot undo this operation. Are you sure you want to do this?\" \n        onNo={this.props.onCancel}\n        onYes={this.executeDelete.bind(this)} />,\n\n      document.body\n    )\n  }\n\n}","import React, { Component } from 'react';\nimport { CSSTransition } from 'react-transition-group';\n\nimport Search from './search/Search.jsx';\nimport HeaderIcon from '../../common/content/HeaderIcon.jsx';\nimport Breadcrumbs from '../../common/content/Breadcrumbs.jsx';\nimport DeleteAction from '../actions/DeleteAction.jsx';\n\nexport default class Header extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      action: null \n    };\n\n    document.body.addEventListener('keydown', this.onKeydown.bind(this), false);\n  }\n\n  onKeydown(evt) {\n    if (this.props.selection.length > 0 && evt.which === 46)\n      this.setState({ action: 'DELETE' });\n  }\n\n  /** User clicked the DELETE button in the mini-menu */\n  startDeleteAction() {\n    this.setState({ action: 'DELETE' });\n  }\n\n  /** User clicked CANCEL in the warning prompt **/\n  cancelDelete() {\n    this.setState({ action: null });\n  }\n\n  /** Delete executed successfully **/\n  onDeleteSuccess() {\n    this.setState({ action: null }, () => {\n      this.props.afterDelete();\n    });\n  }\n\n  onDeleteError(error) {\n    this.setState({ action: null }, () => {\n      this.props.afterDelete(); // TODO error message\n    });\n  }\n\n  render() {\n    const isOpen = this.props.selection.length > 0;\n    return (\n      <div className=\"header\">\n        <div className=\"top-row\">\n          <Search/>\n          <div className=\"header-icons\">\n            <HeaderIcon icon=\"&#xe64a;\" className=\"help stroke7\" link=\"/help\" />\n            {/* <HeaderIcon icon=\"&#xe8ae;\" className=\"stats\" />\n            <HeaderIcon icon=\"&#xe8c1;\" className=\"notifications\" /> */}\n          </div>\n        </div>\n        <div className=\"subheader\">\n          <Breadcrumbs view={this.props.view}/>\n\n          <div className=\"subheader-icons\">\n            <CSSTransition\n              in={isOpen} \n              timeout={500} \n              classNames=\"selection-actions\">\n\n              <div className=\"selection-actions\">              \n                {/* <span className=\"share icon\">&#xf234;</span> */}\n\n                <span\n                  className=\"delete icon\" \n                  onClick={this.startDeleteAction.bind(this)}>&#xf014;</span>\n\n                {/* <span className=\"more icon\">&#xf078;</span> */}\n              </div>\n            </CSSTransition>\n\n            <HeaderIcon\n              className=\"presentation-toggle stroke7\"\n              icon={(this.props.presentation === 'TABLE') ? '\\ue645' : '\\ue636'} \n              onClick={this.props.onTogglePresentation} />\n\n            {this.state.action === 'DELETE' && \n                <DeleteAction\n                  selection={this.props.selection}\n                  onStart={this.props.onDelete}\n                  onSuccess={this.onDeleteSuccess.bind(this)}\n                  onError={this.onDeleteError.bind(this)}\n                  onCancel={this.cancelDelete.bind(this)} />\n            }\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class MenuPopup extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.onMousedown = this.onMousedown.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener('mousedown', this.onMousedown, false);\n    document.addEventListener('keydown', this.onKeydown, false);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mousedown', this.onMousedown, false);\n    document.removeEventListener('keydown', this.onKeydown, false);\n  }\n\n  onMousedown(evt) {\n    const isClickOutside = !this._node.contains(evt.target);\n    if (isClickOutside) this.props.onCancel();\n  }\n\n  onKeydown(evt) {\n    if (evt.which === 27) this.props.onCancel();\n  }\n\n  render() {\n    return (\n      <div\n        ref={n => this._node = n}\n        className={`modal-menu ${this.props.className}`}>\n        <ul>\n          {this.props.menu.map(group =>\n            <li\n              key={group.group}\n              className={`group ${group.group}`}>\n\n              <ul>\n                {group.options.map(option =>\n                  <li\n                    key={option.value || option.link}\n                    className={`option${option.disabled ? ' disabled' : '' }`}\n                    onClick={(option.disabled || !option.value) ? null : this.props.onSelect.bind(this, option.value) }>\n\n                    {(option.link) ? \n                      <a href={option.link}>\n                        <span className=\"icon\">{option.icon}</span> {option.label}\n                      </a>\n                      : \n                      <React.Fragment>\n                        <span className=\"icon\">{option.icon}</span> {option.label}\n                      </React.Fragment>\n                    }\n                  </li>\n                )}\n              </ul>\n            </li>\n          )}\n        </ul>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nimport ProfileInfo from '../../../common/content/profile/ProfileInfo.jsx';\nimport MenuPopup from '../../../common/components/MenuPopup.jsx';\n\nexport default class Account extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { menuVisible: false };\n  }\n\n  onSelectMenuOption(option) {\n    if (option === 'SETTINGS')\n      window.location.href= '/settings/account';\n    else if (option === 'SIGNOUT')\n      window.location.href= '/logout';\n    else if (option === 'HELP');\n      window.location.href= '/help';\n  }\n\n  showMenu() {\n    this.setState({ menuVisible: true });\n  }\n\n  closeMenu() {\n    this.setState({ menuVisible: false });\n  }\n\n  render() {\n    return (\n      <div\n        className=\"section account\"\n        onClick={this.showMenu.bind(this)} >\n\n        <ProfileInfo account={this.props.account} />\n\n        { this.state.menuVisible &&\n          <MenuPopup\n            className=\"account-menu\"\n            menu={[\n              { group: 'settings', options: [\n                { icon: '\\uf0ad', label: 'Account settings', link: '/settings/account' }\n              ]},\n              { group: 'general', options: [\n                { icon: '\\uf128', label: 'Help', link: '/help' },\n                { icon: '\\uf011', label: 'Sign out', link: '/logout' }\n              ]}\n            ]}\n            onSelect={this.onSelectMenuOption.bind(this)}\n            onCancel={this.closeMenu.bind(this)} />\n        }\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nimport MenuPopup from '../../../common/components/MenuPopup.jsx';\n\nexport default class CreateNew extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { menuVisible: false };\n  }\n\n  onShowOptions() {\n    this.setState({ menuVisible: true });\n  }\n\n  onSelectOption(option) {\n    this.setState({ menuVisible: false });\n\n    if (option === 'FILE') this._input.click();\n  }\n\n  onUploadFiles(evt) {\n    const files = Array.from(evt.target.files);\n    this.props.onUploadFiles(files);\n  }\n\n  onCancel() {\n    this.setState({ menuVisible: false });\n  }\n\n  render() {\n    return (\n      <div className=\"section create-new\">\n        <button\n          className=\"btn create-new\"\n          onClick={this.onShowOptions.bind(this)}>\n          <span className=\"icon\">&#xf067;</span>\n          <span className=\"label\">New</span>\n        </button>\n        <input\n          ref={c => this._input = c}\n          type=\"file\"\n          name=\"file\"\n          multiple\n          onChange={this.onUploadFiles.bind(this)}\n          style={{ display: 'none' }} />\n\n        {this.state.menuVisible &&\n          <MenuPopup\n            className=\"create-new\"\n            menu={[\n              { group: 'local', options: [\n                { icon: '\\uf07b', label: 'Folder', value: 'FOLDER', disabled: true },\n                { icon: '\\uf15b', label: 'File upload', value: 'FILE' }\n              ]},\n\n              { group: 'remote', options: [\n                { icon: '\\uf0c1', label: 'From IIIF manifest', value: 'IIIF', disabled: true },\n                { icon: '\\uf121', label: 'From CTS service', value: 'CTS', disabled: true }\n              ]}\n            ]}\n            onSelect={this.onSelectOption.bind(this)}\n            onCancel={this.onCancel.bind(this)} />\n        }\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nclass ViewListItem extends Component {\n\n  render() {\n    return (\n      <li\n        className={this.props.current ? 'current' : null}\n        onClick={this.props.onClick}>\n        <span className=\"icon\">{this.props.icon}</span> {\n          this.props.children\n        } {this.props.count != null &&\n          <span className=\"doc-count badge\">{this.props.count}</span>\n        }\n      </li>\n    )\n  }\n\n}\n\nexport default class ViewList extends Component {\n\n  render() {\n    const dataAvailable = this.props.account && this.props.account.documents;\n\n    return (\n      <div className=\"section views\">\n        <ul>\n          <ViewListItem\n            icon=\"&#xf2be;\"\n            count={dataAvailable && this.props.account.documents.my_documents}\n            current={this.props.currentView === 'MY_DOCUMENTS'}\n            onClick={this.props.onChangeView.bind(this, 'MY_DOCUMENTS')}>\n            My Documents\n          </ViewListItem>\n\n          <ViewListItem\n            icon=\"&#xf064;\"\n            count={dataAvailable && this.props.account.documents.shared_with_me}\n            current={this.props.currentView === 'SHARED_WITH_ME'}\n            onClick={this.props.onChangeView.bind(this, 'SHARED_WITH_ME')}>\n            Shared with me\n          </ViewListItem>\n\n          {/* <ViewListItem\n            icon=\"&#xf017;\"\n            current={this.props.currentView == 'RECENT'}\n            onClick={this.props.onChangeView.bind(this, 'RECENT')}>\n            Recent\n          </ViewListItem> */}\n        </ul>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport NumberFormat from 'react-number-format';\n\nimport Meter from '../../../common/components/Meter.jsx';\n\nexport default class Storage extends Component {\n\n  render() {\n    const dataAvailable = this.props.account && this.props.account.storage;\n    const quota = dataAvailable ? this.props.account.storage.quota_mb : 0;\n    const used = dataAvailable ? this.props.account.storage.used_mb : 0;\n\n    return (\n      <div className=\"section storage\">\n        <span className=\"icon\">&#xf1c0;</span> Storage\n        <div className=\"used-diskspace\">\n          <Meter\n            value={(quota > 0) ? used / quota : 0} />\n\n          <div className=\"label\">\n            <NumberFormat \n              displayType=\"text\"\n              value={used}\n              thousandSeparator={true} /> \n            {' of  '}\n            <NumberFormat \n              displayType=\"text\"\n              value={quota}\n              thousandSeparator={true} /> MB used\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nimport CollaboratorList from '../../common/content/profile/CollaboratorList.jsx';\n\nimport Account   from './sections/Account.jsx';\nimport CreateNew from './sections/CreateNew.jsx';\nimport ViewList  from './sections/Views.jsx';\nimport Storage   from './sections/Storage.jsx';\n\nexport default class Sidebar extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { collaborators: [] };\n  }\n\n  render() {\n    return (\n      <div className=\"sidebar\">\n        <Account\n          account={this.props.account} />\n\n        <CreateNew \n          onUploadFiles={this.props.onUploadFiles} />\n          \n        <ViewList\n          account={this.props.account}\n          currentView={this.props.currentView}\n          onChangeView={this.props.onChangeView} />\n\n        <Storage \n          account={this.props.account} /> \n\n        <CollaboratorList \n          className=\"section collaborators\"\n          title=\"My top collaborators\"\n          username={this.props.account && this.props.account.username} />\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { render } from 'react-dom';\n\nimport API from './API.js';\nimport GridPane from '../common/content/grid/GridPane.jsx';\nimport TablePane from '../common/content/table/TablePane.jsx';\nimport Readme from '../common/content/Readme.jsx';\nimport { Columns } from '../common/content/table/Columns.js';\nimport StoredUIState from '../common/StoredUIState.js';\nimport Uploader from '../common/content/upload/Uploader.jsx';\n\nimport Header from './header/Header.jsx';\nimport Sidebar from './sidebar/Sidebar.jsx';\n\nimport '../../assets/style/workspace/index.scss';\n\nexport default class App extends Component {\n\n  constructor(props) {\n    super(props);\n\n    const state = {\n      account       : null,           // account info\n      view          : 'MY_DOCUMENTS', // view, as selected in sidebar (My Documents, Shared, Recent)\n      presentation  : 'TABLE',        // presentation mode TABLE or GRID\n      table_columns : [               // current table view columns configuration\n        \"author\",\n        \"title\",\n        \"language\",\n        \"date_freeform\",\n        \"uploaded_at\",\n        \"last_edit_at\"\n      ],\n      table_sorting : null,          // current table sorting (if any)\n      busy          : false,          // Document pane in 'busy' state? (Docs loading, action onging, etc.)\n      folders       : [],             // Folders\n      documents     : [],             // Documents\n      readme        : null,           // Current folder readme\n      selection     : [],             // Selected items (folders and documents)\n      fileUploads   : [],             // Files currently uploading\n      urlUpload     : null            // URLs currently uploading/registering\n    };\n\n    Object.assign(state, StoredUIState.load());\n    this.state = state;\n\n    this._root = document.getElementById('app');\n\n    this.onKeydown = this.onKeydown.bind(this);\n    this.onMousedown = this.onMousedown.bind(this);\n  }\n\n  /** Clear selection on ESC key **/\n  onKeydown(evt) {\n    if (evt.which === 27) this.setState({ selection: [] });\n  }\n\n  /** Clear selection on click ouside the document pane **/\n  onMousedown(evt) {\n    const isClickOutside = !(\n      document.querySelector('.documents-pane').contains(evt.target) ||\n      document.querySelector('.subheader-icons').contains(evt.target)\n    );\n\n    if (isClickOutside) this.setState({ selection: [] });\n  }\n\n  componentDidMount() {\n    this._root.addEventListener('keydown', this.onKeydown, false);\n    this._root.addEventListener('mousedown', this.onMousedown, false);\n\n    this.fetchAccountData();\n    this.refreshCurrentView();\n  }\n\n  componentWillUnmount() {\n    this._root.removeEventListener('keydown', this.onKeydown, false);\n    this._root.removeEventListener('mousedown', this.onMousedown, false);\n  }\n\n  getDisplayConfig() {\n    if (this.state.presentation === 'GRID')\n      return; // No configs for grid view\n\n    return {\n      columns: Columns.expandAggregatedColumns(this.state.table_columns),\n      sort: this.state.table_sorting\n    };\n  }\n\n  fetchAccountData() {\n    return API.accountData().then(result => { this.setState({ account: result.data }) });\n  }\n\n  fetchMyDocuments() {\n    this.setState({ busy: true });\n    return API.myDocuments(this.getDisplayConfig()).then(result => {\n      this.setState({\n        documents: result.data.items, \n        busy: false \n      });\n    });\n  }\n\n  fetchSharedWithMe() {\n    this.setState({ busy: true });\n    return API.sharedWithMe(this.getDisplayConfig()).then(result => { \n      this.setState({\n        documents: result.data.items, \n        busy: false \n      }) \n    });\n  }\n\n  /** Switch between different document views (currently: 'my' vs. 'shared') **/\n  changeView(view) {\n    if (this.state.view !== view) {\n      StoredUIState.save('view', view);\n\n      this.setState({\n        view: view,\n        documents:[]\n      }, () => {\n        (view === 'MY_DOCUMENTS') ? this.fetchMyDocuments() : this.fetchSharedWithMe();\n      });\n    }\n  }\n\n  /** Reloads the current view from the API */\n  refreshCurrentView() {\n    if (this.state.view === 'MY_DOCUMENTS')\n      return this.fetchMyDocuments();\n    else \n      return this.fetchSharedWithMe();\n  }\n\n  /** Toggles the view presentation (table vs. grid) **/\n  togglePresentation() {\n    this.setState(before => { \n      const p = (before.presentation === 'TABLE') ? 'GRID' : 'TABLE';\n      StoredUIState.save('presentation', p);\n      return { presentation: p };\n    });\n  }\n\n  onChangeColumnPrefs(columns) {\n    StoredUIState.save('table_columns', columns);\n    this.setState({ table_columns: columns }, () => {\n      this.refreshCurrentView();\n    });\n  }\n  \n  onSortTable(sorting) {\n    StoredUIState.save('table_sorting', sorting);\n    this.setState({ table_sorting: sorting }, () => {\n      this.refreshCurrentView();\n    });\n  }\n\n  /** File selection **/\n  onSelect(selection) {\n    this.setState({ selection: selection });\n  }\n\n  /** File upload **/\n  startUpload(files) {\n    this.setState({ \n      fileUploads: files, \n      urlUpload: null\n    });\n  }\n\n  /** Remote file registration (IIIF, CTS) **/\n  startRegisterRemoteSource(url) {\n    this.setState({ \n      fileUploads: [],\n      urlUpload: url\n    });\n  } \n\n  onUploadComplete() {\n    this.setState({ fileUploads: [], urlUpload: null }, () => {\n      this.refreshCurrentView()\n        .then(this.fetchAccountData.bind(this));\n    });\n  }\n\n  setBusy(busy) {\n    this.setState({ busy: busy });\n  }\n\n  afterDelete() {\n    this.refreshCurrentView()\n      .then(() => this.setState({ busy: false, selection: []}))\n      .then(this.fetchAccountData.bind(this));\n  }\n\n  render() {\n    const isUploading = this.state.fileUploads.length > 0 || this.state.urlUpload;\n\n    return(\n      <React.Fragment>\n        <Sidebar\n          account={this.state.account}\n          onUploadFiles={this.startUpload.bind(this)}\n          currentView={this.state.view}\n          onChangeView={this.changeView.bind(this)} />\n\n        <div className=\"container\">\n          <Header\n            view={this.state.view}\n            selection={this.state.selection}\n            presentation={this.state.presentation}\n            onDelete={this.setBusy.bind(this, true)}\n            afterDelete={this.afterDelete.bind(this)}\n            onTogglePresentation={this.togglePresentation.bind(this)} />\n\n          {this.state.presentation === 'TABLE' ?\n            <TablePane\n              folders={this.state.folders}\n              documents={this.state.documents}\n              columns={this.state.table_columns}\n              sorting={this.state.table_sorting}\n              busy={this.state.busy}\n              selection={this.state.selection}\n              onSort={this.onSortTable.bind(this)}\n              onSelect={this.onSelect.bind(this)} \n              disableFiledrop={this.state.view !== 'MY_DOCUMENTS'}\n              onDropFiles={this.startUpload.bind(this)} \n              onDropURL={this.startRegisterRemoteSource.bind(this)} \n              onChangeColumnPrefs={this.onChangeColumnPrefs.bind(this)} >\n\n              {this.state.readme && <Readme>{this.state.readme}</Readme> }\n            </TablePane>\n            :\n            <GridPane\n              folders={this.state.folders}\n              documents={this.state.documents}\n              busy={this.state.busy}\n              selection={this.state.selection}\n              onSelect={this.onSelect.bind(this)} \n              disableFiledrop={this.state.view !== 'MY_DOCUMENTS'}\n              onDropFiles={this.startUpload.bind(this)}\n              onDropURL={this.startRegisterRemoteSource.bind(this)} >\n              \n              {this.state.readme && \n                <Readme>{this.state.readme}</Readme> }\n            </GridPane>\n          }\n        </div>\n\n        { isUploading && \n          <Uploader\n            files={this.state.fileUploads} \n            url={this.state.urlUpload}\n            onUploadComplete={this.onUploadComplete.bind(this)} /> \n        }\n      </React.Fragment>\n    )\n  }\n\n}\n\nrender(<App />, document.getElementById('app'));\n","import React, { Component } from 'react';\nimport posed from 'react-pose';\n\nconst AnimatedDiv = posed.div({\n  open:   { \n    bottom: '30px',\n    transition: {\n      ease: 'easeOut',\n      duration:200\n    }\n  },\n  closed: { bottom: '-140px' }\n});\n\nexport default class DropzoneDecoration extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { visible: false };\n  }\n\n  componentDidMount() {\n    this.setState({ visible: true });\n  }\n\n  render() {\n    return (\n      <div className=\"dropzone-decoration\">\n        <AnimatedDiv className=\"inner\" pose={this.state.visible ? 'open' : 'closed'}>\n          <span className=\"icon\">&#xf0ee;</span>\n          <p className=\"instructions\">\n            Drop files or IIIF manifest URLs to add them to your workspace.\n          </p>\n          <p className=\"supported\">\n            Supported formats: plain text (UTF-8), TEI/XML, image files, CSV (UTF-8)\n          </p>\n        </AnimatedDiv>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class Avatar extends Component {\n\n  // https://medium.com/@pppped/compute-an-arbitrary-color-for-user-avatar-starting-from-his-username-with-javascript-cd0675943b66\n  stringToHslColor(str) {\n    let hash = 0;\n    for (let i=0; i<str.length; i++) {\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\n    }\n    return hash % 360;\n  }\n\n  render() {\n    const color = this.props.username ? `hsl(${this.stringToHslColor(this.props.username)}, 35%, 65%)` : '#e2e2e2';\n\n    return (\n      <div className=\"avatar\" style={{ backgroundColor: color }}>\n        <div className=\"inner\">\n          { this.props.username && this.props.username.charAt(0).toUpperCase() }\n        </div>\n      </div>\n    )\n  }\n\n}","import React, { Component } from 'react';\n\nexport default class HeaderIcon extends Component {\n\n  render() {\n    return (\n      <div\n        className={`header-icon ${this.props.className}`}\n        onClick={this.props.onClick}>\n        {(this.props.link) ? \n          <a href={this.props.link} className=\"icon inner\">\n            {this.props.icon}\n          </a> :\n\n          <span className=\"icon inner\">\n            {this.props.icon}\n          </span>\n        }\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nconst VIEW_LABELS = {\n  MY_DOCUMENTS: 'My Documents',\n  SHARED_WITH_ME: 'Shared with me'\n}\n\nexport default class Breadcrumbs extends Component {\n\n  render() {\n    const label = (this.props.view) ? VIEW_LABELS[this.props.view] : this.props.label;\n    return (\n      <div className=\"breadcrumbs\">\n        <h2>{label}</h2>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport axios from 'axios';\n\nimport Avatar from './Avatar.jsx';\n\nexport default class CollaboratorList extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = { collaborators: [] };\n    this.fetchCollaborators(props);\n  }\n\n  componentWillReceiveProps(props) {\n    this.fetchCollaborators(props);\n  }\n\n  fetchCollaborators(props) {\n    if (props.username)\n      axios\n        .get(`/api/account/${props.username}/collaborators`)\n        .then(result => this.setState({ collaborators: result.data }));\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        {this.state.collaborators.length > 0 &&\n          <div className={this.props.className ? `collaborator-list ${this.props.className}` : 'collaborator-list'}>\n            <h2>{this.props.title}</h2>\n            <ul>\n              {this.state.collaborators.map(user => \n                <li key={user.username}>\n                  <a href={`/${user.username}`} title={user.username}>\n                    <Avatar username={user.username} />\n                  </a>\n                </li>\n              )}\n            </ul>\n          </div>\n        }\n      </React.Fragment>\n    )\n  }\n\n}","import React, { Component } from 'react';\n\nimport Avatar from './Avatar.jsx';\n\nexport default class Identity extends Component {\n\n  formatURL(url) {\n    return url.replace(/^https?:\\/\\//i, '');\n  }\n\n  render() {\n    const dataAvailable = \n      this.props.account && \n      this.props.account.username &&\n      this.props.account.member_since;\n      \n    return (\n      <div className=\"identity\">\n        <div className=\"user\">\n          <Avatar username={dataAvailable && this.props.account.username} />\n\n          <h1>\n            { dataAvailable ?\n                ((this.props.account.real_name) ? \n                  this.props.account.real_name : this.props.account.username) :\n\n                (<span className=\"placeholder\" />) }\n          </h1>\n\n          <p className=\"member-since\">\n            { dataAvailable ?\n              <React.Fragment>\n                Joined on { new Intl.DateTimeFormat('en-GB', {\n                  year : 'numeric',\n                  month: 'short',\n                  day  : '2-digit'\n                }).format(new Date(this.props.account.member_since)) }\n              </React.Fragment> : <span className=\"placeholder\" />\n            }\n          </p>\n        </div>\n\n        <div className=\"user-extended\">\n          { dataAvailable && this.props.account.bio &&\n            <p className=\"bio\">{this.props.account.bio}</p> }\n\n          { dataAvailable && this.props.account.website && \n            <p className=\"homepage\">\n              <a href={this.props.account.website}>{this.formatURL(this.props.account.website)}</a>\n            </p>\n          }\n        </div>\n      </div>\n    )\n  }\n\n}\n","import { Component } from 'react';\n\nimport { Columns } from '../Columns.js';\n\nexport default class BaseRowComponent extends Component {\n\n  constructor(props) {\n    super(props);\n    this.updateTotalRowSpan(props);\n  }\n\n  componentWillReceiveProps(next) {\n    this.updateTotalRowSpan(next);\n  }\n\n  /** Updates total unit width requirement for current row layout **/\n  updateTotalRowSpan(props) {\n    this._totalSpan = props.columns.reduce((total, field) => total + Columns.getSpan(field), 0);\n  }\n\n  getWidth(field) {\n    const span = Columns.getSpan(field);\n    return span / this._totalSpan;\n  }\n  \n}","import React from 'react';\n\nimport BaseRowComponent from './BaseRowComponent.jsx';\nimport { HEADER_NAMES } from '../Columns.js';\n\nexport default class HeaderRow extends BaseRowComponent {\n\n  render() {\n    return (\n      <div className=\"column-labels\">\n        {this.props.columns.map(field =>\n          <span\n            key={field}\n            style={{ width: `${100 * super.getWidth(field)}%` }}\n            className={`label ${field}`}\n            onClick={this.props.onSort.bind(this, field)}>\n            <span className=\"inner-wrapper\">\n              <span className=\"inner\">\n                {HEADER_NAMES[field] || field}\n              </span>\n              {this.props.sortColumn === field &&\n                <span className=\"sort icon\">\n                  <span className=\"inner\">\n                    {(this.props.sortAsc) ? '\\ue688' : '\\ue682' }\n                  </span>\n                </span>\n              }\n            </span>\n          </span>\n        )}\n      </div>\n    )\n  }\n\n}\n","import React from 'react';\nimport NumberFormat from 'react-number-format';\nimport TimeAgo from 'react-timeago';\n\nimport BaseRowComponent from './BaseRowComponent.jsx';\n\n/** Icons for possible content type values **/\nconst ICONS = {\n  TEXT_PLAIN   : 'icon_text.png',\n  TEXT_TEIXML  : 'icon_tei.png',\n  IMAGE_UPLOAD : 'icon_image.png',\n  IMAGE_IIIF   : 'icon_iiif.png',\n  DATA_CSV     : 'icon_csv.png'\n};\n\n/** Formatting rules for possible field types **/\nconst FORMATTERS = {\n  language: (language) => \n    language.toUpperCase(),\n\n  uploaded_at: (datetime) => \n    new Intl.DateTimeFormat('en-GB', {\n      year : 'numeric',\n      month: 'short',\n      day  : '2-digit'\n    }).format(new Date(datetime)),\n  \n  last_edit_at: (datetime) => \n    <TimeAgo date={datetime} />,\n\n  public_visibility: (visibility) => {\n    if (visibility === 'PUBLIC') \n      return ( <span className=\"icon\" title=\"Open to anyone\">&#xf09c;</span> );\n    else if (visibility === 'WITH_LINK')\n      return ( <span className=\"icon\" title=\"Open to anyone with the link\">&#xf0c1;</span> );\n    else \n      return ( <span className=\"icon\" title=\"Private\">&#xf023;</span> );\n  },\n\n  annotations: (annotations) =>\n    <NumberFormat \n      displayType=\"text\"\n      value={annotations}\n      thousandSeparator={true} />\n\n};\n\n/** Rules for aggregate fields **/\nconst AGGREGATE_FIELDS = {\n  agg_document: (item) => (item.author) ?\n                            `${item.author}, ${item.title}` : item.title\n};\n\nexport default class DocumentRow extends BaseRowComponent {\n\n  createAggregateField(url, field) {\n    return (\n      <a \n        key={field}\n        href={url} \n        className={field.substring(4)}\n        style={{ width: `${100 * super.getWidth(field)}%` }}>\n\n        {AGGREGATE_FIELDS[field](this.props.item)}\n      </a>\n    )\n  }\n\n  createField(url, field) {\n    const formatter = FORMATTERS[field];\n\n    const value = this.props.item[field] !== undefined ? \n      (formatter ? formatter(this.props.item[field]) : this.props.item[field]) :\n      ''; // empty value\n\n    return (\n      <a \n        key={field}\n        href={url}\n        className={field}\n        style={{ width: `${100 * super.getWidth(field)}%` }}>{value}</a>\n    )\n  }\n\n  render() {\n    const type = this.props.item.filetypes[0];\n    const url = `document/${this.props.item.id}/part/1/edit`;\n\n    return (\n      <div\n        className={`row${(this.props.selected) ? ' selected' : ''}`}\n        style={this.props.style}\n        onClick={this.props.onClick} >\n        \n        { this.props.columns.map(field => field.startsWith('agg_') ? \n          this.createAggregateField(url, field) : this.createField(url, field)) }\n\n        <span className={`type icon ${type}`}>\n          <img src={`/assets/images/${ICONS[type]}`} alt={`icon type ${type}`} />\n        </span>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class FolderRow extends Component {\n\n  render() {\n    return (\n      <div\n        style={this.props.style}\n        className=\"row folder\">\n        <a href=\"#\" className=\"folder-icon\">&#xf07b;</a>\n        <a href=\"#\" className=\"folder-name\">{this.props.name}</a>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport Draggable from 'react-draggable';\n\nexport default class Modal extends Component {\n\n  render() {\n    return (\n      <div className={`clicktrap ${this.props.className}`}>\n        <div className=\"modal-wrapper\">\n          <Draggable handle=\".modal-header\">\n            <div className=\"modal\">\n              <div className=\"modal-header\">\n                <h1 className=\"title\">{this.props.title}</h1>\n                <button\n                  className=\"close nostyle\"\n                  onClick={this.props.onClose}>&#xe897;</button>\n              </div>\n\n              <div className=\"modal-body\">\n                {this.props.children}\n              </div>\n            </div>\n          </Draggable>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { SortableContainer, SortableElement } from 'react-sortable-hoc';\n\nimport { HEADER_NAMES } from '../Columns.js';\n\nconst SortableItem = SortableElement(({ label }) =>\n  <div className=\"card\">{label}</div>\n);\n\nconst SortableList = SortableContainer(({ items }) =>\n  <div className=\"column-order\">\n    {items.map((item, idx) => (\n      <SortableItem key={`card-${idx}`} index={idx} label={HEADER_NAMES[item]} />\n    ))}\n  </div>\n);\n\nexport default class ColumnOrder extends Component {\n\n  render() {\n    return (\n      <SortableList\n        items={this.props.items}\n        onSortEnd={e => this.props.onSortEnd(e.oldIndex, e.newIndex)} />\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { arrayMove } from 'react-sortable-hoc';\n\nimport Modal from '../../../components/Modal.jsx';\nimport ColumnOrder from './ColumnOrder.jsx';\n\nimport { COLUMNS, HEADER_NAMES } from '../Columns.js';\n\nexport default class PreferencesModal extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      columns: props.columns.slice(0)\n    }\n  }\n\n  componentWillReceiveProps(next) {\n    if (next.columns !== this.props.columns)\n      this.setState({ columns: next.columns.slice(0) });\n  }\n\n  /** Computes a map (fieldname -> checked) from the current columns state **/\n  getCheckboxStates(props) {\n    const states = {};\n\n    COLUMNS.forEach(field => {\n      const isChecked = this.state.columns.includes(field);\n      states[field] = isChecked;\n    });\n\n    return states;\n  }\n\n  /** Sets visibility for all rows to the given boolean value **/\n  setAllRows(checked) {\n    const checkAll = () => {\n      const toAppend = \n        COLUMNS.filter(field => !this.state.columns.includes(field));\n\n      this.setState({ columns: this.state.columns.concat(toAppend) });\n    };\n\n    const uncheckAll = () => {\n      this.setState({ columns: [] });\n    };\n\n    if (checked) \n      checkAll();\n    else\n      uncheckAll();\n  }\n\n  /**\n   * Clicking 'ALL' either checks all boxes or - if all are currently\n   * checked, unchecks them.\n   */\n  onClickAll() {\n    const allRowsChecked = COLUMNS.length === this.state.columns.length;\n    if (allRowsChecked)\n      this.setAllRows(false);\n    else\n      this.setAllRows(true);\n  }\n\n  /** Toggles the checkbox with the given name **/\n  toggleOne(name) {\n    this.setState(prev => {\n      const idx = prev.columns.indexOf(name);\n      if (idx < 0)\n        prev.columns.push(name);\n      else\n        prev.columns.splice(idx, 1);        \n    \n      return prev;\n    });\n  }\n\n  onSort(oldIndex, newIndex) {\n    this.setState({\n      columns: arrayMove(this.state.columns, oldIndex, newIndex)\n    });\n  }\n\n  render() {\n    // Helper to create a single checkbox + label row\n    const createRow = (field) =>\n      <li key={field}>\n        <input\n          type=\"checkbox\"\n          id={field}\n          name={field}\n          checked={this.state.columns.includes(field)}\n          onChange={this.toggleOne.bind(this, field)} />\n        <label htmlFor={field}>{HEADER_NAMES[field]}</label>\n      </li>\n\n    return (\n      <Modal\n        className=\"preferences\"\n        title=\"Configure Columns\"\n        onClose={this.props.onCancel}>\n\n        <div className=\"scroll-pane\">\n          <div className=\"selected-columns\">\n            <button\n              className=\"all nostyle\"\n              onClick={this.onClickAll.bind(this)}>All</button>\n            <ul>\n              { COLUMNS.map(createRow) }\n            </ul>\n          </div>\n\n          <ColumnOrder\n            items={this.state.columns} \n            onSortEnd={this.onSort.bind(this)} />\n        </div>\n\n        <div className=\"buttons\">\n          <button\n            className=\"btn\"\n            onClick={this.props.onSave.bind(this, this.state.columns)}>Save</button>\n\n          <button \n            className=\"btn outline\"\n            onClick={this.props.onCancel}>Cancel</button>\n        </div>\n      </Modal>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport { AutoSizer, List } from 'react-virtualized';\nimport Dropzone from 'react-dropzone'\n\nimport DropzoneDecoration from '../upload/DropzoneDecoration.jsx';\nimport Readme from '../Readme.jsx';\nimport Selection from '../Selection.js';\n\nimport HeaderRow from './rows/HeaderRow.jsx';\nimport DocumentRow from './rows/DocumentRow.jsx';\nimport FolderRow from './rows/FolderRow.jsx';\nimport PreferencesModal from  './preferences/PreferencesModal.jsx';\n\nexport default class TablePane extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      prefsOpen: false,\n      selection: new Selection(props.folders.concat(props.documents), props.selection)\n    }\n  }\n\n  /** Set derived state **/\n  componentWillReceiveProps(next) {\n    this.setState({ \n      selection: new Selection(next.folders.concat(next.documents), next.selection)\n    });\n  }\n\n  /** Handle click/SHIFT+click/CTRL+click selection via Selection helper class */\n  onClick(evt, item, idx) {\n    const isShift = evt.getModifierState(\"Shift\");\n    const isCtrl = evt.getModifierState(\"Control\");\n\n    // Is this a selection or deselection?\n    const isSelectAction = \n      isShift || isCtrl || !this.props.selection.includes(item);\n\n    if (isSelectAction) {\n      if (isShift)\n        this.state.selection.selectRange(idx);\n      else\n        this.state.selection.selectItem(item, isCtrl);\n\n      this.props.onSelect(this.state.selection.getSelectedItems());\n      evt.preventDefault();\n    }\n  }\n\n  rowRenderer() {\n    const allItems = this.props.folders.concat(this.props.documents);\n\n    return ((args) => {\n      const item = allItems[args.index];\n      const isFolder = item.name;\n\n      if (isFolder)\n        return (\n          <FolderRow key={args.key} style={args.style} name={item.name} />\n        )\n      else\n        return (\n          <DocumentRow\n            key={args.key}\n            style={args.style}\n            columns={this.props.columns}\n            item={item}\n            selected={this.props.selection && this.props.selection.includes(item)}\n            onClick={e => this.onClick(e, item, args.index)} />\n        )\n    })\n  }\n\n  showPreferences(visible) {\n    this.setState({ prefsOpen: visible });\n  }\n\n  onSavePreferences(columns) {\n    this.setState({ prefsOpen: false });\n    this.props.onChangeColumnPrefs(columns);\n  }\n\n  sortBy(field) {\n    const asc = this.props.sorting ?\n      this.props.sorting.by === field ? !this.props.sorting.asc : true :\n      true;\n\n    this.props.onSort({ by: field, asc: asc });\n  }\n\n  onDrag(active) {\n    this.setState({ drag: active });\n  }\n\n  onDrop(files, _, evt) {\n    const url = evt.dataTransfer.getData('URL');\n\n    const hostname = url ? (() => {\n      const a = document.createElement('a');\n      a.href = url;\n      return a.hostname;\n    })() : null;\n\n    this.setState({ drag: false });\n\n    if (files.length > 0)\n      this.props.onDropFiles(files);\n    else if (url && hostname !== window.location.hostname) // Require external link\n      this.props.onDropURL(url);\n  }\n\n  render() {\n    const readme = React.Children.toArray(this.props.children)\n      .filter(c => c.type === Readme)\n      .shift(); // First readme or undefined\n\n    const tablePane =\n      <div className=\"documents-pane table-pane\">\n        <AutoSizer>\n          {({ height, width }) => (\n            <List\n              className=\"virtualized-list\"\n              width={width}\n              height={height}\n              rowCount={this.props.folders.length + this.props.documents.length}\n              rowHeight={47}\n              rowRenderer={this.rowRenderer()} />\n          )}\n        </AutoSizer>\n\n        { this.state.drag && <DropzoneDecoration /> }\n        { this.props.busy && <div className=\"busy-mask\" /> }\n      </div>\n\n    return (\n      <React.Fragment>\n        <div className=\"documents-table-header\">\n          <HeaderRow \n            columns={this.props.columns} \n            onSort={this.sortBy.bind(this)}\n            sortColumn={this.props.sorting ? this.props.sorting.by : null} \n            sortAsc={this.props.sorting ? this.props.sorting.asc : null} />\n\n          <button\n            className=\"column-options-btn nostyle icon\"\n            onClick={this.showPreferences.bind(this, true)} >&#xf141;</button>\n        </div>\n\n        {readme}\n\n        {this.props.disableFiledrop ? tablePane :\n          <Dropzone\n            className=\"dropzone\"\n            disableClick={true}\n            onDragEnter={this.onDrag.bind(this, true)}\n            onDragLeave={this.onDrag.bind(this, false)}\n            onDrop={this.onDrop.bind(this)}>\n            \n            {tablePane}\n            \n          </Dropzone>\n        }\n\n        {this.state.prefsOpen &&\n          <PreferencesModal\n            columns={this.props.columns}\n            onCancel={this.showPreferences.bind(this, false)} \n            onSave={this.onSavePreferences.bind(this)} />\n        }\n      </React.Fragment>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class Folder extends Component {\n\n  render() {\n    return (\n      <div className=\"cell\">\n        <div className=\"item-wrapper\">\n          <a href=\"#\" className=\"folder\">\n            <div className=\"label\">\n              {this.props.name}\n            </div>\n          </a>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\n\nexport default class Document extends Component {\n\n  render() {\n    const type = this.props.filetypes[0]; // TODO make more clever in the future\n    const isStacked = this.props.fileCount > 1;\n\n    return (\n      <div\n        className={`cell${(this.props.selected) ? ' selected' : ''}`}\n        onClick={this.props.onClick}\n        onDoubleClick={this.props.onDoubleClick} >\n        \n        <div className=\"inner\">\n          <div className={`item-wrapper${isStacked ? ' stacked' : ''}`}>\n            { isStacked && <div className=\"stack\" /> }\n            <a href={`document/${this.props.id}/part/1/edit`} className={`document ${type}`}>\n              <div className=\"label\">\n                {this.props.title}\n              </div>\n            </a>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n}\n","import React, { Component } from 'react';\nimport Dropzone from 'react-dropzone'\n\nimport { AutoSizer, List } from 'react-virtualized';\n\nimport Selection from '../Selection.js';\nimport Folder from './Folder.jsx';\nimport Document from './Document.jsx';\nimport Readme from '../Readme.jsx';\n\nimport DropzoneDecoration from '../upload/DropzoneDecoration.jsx';\n\nconst ITEM_SIZE = 192;\n\n/**\n * Using the following example:\n *\n * https://stackoverflow.com/questions/46368305/how-to-make-a-list-grid-with-a-responsive-number-of-columns-using-react-virtuali\n * http://plnkr.co/edit/zjCwNeRZ7XtmFp1PDBsc?p=preview\n */\nexport default class GridPane extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      selection: new Selection(props.folders.concat(props.documents), props.selection) \n    };\n  }\n\n  /** Set derived state **/\n  componentWillReceiveProps(next) {\n    this.setState({ \n      selection: new Selection(next.folders.concat(next.documents), next.selection)\n    });\n  }\n\n  /** Handle click/SHIFT+click/CTRL+click selection via Selection helper class */\n  onClick(evt, item, idx) {\n    const isShift = evt.getModifierState(\"Shift\");\n    const isCtrl = evt.getModifierState(\"Control\");\n\n    if (isShift)\n      this.state.selection.selectRange(idx);\n    else\n      this.state.selection.selectItem(item, isCtrl);\n\n    this.props.onSelect(this.state.selection.getSelectedItems());\n    evt.preventDefault();\n  }\n\n  onDoubleClick(item) {\n    window.location.href= `document/${item.id}/part/1/edit`;\n  }\n\n  rowRenderer(itemsPerRow, rowCount) {\n    const allItems = this.props.folders.concat(this.props.documents);\n\n    return ((args) => {\n      const fromIndex = args.index * itemsPerRow;\n      const toIndex = Math.min(fromIndex + itemsPerRow, allItems.length);\n      const itemsInRow = toIndex - fromIndex;\n\n      const renderedItems = new Array(itemsInRow).fill(undefined).map((_, rowIdx) => {\n        const idx = rowIdx + fromIndex;\n        const item = allItems[idx];\n\n        const isFolder = item.name; // Dummy condition\n        if (isFolder)\n          return (\n            <Folder key={idx} name={item.name} />\n          )\n        else\n          return (\n            <Document\n              key={idx}\n              id={item.id}\n              title={item.title}\n              filetypes={item.filetypes}\n              fileCount={item.file_count}\n              selected={this.props.selection && this.props.selection.includes(item)}\n              onClick={e => this.onClick(e, item, args.index)} \n              onDoubleClick={this.onDoubleClick.bind(this, item)} />\n          )\n      });\n\n      if (itemsInRow < itemsPerRow) // Add dummies to preserve grid layout\n        renderedItems.push(new Array(itemsPerRow - itemsInRow).fill(undefined).map((_, idx) =>\n          <div className=\"cell dummy\" key={`dummy-${idx}`} />\n        ))\n\n      return (\n        <div\n          key={args.key}\n          style={args.style}\n          className=\"row\">\n          {renderedItems}\n        </div>\n      )\n    });\n  }\n\n  onDrag(active) {\n    this.setState({ drag: active });\n  }\n\n  onDrop(files, _, evt) {\n    const url = evt.dataTransfer.getData('URL');\n\n    this.setState({ drag: false });\n\n    if (files.length > 0) this.props.onDropFiles(files);\n    else if (url) this.props.onDropURL(url);\n  }\n\n  render() {\n    const readme = React.Children.toArray(this.props.children)\n      .filter(c => c.type === Readme)\n      .shift(); // First readme or undefined\n\n    const gridPane =\n      <AutoSizer>\n        {({ height, width }) => {\n          const itemCount = this.props.folders.length + this.props.documents.length;\n          const itemsPerRow = Math.floor(width / ITEM_SIZE);\n          const rowCount = Math.ceil(itemCount / itemsPerRow);\n\n          return (\n            <List\n              className=\"virtualized-grid\"\n              width={width}\n              height={height}\n              rowCount={rowCount}\n              rowHeight={ITEM_SIZE}\n              rowRenderer={this.rowRenderer(itemsPerRow, rowCount)} />\n          )\n        }}\n      </AutoSizer>\n\n    return (\n      <React.Fragment>\n        {readme}\n        <div className=\"documents-pane grid-pane\">\n          {this.props.disableFiledrop ? gridPane :\n            <Dropzone\n              className=\"dropzone\"\n              disableClick={true}\n              onDragEnter={this.onDrag.bind(this, true)}\n              onDragLeave={this.onDrag.bind(this, false)}\n              onDrop={this.onDrop.bind(this)}>\n\n              {gridPane}\n\n            </Dropzone>\n          }\n\n          { this.state.drag && <DropzoneDecoration /> }\n        </div>\n      </React.Fragment>\n    )\n  }\n\n}\n"],"sourceRoot":""}